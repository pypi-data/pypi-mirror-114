{"version":3,"sources":["newsWidgetView.es6.js"],"names":[],"mappings":";;AAAA;;;AAGA,GAAG,KAAH,CAAS,cAAT,GAA0B,GAAG,KAAH,CAAS,UAAT,CAAoB,MAApB,CAA2B;AACjD,eAAW,IADsC;AAEjD,6CAFiD;;AAIjD,mBAAe,EAAE,QAAF,6UAJkC;;AAkBjD;;;;;AAKA,gBAvBiD,0BAuBlC;AAAA;;AACX,YAAM,QAAQ,KAAK,KAAnB;;AAEA,aAAK,eAAL,CAAqB;AACjB,gBAAI,WADa;AAEjB,gBAAI,EAAE,8BAAF,EACC,IADD,uBAEC,IAFD,CAEM,MAFN,EAEc,MAAM,GAAN,CAAU,SAAV,CAFd;AAFa,SAArB;;AAOA,YAAM,eAAe,KAAK,KAAL,CAAW,GAAX,CAAe,cAAf,CAArB;;AAEA,YAAI,YAAJ,EAAkB;AACd,iBAAK,eAAL,CAAqB;AACjB,oBAAI,WADa;AAEjB,4BAAY,WAFK;AAGjB,oBAAI,EAAE,8BAAF,EACC,IADD,uBAEC,IAFD,CAEM,MAFN,EAEc,YAFd;AAHa,aAArB;AAOH;;AAED,aAAK,QAAL,CAAc,KAAd,EAAqB,aAArB,EACc;AAAA,mBAAM,MAAK,YAAL,CAAkB,IAAlB,CAAN;AAAA,SADd;AAEA,aAAK,QAAL,CAAc,KAAd,EAAqB,kBAArB,EAAyC,KAAK,mBAA9C;;AAEA,cAAM,QAAN;AACH,KAlDgD;;;AAoDjD;;;;;AAKA,iBAzDiD,2BAyDjC;AACZ,aAAK,KAAL,CAAW,QAAX;AACH,KA3DgD;;;AA6DjD;;;;;;AAMA,uBAnEiD,iCAmE3B;AAClB,YAAM,QAAQ,KAAK,KAAL,CAAW,GAAX,CAAe,WAAf,CAAd;;AAEA,aAAK,YAAL,CAAkB,KAAlB;;AAEA,YAAI,MAAM,MAAN,GAAe,CAAnB,EAAsB;AAClB,iBAAK,QAAL,CAAc,IAAd,CAAmB,KAAK,aAAL,CAAmB;AAClC,uBAAO;AAD2B,aAAnB,CAAnB;AAGH,SAJD,MAIO;AACH,gBAAM,SAAS,EAAE,2CAAF,EACV,IADU,CACL,uIAEF,CAAC,KAAK,KAAL,CAAW,GAAX,CAAe,SAAf,CAAD,CAFE,CADK,CAAf;;AAKA,iBAAK,QAAL,CACK,KADL,GAEK,MAFL,CAEY,MAFZ;AAGH;;AAED,aAAK,OAAL,CAAa,aAAb;AACH;AAxFgD,CAA3B,CAA1B","file":"newsWidgetView.js","sourcesContent":["/**\n * A widget for displaying news items from an RSS feed.\n */\nRB.Admin.NewsWidgetView = RB.Admin.WidgetView.extend({\n    canReload: true,\n    reloadTitle: gettext('Reload news posts'),\n\n    itemsTemplate: _.template(dedent`\n        <% _.each(items, function(item) { %>\n         <a href=\"<%- item.url %>\" class=\"rb-c-admin-news-widget__item\"\n            target=\"_blank\">\n          <span class=\"rb-c-admin-news-widget__item-date\">\n           <%- item.date.format('MMM DD') %>\n          </span>\n          <span class=\"rb-c-admin-news-widget__item-title\">\n           <%- item.title %>\n          </span>\n         </a>\n        <% }) %>\n    `),\n\n    /**\n     * Render the widget.\n     *\n     * This will set up the actions and begin loading the news.\n     */\n    renderWidget() {\n        const model = this.model;\n\n        this.addFooterAction({\n            id: 'more-news',\n            el: $('<a href=\"#\" target=\"_blank\">')\n                .text(gettext('More News'))\n                .attr('href', model.get('newsURL')),\n        });\n\n        const subscribeURL = this.model.get('subscribeURL');\n\n        if (subscribeURL) {\n            this.addFooterAction({\n                id: 'subscribe',\n                cssClasses: '-is-right',\n                el: $('<a href=\"#\" target=\"_blank\">')\n                    .text(gettext('Subscribe'))\n                    .attr('href', subscribeURL),\n            });\n        }\n\n        this.listenTo(model, 'loadingNews',\n                      () => this.setReloading(true));\n        this.listenTo(model, 'change:newsItems', this._onNewsItemsChanged);\n\n        model.loadNews();\n    },\n\n    /**\n     * Reload the news posts.\n     *\n     * This is called in response to a user clicking the Reload action.\n     */\n    reloadContent() {\n        this.model.loadNews();\n    },\n\n    /**\n     * Handle changes to the list of loaded news items.\n     *\n     * If the list is empty, this will present an error pointing to the news\n     * feed. Otherwise, it will render each of the news items.\n     */\n    _onNewsItemsChanged() {\n        const items = this.model.get('newsItems');\n\n        this.setReloading(false);\n\n        if (items.length > 0) {\n            this.$content.html(this.itemsTemplate({\n                items: items,\n            }));\n        } else {\n            const $error = $('<p class=\"rb-c-admin-news-widget__error\">')\n                .html(interpolate(\n                    gettext('There was an error loading the news. Please <a href=\"%s\">visit the news page</a> directly, or try again later.'),\n                    [this.model.get('newsURL')]));\n\n            this.$content\n                .empty()\n                .append($error);\n        }\n\n        this.trigger('sizeChanged');\n    },\n});\n"]}