{"version":3,"sources":["relatedRepoSelectorView.es6.js"],"names":[],"mappings":";;AAAA,CAAC,YAAW;;AAEZ,QAAM,iBAAiB,EAAE,QAAF,0DAAvB;;AAOA;;;AAGA,OAAG,uBAAH,GAA6B,QAAQ,yBAAR,CAAkC,MAAlC,CAAyC;AAClE,oEADkE;;AAGlE;;;;;;;;;;;;;;;AAeA,kBAlBkE,sBAkBvD,OAlBuD,EAkB9C;AAChB,oBAAQ,yBAAR,CAAkC,SAAlC,CAA4C,UAA5C,CAAuD,IAAvD,CACI,IADJ,EAEI,EAAE,QAAF,CAAW;AACP,kCAAkB;AACd,iCAAa,CAAC,MAAD,CADC;AAEd,+BAAW,CACP,EAAC,OAAO,MAAR,EADO,CAFG;AAKd,gCAAY;AALE;AADX,aAAX,EAQG,OARH,CAFJ;;AAYA,iBAAK,gBAAL,GAAwB,QAAQ,eAAR,IAA2B,EAAnD;AACH,SAhCiE;;;AAkClE;;;;;;;;;;;AAWA,oBA7CkE,wBA6CrD,IA7CqD,EA6C/C;AACf,mBAAO,eAAe,IAAf,CAAP;AACH,SA/CiE;;;AAiDlE;;;;;;;;;;;;AAYA,mBA7DkE,uBA6DtD,KA7DsD,EA6D/C,QA7D+C,EA6DrC;AACzB,gBAAM,SAAS;AACX,+BAAe;AADJ,aAAf;;AAIA,gBAAI,MAAM,MAAN,KAAiB,CAArB,EAAwB;AACpB,uBAAO,CAAP,GAAW,KAAX;AACH;;AAED,cAAE,IAAF,CAAO;AACH,sBAAM,KADH;AAEH,0BAAQ,SAAR,GAAoB,KAAK,gBAAzB,sBAFG;AAGH,sBAAM,MAHH;AAIH,yBAAS,0BAAW;AAChB,6BAAS,QAAQ,YAAR,CAAqB,GAArB,CAAyB;AAAA,+BAAM;AACpC,kCAAM,EAAE,IAD4B;AAEpC,gCAAI,EAAE;AAF8B,yBAAN;AAAA,qBAAzB,CAAT;AAIH,iBATE;AAUH,uBAAO,iBAAa;AAAA,sDAAT,IAAS;AAAT,4BAAS;AAAA;;AAChB,4BAAQ,KAAR,CAAc,yBAAd,EAAyC,IAAzC;AACA;AACH;AAbE,aAAP;AAeH;AArFiE,KAAzC,CAA7B;AAyFC,CArGD","file":"relatedRepoSelectorView.js","sourcesContent":["(function() {\n\nconst optionTemplate = _.template(dedent`\n    <div>\n     <span class=\"title\"><%- name %></span>\n    </div>\n`);\n\n\n/**\n * A widget to select related repositories using search and autocomplete.\n */\nRB.RelatedRepoSelectorView = Djblets.RelatedObjectSelectorView.extend({\n    searchPlaceholderText: gettext('Search for repositories...'),\n\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the view.\n     *\n     * Option Args:\n     *     localSitePrefix (string):\n     *         The URL prefix for the Local Site, if any.\n     *\n     *     multivalued (boolean):\n     *         Whether or not the widget should allow selecting multiple\n     *         values.\n     */\n    initialize(options) {\n        Djblets.RelatedObjectSelectorView.prototype.initialize.call(\n            this,\n            _.defaults({\n                selectizeOptions: {\n                    searchField: ['name'],\n                    sortField: [\n                        {field: 'name'},\n                    ],\n                    valueField: 'name',\n                }\n            }, options));\n\n        this._localSitePrefix = options.localSitePrefix || '';\n    },\n\n    /**\n     * Render an option in the drop-down menu.\n     *\n     * Args:\n     *     item (object):\n     *         The item to render.\n     *\n     * Returns:\n     *     string:\n     *     HTML to insert into the drop-down menu.\n     */\n    renderOption(item) {\n        return optionTemplate(item);\n    },\n\n    /**\n     * Load options from the server.\n     *\n     * Args:\n     *     query (string):\n     *         The string typed in by the user.\n     *\n     *     callback (function):\n     *         A callback to be called once data has been loaded. This should\n     *         be passed an array of objects, each representing an option in\n     *         the drop-down.\n     */\n    loadOptions(query, callback) {\n        const params = {\n            'only-fields': 'name,id',\n        };\n\n        if (query.length !== 0) {\n            params.q = query;\n        }\n\n        $.ajax({\n            type: 'GET',\n            url: `${SITE_ROOT}${this._localSitePrefix}api/repositories/`,\n            data: params,\n            success: results => {\n                callback(results.repositories.map(u => ({\n                    name: u.name,\n                    id: u.id,\n                })));\n            },\n            error: (...args) => {\n                console.error('Repository query failed', args);\n                callback();\n            },\n        });\n    },\n});\n\n\n})();\n"]}