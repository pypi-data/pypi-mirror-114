{"version":3,"sources":["newsWidgetViewTests.es6.js"],"names":[],"mappings":"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","file":"newsWidgetViewTests.js","sourcesContent":["suite('rb/admin/views/NewsWidgetView', function() {\n    const template = dedent`\n        <div class=\"rb-c-admin-widget rb-c-news-admin-widget\">\n         <header class=\"rb-c-admin-widget__header\">\n          <ul class=\"rb-c-admin-widget__actions\"></ul>\n         </header>\n         <div class=\"rb-c-admin-widget__content\"></div>\n         <footer class=\"rb-c-admin-widget__footer\">\n          <ul class=\"rb-c-admin-widget__actions\"></ul>\n         </footer>\n        </div>\n    `;\n\n    let model;\n    let view;\n\n    beforeEach(function() {\n        model = new RB.Admin.NewsWidget({\n            newsURL: 'http://example.com/news/',\n        });\n\n        view = new RB.Admin.NewsWidgetView({\n            el: $(template),\n            model: model,\n        });\n\n        spyOn(model, 'loadNews');\n    });\n\n    describe('Rendering', function() {\n        describe('Actions', function() {\n            it('More News', function() {\n                view.render();\n\n                const $actions = view.$footerActions.children();\n                expect($actions.length).toBe(1);\n\n                const $action = $actions.eq(0);\n                expect($action.hasClass('js-action-more-news')).toBeTrue();\n                expect($action.children('a').attr('href'))\n                    .toBe('http://example.com/news/');\n            });\n\n            it('Subscribe', function() {\n                model.set('subscribeURL', 'http://example.com/news/subscribe/');\n                view.render();\n\n                const $actions = view.$footerActions.children();\n                expect($actions.length).toBe(2);\n\n                const $action = $actions.eq(1);\n                expect($action.hasClass('js-action-subscribe')).toBeTrue();\n                expect($action.children('a').attr('href'))\n                    .toBe('http://example.com/news/subscribe/');\n            });\n\n            describe('Reload', function() {\n                it('On loadingNews event', function() {\n                    view.render();\n\n                    const $action = view.$headerActions.children(\n                        '.js-action-reload');\n                    expect($action.hasClass('fa-spin')).toBeFalse();\n\n                    model.trigger('loadingNews');\n                    expect($action.hasClass('fa-spin')).toBeTrue();\n                });\n\n                it('On change:newsItems event', function() {\n                    view.render();\n\n                    const $action = view.$headerActions.children(\n                        '.js-action-reload');\n\n                    view.setReloading(true);\n                    expect($action.hasClass('fa-spin')).toBeTrue();\n\n                    model.set('newsItems', []);\n                    expect($action.hasClass('fa-spin')).toBeFalse();\n                });\n            });\n        });\n\n        it('News items', function() {\n            view.render();\n\n            model.set('newsItems', [\n                {\n                    date: moment(Date.UTC(2019, 9, 21, 0, 26, 32)),\n                    title: 'Headline 6',\n                    url: 'http://example.com/news/post6',\n                },\n                {\n                    date: moment(Date.UTC(2019, 9, 1, 20, 29, 0)),\n                    title: 'Headline 5',\n                    url: 'http://example.com/news/post5',\n                },\n                {\n                    date: moment(Date.UTC(2019, 8, 27, 2, 29, 33)),\n                    title: 'Headline 4',\n                    url: 'http://example.com/news/post4',\n                },\n            ]);\n\n            const $items = view.$content.children();\n            expect($items.length).toBe(3);\n\n            let $item = $items.eq(0);\n            expect($item.attr('href')).toBe('http://example.com/news/post6');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-date').text().strip()\n            ).toBe('Oct 20');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-title').text().strip()\n            ).toBe('Headline 6');\n\n            $item = $items.eq(1);\n            expect($item.attr('href')).toBe('http://example.com/news/post5');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-date')\n                .text().strip()\n            ).toBe('Oct 01');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-title')\n                .text().strip()\n            ).toBe('Headline 5');\n\n            $item = $items.eq(2);\n            expect($item.attr('href')).toBe('http://example.com/news/post4');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-date')\n                .text().strip()\n            ).toBe('Sep 26');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-title')\n                .text().strip()\n            ).toBe('Headline 4');\n        });\n\n        it('Load errors', function() {\n            view.render();\n\n            model.set('newsItems', []);\n\n            const $els = view.$content.children();\n            expect($els.length).toBe(1);\n\n            const $error = $els.eq(0);\n            expect($error.hasClass('rb-c-admin-news-widget__error'))\n                .toBeTrue();\n            expect($error.html().strip()).toBe(\n                'There was an error loading the news. Please ' +\n                '<a href=\"http://example.com/news/\">visit the news page</a> ' +\n                'directly, or try again later.');\n        });\n    });\n});\n"]}