{"version":3,"sources":["resourceCollectionTests.es6.js"],"names":[],"mappings":"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","file":"resourceCollectionTests.js","sourcesContent":["suite('rb/resources/collections/ResourceCollection', function() {\n    let collection;\n    let reviewRequest;\n\n    beforeEach(function() {\n        reviewRequest = new RB.ReviewRequest({\n            id: 123,\n            loaded: true,\n            links: {\n                reviews: {\n                    href: '/api/review-requests/123/reviews/',\n                },\n            },\n        });\n\n        spyOn(reviewRequest, 'ready').and.callFake(\n            (options, context) => options.ready.call(context));\n\n        collection = new RB.ResourceCollection([], {\n            model: RB.Review,\n            parentResource: reviewRequest,\n        });\n    });\n\n    describe('Methods', function() {\n        describe('fetch', function() {\n            it('Populates collection', function() {\n                spyOn($, 'ajax').and.callFake(request => {\n                    expect(request.url).toBe(\n                        '/api/review-requests/123/reviews/');\n                    expect(request.type).toBe('GET');\n\n                    request.success({\n                        stat: 'ok',\n                        total_results: 2,\n                        links: {\n                            self: {\n                                method: 'GET',\n                                href: '/api/review-requests/123/reviews/',\n                            },\n                            next: {\n                                method: 'GET',\n                                href: '/api/review-requests/123/reviews/' +\n                                      '?start=25',\n                            },\n                        },\n                        reviews: [\n                            {\n                                id: 1,\n                                links: {},\n                            },\n                            {\n                                id: 2,\n                                links: {},\n                            },\n                        ],\n                    });\n                });\n\n                collection.fetch();\n\n                expect($.ajax).toHaveBeenCalled();\n                expect(collection.length).toBe(2);\n                expect(collection.at(0).id).toBe(1);\n                expect(collection.at(1).id).toBe(2);\n                expect(collection.hasPrev).toBe(false);\n                expect(collection.hasNext).toBe(true);\n            });\n\n            it('With start=', function() {\n                spyOn($, 'ajax').and.callFake(request => {\n                    expect(request.url).toBe(\n                        '/api/review-requests/123/reviews/');\n                    expect(request.data).not.toBe(undefined);\n                    expect(request.data.start).toBe(100);\n                });\n\n                collection.fetch({\n                    start: 100,\n                });\n\n                expect($.ajax).toHaveBeenCalled();\n            });\n\n            describe('With parentResource', function() {\n                it('Calls parentResource.ready', function() {\n                    spyOn(RB.BaseCollection.prototype, 'fetch');\n\n                    collection.fetch();\n\n                    expect(reviewRequest.ready).toHaveBeenCalled();\n                    expect(RB.BaseCollection.prototype.fetch)\n                        .toHaveBeenCalled();\n                });\n            });\n        });\n\n        describe('fetchAll', function() {\n            it('Spanning pages', function() {\n                let numFetches = 0;\n\n                spyOn($, 'ajax').and.callFake(request => {\n                    console.assert(numFetches < 2);\n\n                    expect(request.type).toBe('GET');\n\n                    numFetches++;\n\n                    if (numFetches === 1) {\n                        expect(request.url).toBe(\n                            '/api/review-requests/123/reviews/');\n\n                        request.success({\n                            stat: 'ok',\n                            total_results: 4,\n                            links: {\n                                self: {\n                                    method: 'GET',\n                                    href: '/api/review-requests/123/reviews/',\n                                },\n                                next: {\n                                    method: 'GET',\n                                    href: '/api/review-requests/123/reviews/' +\n                                          '?start=25',\n                                },\n                            },\n                            reviews: [\n                                {\n                                    id: 1,\n                                    links: {},\n                                },\n                                {\n                                    id: 2,\n                                    links: {},\n                                },\n                            ],\n                        });\n                    } else if (numFetches === 2) {\n                        expect(request.url).toBe(\n                            '/api/review-requests/123/reviews/?start=25');\n\n                        request.success({\n                            stat: 'ok',\n                            total_results: 4,\n                            links: {\n                                self: {\n                                    method: 'GET',\n                                    href: '/api/review-requests/123/reviews/' +\n                                          '?start=25',\n                                },\n                                prev: {\n                                    method: 'GET',\n                                    href: '/api/review-requests/123/reviews/' +\n                                          '?start=0',\n                                },\n                            },\n                            reviews: [\n                                {\n                                    id: 3,\n                                    links: {},\n                                },\n                                {\n                                    id: 4,\n                                    links: {},\n                                },\n                            ],\n                        });\n                    }\n                });\n\n                const result = collection.fetchAll();\n\n                expect(result).toBe(true);\n                expect($.ajax).toHaveBeenCalled();\n                expect(numFetches).toBe(2);\n                expect(collection.hasPrev).toBe(false);\n                expect(collection.hasNext).toBe(false);\n                expect(collection.totalResults).toBe(4);\n                expect(collection.currentPage).toBe(0);\n                expect(collection.length).toBe(4);\n                expect(collection.at(0).id).toBe(1);\n                expect(collection.at(1).id).toBe(2);\n                expect(collection.at(2).id).toBe(3);\n                expect(collection.at(3).id).toBe(4);\n            });\n        });\n\n        describe('fetchNext', function() {\n            it('With hasNext == false', function() {\n                collection.hasNext = false;\n                spyOn(collection, 'fetch');\n\n                const result = collection.fetchNext();\n\n                expect(result).toBe(false);\n                expect(collection.fetch).not.toHaveBeenCalled();\n            });\n\n            it('With hasNext == true', function() {\n                spyOn($, 'ajax').and.callFake(request => {\n                    expect(request.url).toBe(\n                        '/api/review-requests/123/reviews/?start=25');\n                    expect(request.type).toBe('GET');\n\n                    request.success({\n                        stat: 'ok',\n                        total_results: 2,\n                        links: {\n                            self: {\n                                method: 'GET',\n                                href: '/api/review-requests/123/reviews/',\n                            },\n                            prev: {\n                                method: 'GET',\n                                href: '/api/review-requests/123/reviews/' +\n                                      '?start=0',\n                            },\n                            next: {\n                                method: 'GET',\n                                href: '/api/review-requests/123/reviews/' +\n                                      '?start=50',\n                            },\n                        },\n                        reviews: [\n                            {\n                                id: 1,\n                                links: {},\n                            },\n                            {\n                                id: 2,\n                                links: {},\n                            },\n                        ],\n                    });\n                });\n\n                collection.hasNext = true;\n                collection.currentPage = 2;\n                collection._links = {\n                    next: {\n                        method: 'GET',\n                        href: '/api/review-requests/123/reviews/?start=25',\n                    },\n                };\n\n                spyOn(collection, 'fetch').and.callThrough();\n\n                const result = collection.fetchNext();\n\n                expect(result).toBe(true);\n                expect(collection.fetch).toHaveBeenCalled();\n                expect(collection.hasPrev).toBe(true);\n                expect(collection.hasNext).toBe(true);\n                expect(collection.currentPage).toBe(3);\n                expect(collection.models.length).toBe(2);\n            });\n        });\n\n        describe('fetchPrev', function() {\n            it('With hasPrev == false', function() {\n                collection.hasPrev = false;\n                spyOn(collection, 'fetch');\n\n                const result = collection.fetchPrev();\n\n                expect(result).toBe(false);\n                expect(collection.fetch).not.toHaveBeenCalled();\n            });\n\n            it('With hasPrev == true', function() {\n                spyOn($, 'ajax').and.callFake(request => {\n                    expect(request.url).toBe(\n                        '/api/review-requests/123/reviews/?start=25');\n                    expect(request.type).toBe('GET');\n\n                    request.success({\n                        stat: 'ok',\n                        total_results: 2,\n                        links: {\n                            self: {\n                                method: 'GET',\n                                href: '/api/review-requests/123/reviews/',\n                            },\n                            prev: {\n                                method: 'GET',\n                                href: '/api/review-requests/123/reviews/' +\n                                      '?start=0',\n                            },\n                            next: {\n                                method: 'GET',\n                                href: '/api/review-requests/123/reviews/' +\n                                      '?start=25',\n                            },\n                        },\n                        reviews: [\n                            {\n                                id: 1,\n                                links: {},\n                            },\n                            {\n                                id: 2,\n                                links: {},\n                            },\n                        ],\n                    });\n                });\n\n                collection.hasPrev = true;\n                collection.currentPage = 2;\n                collection._links = {\n                    prev: {\n                        method: 'GET',\n                        href: '/api/review-requests/123/reviews/?start=25',\n                    },\n                };\n\n                spyOn(collection, 'fetch').and.callThrough();\n\n                const result = collection.fetchPrev();\n\n                expect(result).toBe(true);\n                expect(collection.fetch).toHaveBeenCalled();\n                expect(collection.hasPrev).toBe(true);\n                expect(collection.hasNext).toBe(true);\n                expect(collection.currentPage).toBe(1);\n                expect(collection.models.length).toBe(2);\n            });\n        });\n\n        describe('parse', function() {\n            let payload;\n\n            beforeEach(function() {\n                payload = {\n                    links: {},\n                    total_results: 5,\n                    reviews: [],\n                };\n            });\n\n            it('Resources returned', function() {\n                payload.reviews = [\n                    { id: 1 },\n                    { id: 2 },\n                    { id: 3 },\n                ];\n\n                const results = collection.parse(payload);\n\n                expect(results.length).toBe(3);\n                expect(results[0].id).toBe(1);\n                expect(results[1].id).toBe(2);\n                expect(results[2].id).toBe(3);\n            });\n\n            it('totalResults set', function() {\n                collection.parse(payload);\n                expect(collection.totalResults).toBe(5);\n            });\n\n            describe('With fetchingAll', function() {\n                const options = {\n                    fetchingAll: true,\n                };\n\n                it('currentPage = 0', function() {\n                    collection.parse(payload, options);\n                    expect(collection.currentPage).toBe(0);\n                });\n\n                it('hasPrev disabled', function() {\n                    collection.parse(payload, options);\n                    expect(collection.hasPrev).toBe(false);\n                });\n\n                it('hasNext disabled', function() {\n                    collection.parse(payload, options);\n                    expect(collection.hasNext).toBe(false);\n                });\n            });\n\n            describe('Without fetchingAll', function() {\n                describe('currentPage', function() {\n                    it('undefined when not options.page', function() {\n                        collection.parse(payload);\n                        expect(collection.currentPage).toBe(undefined);\n                    });\n\n                    it('Set when options.page', function() {\n                        collection.parse(payload, {\n                            page: 4,\n                        });\n\n                        expect(collection.currentPage).toBe(4);\n                    });\n                });\n\n                describe('hasPrev', function() {\n                    it('true with rsp.links.prev', function() {\n                        payload.links = {\n                            prev: {\n                                href: 'blah',\n                            },\n                        };\n\n                        collection.parse(payload);\n                        expect(collection.hasPrev).toBe(true);\n                    });\n\n                    it('false without rsp.links.prev', function() {\n                        collection.parse(payload);\n                        expect(collection.hasPrev).toBe(false);\n                    });\n                });\n\n                describe('hasNext', function() {\n                    it('true with rsp.links.next', function() {\n                        payload.links = {\n                            next: {\n                                href: 'blah',\n                            },\n                        };\n\n                        collection.parse(payload);\n                        expect(collection.hasNext).toBe(true);\n                    });\n\n                    it('false without rsp.links.next', function() {\n                        collection.parse(payload);\n                        expect(collection.hasNext).toBe(false);\n                    });\n                });\n            });\n        });\n\n        describe('url', function() {\n            it('With parentResource', function() {\n                expect(collection.url())\n                    .toBe('/api/review-requests/123/reviews/');\n            });\n\n            it('With _fetchURL', function() {\n                collection._fetchURL = '/api/foo/';\n                expect(collection.url()).toBe('/api/foo/');\n            });\n\n            it('Without _fetchURL or parentResource', function() {\n                collection.parentResource = null;\n                expect(collection.url()).toBe(null);\n            });\n        });\n    });\n});\n"]}