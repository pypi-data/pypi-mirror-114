{"version":3,"sources":["diffComplexityIconView.es6.js"],"names":[],"mappings":";;AAAA;;;;;;;;;;;;;AAaA,GAAG,sBAAH,GAA4B,SAAS,IAAT,CAAc,MAAd,CAAqB;AAC7C,eAAW,EADkC;;AAG7C;;;;;;;;;;;;;;;;;;;;;;;AAuBA,cA1B6C,sBA0BlC,OA1BkC,EA0BzB;AAChB,aAAK,UAAL,GAAkB,QAAQ,UAAR,IAAsB,CAAxC;AACA,aAAK,UAAL,GAAkB,QAAQ,UAAR,IAAsB,CAAxC;AACA,aAAK,WAAL,GAAmB,QAAQ,WAAR,IAAuB,CAA1C;AACA,aAAK,UAAL,GAAkB,QAAQ,UAAR,IAAsB,IAAxC;AACH,KA/B4C;;;AAiC7C;;;;;;;AAOA,UAxC6C,oBAwCpC;AACL,YAAM,WAAW,KAAK,UAAL,GAAkB,KAAK,UAAvB,GAAoC,KAAK,WAA1D;AACA,YAAM,gBAAgB,KAAK,UAAL,GAAkB,QAAxC;AACA,YAAM,gBAAgB,KAAK,UAAL,GAAkB,QAAxC;AACA,YAAM,iBAAiB,KAAK,WAAL,GAAmB,QAA1C;AACA,YAAM,WAAW,MAAM,IAAvB;AACA,YAAM,cACF,OAAO,KAAK,UAAL,KAAoB,IAApB,GACE,CADF,GAEE,CAAC,KAAK,UAAL,GAAkB,QAAnB,IAA+B,KAAK,UAF7C,CADJ;AAIA,YAAM,aAAa,GAAG,sBAAH,CAA0B,aAA1B,EAAnB;;AAEA,aAAK,GAAL,CACK,KADL,CACW,KAAK,SADhB,EAEK,MAFL,CAEY,KAAK,SAFjB,EAGK,IAHL,CAIQ,CACI;AACI,mBAAO,WAAW,WADtB;AAEI,kBAAM,KAAK,WAAL,CAAiB,gBAAgB,GAAjC,EAAsC,QAAtC;AAFV,SADJ,EAKI;AACI,mBAAO,WAAW,WADtB;AAEI,kBAAM,KAAK,WAAL,CAAiB,gBAAgB,GAAjC,EAAsC,QAAtC;AAFV,SALJ,EASI;AACI,mBAAO,WAAW,YADtB;AAEI,kBAAM,KAAK,WAAL,CAAiB,iBAAiB,GAAlC,EAAuC,QAAvC;AAFV,SATJ,CAJR,EAkBQ;AACI,oBAAQ;AACJ,qBAAK;AACD,0BAAM,IADL;AAED,iCAAa,WAFZ;AAGD,4BAAQ;AAHP;AADD;AADZ,SAlBR;;AA6BA,eAAO,IAAP;AACH,KAlF4C;;;AAoF7C;;;;;;;;;;;;;;AAcA,eAlG6C,uBAkGjC,GAlGiC,EAkG5B,QAlG4B,EAkGlB;AACvB,eAAO,QAAQ,CAAR,GAAY,CAAZ,GAAgB,KAAK,GAAL,CAAS,GAAT,EAAc,QAAd,CAAvB;AACH;AApG4C,CAArB,EAqGzB;AACC,iBAAa,IADd;;AAGC;;;;;;;;;;;;AAYA,iBAfD,2BAeiB;AACZ,YAAI,CAAC,KAAK,WAAV,EAAuB;AACnB,iBAAK,WAAL,GAAmB,EAAnB;;AAEA,gBAAM,aAAa,EAAE,QAAF,EACd,IADc,GAEd,QAFc,CAEL,SAAS,IAFJ,CAAnB;;AAIA,uBAAW,CAAX,EAAc,SAAd,GAA0B,0BAA1B;AACA,iBAAK,WAAL,CAAiB,WAAjB,GAA+B,WAAW,GAAX,CAAe,OAAf,CAA/B;;AAEA,uBAAW,CAAX,EAAc,SAAd,GAA0B,2BAA1B;AACA,iBAAK,WAAL,CAAiB,YAAjB,GAAgC,WAAW,GAAX,CAAe,OAAf,CAAhC;;AAEA,uBAAW,CAAX,EAAc,SAAd,GAA0B,0BAA1B;AACA,iBAAK,WAAL,CAAiB,WAAjB,GAA+B,WAAW,GAAX,CAAe,OAAf,CAA/B;;AAEA,uBAAW,MAAX;AACH;;AAED,eAAO,KAAK,WAAZ;AACH;AApCF,CArGyB,CAA5B","file":"diffComplexityIconView.js","sourcesContent":["/**\n * Renders an icon showing the general complexity of a diff.\n *\n * This icon is a pie graph showing the percentage of inserts vs deletes\n * vs replaces. The size of the white inner radius is a relative indicator\n * of how large the change is for the file, representing the unchanged lines.\n * Smaller inner radiuses indicate much larger changes, whereas larger\n * radiuses represent smaller changes.\n *\n * Callers are not required to supply the total number of lines or the number\n * of replaces, allowing this to be used when only the most basic insert and\n * delete counts are available.\n */\nRB.DiffComplexityIconView = Backbone.View.extend({\n    ICON_SIZE: 20,\n\n    /**\n     * Initialize the view.\n     *\n     * Each of the provided values will be normalized to something\n     * the view expects.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the view.\n     *\n     * Option Args:\n     *     numInserts (number, optional):\n     *         The number of inserts in the diff file.\n     *\n     *     numDeletes (number, optional):\n     *         The number of deletes in the diff file.\n     *\n     *     numReplaces (number, optional):\n     *         The number of replaces in the diff file.\n     *\n     *     totalLines (number, optional):\n     *         The total number of lines in the file.\n     */\n    initialize(options) {\n        this.numInserts = options.numInserts || 0;\n        this.numDeletes = options.numDeletes || 0;\n        this.numReplaces = options.numReplaces || 0;\n        this.totalLines = options.totalLines || null;\n    },\n\n    /**\n     * Render the icon.\n     *\n     * Returns:\n     *     RB.DiffComplexityIconView:\n     *     This object, for chaining.\n     */\n    render() {\n        const numTotal = this.numInserts + this.numDeletes + this.numReplaces;\n        const numInsertsPct = this.numInserts / numTotal;\n        const numDeletesPct = this.numDeletes / numTotal;\n        const numReplacesPct = this.numReplaces / numTotal;\n        const minValue = 360 * 0.15;\n        const innerRadius = (\n            0.5 * (this.totalLines === null\n                   ? 1\n                   : (this.totalLines - numTotal) / this.totalLines));\n        const iconColors = RB.DiffComplexityIconView.getIconColors();\n\n        this.$el\n            .width(this.ICON_SIZE)\n            .height(this.ICON_SIZE)\n            .plot(\n                [\n                    {\n                        color: iconColors.insertColor,\n                        data: this._clampValue(numInsertsPct * 360, minValue)\n                    },\n                    {\n                        color: iconColors.deleteColor,\n                        data: this._clampValue(numDeletesPct * 360, minValue)\n                    },\n                    {\n                        color: iconColors.replaceColor,\n                        data: this._clampValue(numReplacesPct * 360, minValue)\n                    },\n                ],\n                {\n                    series: {\n                        pie: {\n                            show: true,\n                            innerRadius: innerRadius,\n                            radius: 0.8,\n                        },\n                    },\n                }\n            );\n\n        return this;\n    },\n\n    /**\n     * Clamp the number to be, at minimum, minValue, unless it is 0.\n     *\n     * Args:\n     *     val (number):\n     *         The number to clamp.\n     *\n     *     minValue (number):\n     *         The minimum to clamp ``val`` to.\n     *\n     * Returns:\n     *     number:\n     *     The clamped number.\n     */\n    _clampValue(val, minValue) {\n        return val === 0 ? 0 : Math.max(val, minValue);\n    },\n}, {\n    _iconColors: null,\n\n    /**\n     * Return the colors used for the complexity icons.\n     *\n     * This will create a temporary icon on the DOM and apply the CSS\n     * styles for each type of change the icon can show. It will then\n     * copy these colors, caching them for all future icons, and return\n     * them.\n     *\n     * Returns:\n     *     object:\n     *     An object containing the colors to use for the icon.\n     */\n    getIconColors() {\n        if (!this._iconColors) {\n            this._iconColors = {};\n\n            const $iconColor = $('<div/>')\n                .hide()\n                .appendTo(document.body);\n\n            $iconColor[0].className = 'diff-changes-icon-insert';\n            this._iconColors.insertColor = $iconColor.css('color');\n\n            $iconColor[0].className = 'diff-changes-icon-replace';\n            this._iconColors.replaceColor = $iconColor.css('color');\n\n            $iconColor[0].className = 'diff-changes-icon-delete';\n            this._iconColors.deleteColor = $iconColor.css('color');\n\n            $iconColor.remove();\n        }\n\n        return this._iconColors;\n    },\n});\n"]}