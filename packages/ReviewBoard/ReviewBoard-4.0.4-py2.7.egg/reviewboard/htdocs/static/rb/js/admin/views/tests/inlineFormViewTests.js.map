{"version":3,"sources":["inlineFormViewTests.es6.js"],"names":[],"mappings":"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","file":"inlineFormViewTests.js","sourcesContent":["suite('rb/admin/views/InlineFormView', function() {\n    const template = _.template(dedent`\n        <div class=\"rb-c-admin-form-inline\">\n         <h3 class=\"rb-c-admin-form-inline__title\">\n          <span class=\"rb-c-admin-form-inline__title-prefix\"></span>\n          <span class=\"rb-c-admin-form-inline__title-object\"></span>\n          <span class=\"rb-c-admin-form-inline__title-index\"></span>\n          <span class=\"rb-c-admin-form-inline__actions\">\n           <span class=\"rb-c-admin-form-inline__delete-action\"></span>\n          </span>\n         </h3>\n         <fieldset>\n          <div>\n           <label for=\"id_myprefix-<%- index %>-foo\"></label>\n           <input id=\"id_myprefix-<%- index %>-foo\"\n                  name=\"myprefix-<%- index %>-foo\">\n          </div>\n          <div>\n           <label for=\"id_myprefix-<%- index %>-bar\"></label>\n           <input id=\"id_myprefix-<%- index %>-bar\"\n                  name=\"myprefix-<%- index %>-bar\">\n          </div>\n         </fieldset>\n        </div>\n    `);\n\n    let $el;\n    let model;\n    let view;\n\n    beforeEach(function() {\n        $el = $(template({\n            index: '__prefix__',\n        }));\n\n        model = new RB.Admin.InlineForm({\n            prefix: 'myprefix',\n        });\n\n        view = new RB.Admin.InlineFormView({\n            el: $el,\n            model: model,\n        });\n        view.render();\n    });\n\n    describe('Events', function() {\n        describe('Delete clicked', function() {\n            let $delete;\n\n            beforeEach(function() {\n                spyOn(window, 'confirm').and.returnValue(true);\n                spyOn(model, 'destroy');\n\n                $delete = $el.find('.rb-c-admin-form-inline__delete-action');\n            });\n\n            it('With isInitial=true', function() {\n                model.set('isInitial', true);\n\n                $delete.click();\n\n                expect(window.confirm).not.toHaveBeenCalled();\n                expect(model.destroy).not.toHaveBeenCalled();\n            });\n\n            it('With isInitial=false', function() {\n                model.set('isInitial', false);\n\n                $delete.click();\n\n                expect(window.confirm).toHaveBeenCalled();\n                expect(model.destroy).toHaveBeenCalled();\n            });\n        });\n\n        describe('Index changed', function() {\n            let $labels;\n            let $inputs;\n            let $titleIndex;\n\n            beforeEach(function() {\n                $labels = $el.find('label');\n                $inputs = $el.find('input');\n                $titleIndex = $el.find('.rb-c-admin-form-inline__title-index');\n\n                expect($labels.length).toBe(2);\n                expect($inputs.length).toBe(2);\n                expect($titleIndex.length).toBe(1);\n            });\n\n            it('From __prefix__ to index', function() {\n                model.set('index', 0);\n\n                expect($el[0].id).toBe('myprefix-0');\n                expect($titleIndex.text()).toBe('#1');\n\n                expect($labels[0].htmlFor).toBe('id_myprefix-0-foo');\n                expect($labels[1].htmlFor).toBe('id_myprefix-0-bar');\n\n                let inputEl = $inputs[0];\n                expect(inputEl.id).toBe('id_myprefix-0-foo');\n                expect(inputEl.name).toBe('myprefix-0-foo');\n\n                inputEl = $inputs[1];\n                expect(inputEl.id).toBe('id_myprefix-0-bar');\n                expect(inputEl.name).toBe('myprefix-0-bar');\n            });\n\n            it('From index to index', function() {\n                model.set('index', 0);\n                model.set('index', 1);\n\n                expect($el[0].id).toBe('myprefix-1');\n                expect($titleIndex.text()).toBe('#2');\n\n                expect($labels[0].htmlFor).toBe('id_myprefix-1-foo');\n                expect($labels[1].htmlFor).toBe('id_myprefix-1-bar');\n\n                let inputEl = $inputs[0];\n                expect(inputEl.id).toBe('id_myprefix-1-foo');\n                expect(inputEl.name).toBe('myprefix-1-foo');\n\n                inputEl = $inputs[1];\n                expect(inputEl.id).toBe('id_myprefix-1-bar');\n                expect(inputEl.name).toBe('myprefix-1-bar');\n            });\n        });\n    });\n});\n"]}