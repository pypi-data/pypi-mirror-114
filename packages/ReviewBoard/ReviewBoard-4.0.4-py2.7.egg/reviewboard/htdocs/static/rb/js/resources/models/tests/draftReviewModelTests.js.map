{"version":3,"sources":["draftReviewModelTests.es6.js"],"names":[],"mappings":"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","file":"draftReviewModelTests.js","sourcesContent":["suite('rb/resources/models/DraftReview', function() {\n    let model;\n    let parentObject;\n\n    beforeEach(function() {\n        parentObject = new RB.BaseResource({\n            links: {\n                reviews: {\n                    href: '/api/foos/'\n                },\n            },\n        });\n\n        model = new RB.DraftReview({\n            parentObject: parentObject,\n        });\n        model.rspNamespace = 'foo';\n    });\n\n    describe('Methods', function() {\n        let callbacks;\n\n        beforeEach(function() {\n            callbacks = {\n                ready: function() {},\n                success: function() {},\n                error: function() {},\n            };\n\n            spyOn(callbacks, 'ready');\n            spyOn(callbacks, 'success');\n            spyOn(callbacks, 'error');\n        });\n\n        describe('ready', function() {\n            beforeEach(function() {\n                spyOn(Backbone.Model.prototype, 'fetch')\n                    .and.callFake(options => {\n                        if (options && _.isFunction(options.success)) {\n                            options.success();\n                        }\n                    });\n                spyOn(parentObject, 'ready')\n                    .and.callFake((options, context) => {\n                        if (options && _.isFunction(options.ready)) {\n                            options.ready.call(context);\n                        }\n                    });\n                spyOn(model, '_retrieveDraft')\n                    .and.callFake((options, context) => {\n                        if (options && _.isFunction(options.ready)) {\n                            options.ready.call(context);\n                        }\n                    });\n            });\n\n            describe('With isNew=true', function() {\n                beforeEach(function() {\n                    expect(model.isNew()).toBe(true);\n                    expect(model.get('loaded')).toBe(false);\n                });\n\n                it('With callbacks', function() {\n                    model.ready(callbacks);\n\n                    expect(parentObject.ready).toHaveBeenCalled();\n                    expect(model._retrieveDraft).toHaveBeenCalled();\n                    expect(callbacks.ready).toHaveBeenCalled();\n                });\n            });\n\n            describe('With isNew=false', function() {\n                beforeEach(function() {\n                    model.set({\n                        id: 123,\n                    });\n                });\n\n                it('With callbacks', function() {\n                    model.ready(callbacks);\n\n                    expect(parentObject.ready).toHaveBeenCalled();\n                    expect(model._retrieveDraft).not.toHaveBeenCalled();\n                    expect(callbacks.ready).toHaveBeenCalled();\n                });\n            });\n        });\n\n        describe('publish', function() {\n            beforeEach(function() {\n                spyOn(model, 'save').and.callFake((options, context) => {\n                    options.success.call(context);\n                });\n            });\n\n            it('Triggers \"publishing\" event before publish', function() {\n                spyOn(model, 'trigger');\n                spyOn(model, 'ready');\n\n                model.publish();\n\n                expect(model.trigger).toHaveBeenCalledWith('publishing');\n            });\n\n            it('Triggers \"published\" event after publish', function() {\n                spyOn(model, 'trigger');\n\n                spyOn(model, 'ready').and.callFake((options, context) => {\n                    options.ready.call(context);\n                });\n\n                model.publish(callbacks);\n\n                expect(callbacks.success).toHaveBeenCalled();\n                expect(model.trigger).toHaveBeenCalledWith('published');\n            });\n\n            it('Sets \"public\" to true', function() {\n                spyOn(model, 'ready').and.callFake((options, context) => {\n                    options.ready.call(context);\n                });\n\n                expect(model.get('public')).toBe(false);\n\n                model.publish(callbacks);\n\n                expect(callbacks.success).toHaveBeenCalled();\n                expect(model.get('public')).toBe(true);\n            });\n        });\n    });\n});\n"]}