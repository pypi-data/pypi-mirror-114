{"version":3,"sources":["newsWidgetModelTests.es6.js"],"names":[],"mappings":"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","file":"newsWidgetModelTests.js","sourcesContent":["suite('rb/admin/models/NewsWidget', function() {\n    let model;\n\n    beforeEach(function() {\n        model = new RB.Admin.NewsWidget({\n            rssURL: 'http://example.com/news/rss',\n        });\n    });\n\n    describe('Methods', function() {\n        describe('loadNews', function() {\n            it('Success', function() {\n                function _loadNews(url, options) {\n                    expect(url).toBe('http://example.com/news/rss');\n\n                    const payload = dedent`\n                        <?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n                        <rss xmlns:atom=\"http://www.w3.org/2005/Atom\"\n                             version=\"2.0\">\n                         <channel>\n                          <title>Channel Name</title>\n                          <link>http://example.com/news/</link>\n                          <description>Channel description...</description>\n                          <atom:link href=\"http://example.com/news/rss\"\n                                     rel=\"self\"></atom:link>\n                          <language>en-us</language>\n                          <lastBuildDate>Sun, 20 Oct 2019 17:26:32 -0700</lastBuildDate>\n                          <item>\n                           <title>Headline 6</title>\n                           <pubDate>Sun, 20 Oct 2019 17:26:32 -0700</pubDate>\n                           <link>http://example.com/news/post6</link>\n                           <description>Brief summary of 6</description>\n                           <author>user1@example.com</author>\n                           <guid>http://example.com/news/post6</guid>\n                          </item>\n                          <item>\n                           <title>Headline 5</title>\n                           <pubDate>Tue, 01 Oct 2019 13:29:00 -0700</pubDate>\n                           <link>http://example.com/news/post5</link>\n                           <description>Brief summary of 5</description>\n                           <author>user2@example.com</author>\n                           <guid>http://example.com/news/post5</guid>\n                          </item>\n                          <item>\n                           <title>Headline 4</title>\n                           <pubDate>Thu, 26 Sep 2019 19:29:33 -0700</pubDate>\n                           <link>http://example.com/news/post4</link>\n                           <description>Brief summary of 4</description>\n                           <author>user1@example.com</author>\n                           <guid>http://example.com/news/post4</guid>\n                          </item>\n                          <item>\n                           <title>Headline 3</title>\n                           <pubDate>Sun, 08 Sep 2019 11:27:05 -0700</pubDate>\n                           <link>http://example.com/news/post3</link>\n                           <description>Brief summary of 3</description>\n                           <author>user2@example.com</author>\n                           <guid>http://example.com/news/post3</guid>\n                          </item>\n                          <item>\n                           <title>Headline 2</title>\n                           <pubDate>Fri, 30 Aug 2019 23:15:01 -0700</pubDate>\n                           <link>http://example.com/news/post2</link>\n                           <description>Brief summary of 2</description>\n                           <author>user1@example.com</author>\n                           <guid>http://example.com/news/post2</guid>\n                          </item>\n                          <item>\n                           <title>Headline 1</title>\n                           <pubDate>Thu, 29 Aug 2019 14:30:00 -0700</pubDate>\n                           <link>http://example.com/news/post1</link>\n                           <description>Brief summary of 1</description>\n                           <author>user2@example.com</author>\n                           <guid>http://example.com/news/post1</guid>\n                          </item>\n                         </channel>\n                        </rss>\n                    `;\n\n                    const parser = new DOMParser();\n                    options.success(parser.parseFromString(payload,\n                                                           'application/xml'));\n                }\n\n                const loadingNewsEventHandler = jasmine.createSpy();\n\n                spyOn($, 'ajax').and.callFake(_loadNews);\n                model.on('loadingNews', loadingNewsEventHandler);\n\n                model.loadNews();\n\n                expect(loadingNewsEventHandler).toHaveBeenCalled();\n                expect($.ajax).toHaveBeenCalled();\n\n                const newsItems = model.get('newsItems');\n                expect(newsItems.length).toBe(5);\n\n                let newsItem = newsItems[0];\n                expect(newsItem.date.isSame(Date.UTC(2019, 9, 21, 0, 26, 32)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 6');\n                expect(newsItem.url).toBe('http://example.com/news/post6');\n\n                newsItem = newsItems[1];\n                expect(newsItem.date.isSame(Date.UTC(2019, 9, 1, 20, 29, 0)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 5');\n                expect(newsItem.url).toBe('http://example.com/news/post5');\n\n                newsItem = newsItems[2];\n                expect(newsItem.date.isSame(Date.UTC(2019, 8, 27, 2, 29, 33)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 4');\n                expect(newsItem.url).toBe('http://example.com/news/post4');\n\n                newsItem = newsItems[3];\n                expect(newsItem.date.isSame(Date.UTC(2019, 8, 8, 18, 27, 5)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 3');\n                expect(newsItem.url).toBe('http://example.com/news/post3');\n\n                newsItem = newsItems[4];\n                expect(newsItem.date.isSame(Date.UTC(2019, 7, 31, 6, 15, 1)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 2');\n                expect(newsItem.url).toBe('http://example.com/news/post2');\n            });\n\n            it('Error loading feed', function() {\n                function _loadNews(url, options) {\n                    expect(url).toBe('http://example.com/news/rss');\n                    options.error();\n                }\n\n                const loadingNewsEventHandler = jasmine.createSpy();\n\n                spyOn($, 'ajax').and.callFake(_loadNews);\n                model.on('loadingNews', loadingNewsEventHandler);\n\n                model.loadNews();\n\n                expect(loadingNewsEventHandler).toHaveBeenCalled();\n                expect($.ajax).toHaveBeenCalled();\n\n                const newsItems = model.get('newsItems');\n                expect(newsItems.length).toBe(0);\n            });\n        });\n    });\n});\n\n"]}