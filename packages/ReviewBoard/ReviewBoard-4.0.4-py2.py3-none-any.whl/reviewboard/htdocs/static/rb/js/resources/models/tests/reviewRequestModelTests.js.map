{"version":3,"sources":["reviewRequestModelTests.es6.js"],"names":[],"mappings":"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","file":"reviewRequestModelTests.js","sourcesContent":["suite('rb/resources/models/ReviewRequest', function() {\n    let reviewRequest;\n    let callbacks;\n\n    beforeEach(function() {\n        reviewRequest = new RB.ReviewRequest({\n            id: 1,\n        });\n\n        callbacks = {\n            success: () => {},\n            error: () => {},\n        };\n\n        spyOn(callbacks, 'success');\n        spyOn(callbacks, 'error');\n\n        spyOn(reviewRequest, 'ready').and.callFake(\n            (options, context) => options.ready.call(context));\n    });\n\n    it('createDiff', function() {\n        const diff = reviewRequest.createDiff();\n\n        expect(diff.get('parentObject')).toBe(reviewRequest);\n    });\n\n    it('createScreenshot', function() {\n        const screenshot = reviewRequest.createScreenshot(42);\n\n        expect(screenshot.get('parentObject')).toBe(reviewRequest);\n        expect(screenshot.id).toBe(42);\n    });\n\n    it('createFileAttachment', function() {\n        const fileAttachment = reviewRequest.createFileAttachment({\n            id: 42,\n        });\n\n        expect(fileAttachment.get('parentObject')).toBe(reviewRequest);\n        expect(fileAttachment.id).toBe(42);\n    });\n\n    it('parse', function() {\n        const data = reviewRequest.parse({\n            stat: 'ok',\n            review_request: {\n                id: 1,\n                branch: 'branch',\n                bugs_closed: 'bugsClosed',\n                close_description: 'closeDescription',\n                close_description_text_type: 'markdown',\n                description: 'description',\n                description_text_type: 'markdown',\n                last_updated: 'lastUpdated',\n                'public': 'public',\n                summary: 'summary',\n                target_groups: 'targetGroups',\n                target_people: 'targetPeople',\n                testing_done: 'testingDone',\n                testing_done_text_type: 'plain',\n            },\n        });\n\n        expect(data).not.toBe(undefined);\n        expect(data.id).toBe(1);\n        expect(data.branch).toBe('branch');\n        expect(data.bugsClosed).toBe('bugsClosed');\n        expect(data.closeDescription).toBe('closeDescription');\n        expect(data.closeDescriptionRichText).toBe(true);\n        expect(data.description).toBe('description');\n        expect(data.descriptionRichText).toBe(true);\n        expect(data.lastUpdated).toBe('lastUpdated');\n        expect(data.public).toBe('public');\n        expect(data.summary).toBe('summary');\n        expect(data.targetGroups).toBe('targetGroups');\n        expect(data.targetPeople).toBe('targetPeople');\n        expect(data.testingDone).toBe('testingDone');\n        expect(data.testingDoneRichText).toBe(false);\n    });\n\n    it('reopen', function() {\n        spyOn(RB, 'apiCall').and.callThrough();\n        spyOn($, 'ajax').and.callFake(request => {\n            expect(request.type).toBe('PUT');\n            expect(request.data.status).toBe('pending');\n\n            request.success({\n                stat: 'ok',\n                review_request: {\n                    id: 1,\n                    links: {},\n                },\n            });\n        });\n\n        reviewRequest.reopen({\n            success: callbacks.success,\n            error: callbacks.error,\n        });\n\n        expect(RB.apiCall).toHaveBeenCalled();\n        expect($.ajax).toHaveBeenCalled();\n        expect(callbacks.success).toHaveBeenCalled();\n        expect(callbacks.error).not.toHaveBeenCalled();\n    });\n\n    describe('createReview', function() {\n        it('With review ID', function() {\n            const review = reviewRequest.createReview(42);\n\n            expect(review.get('parentObject')).toBe(reviewRequest);\n            expect(review.get('id')).toBe(42);\n            expect(reviewRequest.get('draftReview')).toBe(null);\n            expect(reviewRequest.reviews.length).toBe(1);\n            expect(reviewRequest.reviews.get(42)).toBe(review);\n        });\n\n        it('Without review ID', function() {\n            const review1 = reviewRequest.createReview();\n            const review2 = reviewRequest.createReview();\n\n            expect(review1.get('parentObject')).toBe(reviewRequest);\n            expect(review1.id).toBeFalsy();\n            expect(reviewRequest.get('draftReview')).toBe(review1);\n            expect(review1).toBe(review2);\n            expect(reviewRequest.reviews.length).toBe(0);\n        });\n    });\n\n    describe('setStarred', function() {\n        const url = '/api/users/testuser/watched/review-requests/';\n        let session;\n\n        beforeEach(function() {\n            RB.UserSession.instance = null;\n            session = RB.UserSession.create({\n                username: 'testuser',\n                watchedReviewRequestsURL: url,\n            });\n\n            spyOn(session.watchedReviewRequests, 'addImmediately')\n                .and.callThrough();\n            spyOn(session.watchedReviewRequests, 'removeImmediately')\n                .and.callThrough();\n            spyOn(RB, 'apiCall').and.callThrough();\n        });\n\n        it('true', function() {\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.type).toBe('POST');\n                expect(request.url).toBe(url);\n\n                request.success({\n                    stat: 'ok',\n                });\n            });\n\n            reviewRequest.setStarred(true, callbacks);\n\n            expect(session.watchedReviewRequests.addImmediately)\n                .toHaveBeenCalled();\n            expect(RB.apiCall).toHaveBeenCalled();\n            expect($.ajax).toHaveBeenCalled();\n            expect(callbacks.success).toHaveBeenCalled();\n            expect(callbacks.error).not.toHaveBeenCalled();\n        });\n\n        it('false', function() {\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.type).toBe('DELETE');\n                expect(request.url).toBe(url + '1/');\n\n                request.success({\n                    stat: 'ok',\n                });\n            });\n\n            reviewRequest.setStarred(false, callbacks);\n\n            expect(session.watchedReviewRequests.removeImmediately)\n                .toHaveBeenCalled();\n            expect(RB.apiCall).toHaveBeenCalled();\n            expect($.ajax).toHaveBeenCalled();\n            expect(callbacks.success).toHaveBeenCalled();\n            expect(callbacks.error).not.toHaveBeenCalled();\n        });\n    });\n\n    describe('close', function() {\n        it('With type=CLOSE_DISCARDED', function() {\n            spyOn(RB, 'apiCall').and.callThrough();\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.type).toBe('PUT');\n                expect(request.data.status).toBe('discarded');\n                expect(request.data.description).toBe(undefined);\n\n                request.success({\n                    stat: 'ok',\n                    review_request: {\n                        id: 1,\n                        links: {},\n                    },\n                });\n            });\n\n            reviewRequest.close({\n                type: RB.ReviewRequest.CLOSE_DISCARDED,\n                success: callbacks.success,\n                error: callbacks.error,\n            });\n\n            expect(RB.apiCall).toHaveBeenCalled();\n            expect($.ajax).toHaveBeenCalled();\n            expect(callbacks.success).toHaveBeenCalled();\n            expect(callbacks.error).not.toHaveBeenCalled();\n        });\n\n        it('With type=CLOSE_SUBMITTED', function() {\n            spyOn(RB, 'apiCall').and.callThrough();\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.type).toBe('PUT');\n                expect(request.data.status).toBe('submitted');\n                expect(request.data.description).toBe(undefined);\n\n                request.success({\n                    stat: 'ok',\n                    review_request: {\n                        id: 1,\n                        links: {},\n                    }\n                });\n            });\n\n            reviewRequest.close({\n                type: RB.ReviewRequest.CLOSE_SUBMITTED,\n                success: callbacks.success,\n                error: callbacks.error,\n            });\n\n            expect(RB.apiCall).toHaveBeenCalled();\n            expect($.ajax).toHaveBeenCalled();\n            expect(callbacks.success).toHaveBeenCalled();\n            expect(callbacks.error).not.toHaveBeenCalled();\n        });\n\n        it('With invalid type', function() {\n            spyOn(RB, 'apiCall').and.callThrough();\n            spyOn($, 'ajax');\n\n            reviewRequest.close({\n                type: 'foo',\n                success: callbacks.success,\n                error: callbacks.error,\n            });\n\n            expect(RB.apiCall).not.toHaveBeenCalled();\n            expect($.ajax).not.toHaveBeenCalled();\n            expect(callbacks.success).not.toHaveBeenCalled();\n            expect(callbacks.error).toHaveBeenCalled();\n        });\n\n        it('With description', function() {\n            spyOn(RB, 'apiCall').and.callThrough();\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.type).toBe('PUT');\n                expect(request.data.status).toBe('submitted');\n                expect(request.data.close_description).toBe('test');\n\n                request.success({\n                    stat: 'ok',\n                    review_request: {\n                        id: 1,\n                        links: {},\n                    },\n                });\n            });\n\n            reviewRequest.close({\n                type: RB.ReviewRequest.CLOSE_SUBMITTED,\n                description: 'test',\n                success: callbacks.success,\n                error: callbacks.error,\n            });\n\n            expect(RB.apiCall).toHaveBeenCalled();\n            expect($.ajax).toHaveBeenCalled();\n            expect(callbacks.success).toHaveBeenCalled();\n            expect(callbacks.error).not.toHaveBeenCalled();\n        });\n    });\n});\n"]}