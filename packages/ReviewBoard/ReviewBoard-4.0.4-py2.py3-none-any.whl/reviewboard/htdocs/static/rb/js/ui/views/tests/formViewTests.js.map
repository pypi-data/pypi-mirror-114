{"version":3,"sources":["formViewTests.es6.js"],"names":[],"mappings":"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","file":"formViewTests.js","sourcesContent":["suite('rb/ui/views/FormView', function() {\n    const template = dedent`\n        <form class=\"rb-c-form\">\n         <select id=\"subform1-selector\"\n                 data-subform-group=\"group1\">\n          <option value=\"subform1\">subform1</option>\n          <option value=\"subform2\">subform2</option>\n         </select>\n\n         <fieldset class=\"rb-c-form-fieldset\">\n          <legend class=\"rb-c-form-fieldset__name\">\n           Title\n           <a href=\"#\" class=\"rb-c-form-fieldset__toggle\">(Hide)</a>\n          </legend>\n          <div class=\"rb-c-form-fieldset__content\"></div>\n         </fieldset>\n         <fieldset class=\"rb-c-form-fieldset -is-collapsed\">\n          <legend class=\"rb-c-form-fieldset__name\">\n           Title\n           <a href=\"#\" class=\"rb-c-form-fieldset__toggle\">(Show)</a>\n          </legend>\n          <div class=\"rb-c-form-fieldset__content\"></div>\n         </fieldset>\n\n         <fieldset class=\"rb-c-form-fieldset -is-subform\"\n                   data-subform-controller=\"subform1-selector\"\n                   data-subform-id=\"subform1\">\n         </fieldset>\n         <fieldset class=\"rb-c-form-fieldset -is-subform\"\n                   data-subform-controller=\"subform1-selector\"\n                   data-subform-id=\"subform2\">\n         </fieldset>\n\n         <fieldset class=\"rb-c-form-fieldset -is-subform\"\n                   data-subform-group=\"group2\"\n                   data-subform-id=\"subform3\">\n         </fieldset>\n         <fieldset class=\"rb-c-form-fieldset -is-subform\"\n                   data-subform-group=\"group2\"\n                   data-subform-id=\"subform4\"\n                   disabled hidden>\n         </fieldset>\n        </form>\n    `;\n\n    let view;\n    let $subforms;\n\n    beforeEach(function() {\n        view = new RB.FormView({\n            el: $(template),\n        });\n        view.render().$el.appendTo($testsScratch);\n\n        $subforms = view._$subforms;\n    });\n\n    function checkSubformVisibility(index, visible) {\n        const $subform = $subforms.eq(index);\n\n        expect($subform.prop('disabled')).toBe(!visible);\n        expect($subform.prop('hidden')).toBe(!visible);\n    }\n\n    describe('Fieldsets', function() {\n        it('Collapsing', function() {\n            const $fieldset = view.$('.rb-c-form-fieldset').eq(0);\n\n            expect($fieldset.hasClass('-is-collapsed')).toBe(false);\n\n            $fieldset.find('.rb-c-form-fieldset__toggle').click();\n\n            expect($fieldset.hasClass('-is-collapsed')).toBe(true);\n            expect($fieldset.find('.rb-c-form-fieldset__toggle').text())\n                .toBe('(Show)');\n        });\n\n        it('Expanding', function() {\n            const $fieldset = view.$('.rb-c-form-fieldset').eq(1);\n\n            expect($fieldset.hasClass('-is-collapsed')).toBe(true);\n\n            $fieldset.find('.rb-c-form-fieldset__toggle').click();\n\n            expect($fieldset.hasClass('-is-collapsed')).toBe(false);\n            expect($fieldset.find('.rb-c-form-fieldset__toggle').text())\n                .toBe('(Hide)');\n        });\n    });\n\n    describe('Subforms', function() {\n        it('Loaded state', function() {\n            expect($subforms.length).toBe(4);\n            expect(_.keys(view._subformsByGroup))\n                .toEqual(['group1', 'group2']);\n            expect(_.keys(view._subformsByGroup.group1))\n                .toEqual(['subform1', 'subform2']);\n            expect(_.keys(view._subformsByGroup.group2))\n                .toEqual(['subform3', 'subform4']);\n            expect(view._subformsByGroup.group1.subform1[0])\n                .toBe($subforms[0]);\n            expect(view._subformsByGroup.group1.subform2[0])\n                .toBe($subforms[1]);\n            expect(view._subformsByGroup.group2.subform3[0])\n                .toBe($subforms[2]);\n            expect(view._subformsByGroup.group2.subform4[0])\n                .toBe($subforms[3]);\n\n            checkSubformVisibility(0, true);\n            checkSubformVisibility(1, false);\n            checkSubformVisibility(2, true);\n            checkSubformVisibility(3, false);\n        });\n\n        it('Controller value changed', function() {\n            view.$el.children('select')\n                .val('subform2')\n                .triggerHandler('change');\n\n            checkSubformVisibility(0, false);\n            checkSubformVisibility(1, true);\n            checkSubformVisibility(2, true);\n            checkSubformVisibility(3, false);\n        });\n    });\n\n    describe('Methods', function() {\n        describe('setSubformVisibility', function() {\n            it('With group', function() {\n                view.setSubformVisibility({\n                    group: 'group2',\n                });\n\n                checkSubformVisibility(2, false);\n                checkSubformVisibility(3, false);\n            });\n\n            it('With group, visible', function() {\n                view.setSubformVisibility({\n                    group: 'group2',\n                    visible: true,\n                });\n\n                checkSubformVisibility(2, true);\n                checkSubformVisibility(3, true);\n\n                view.setSubformVisibility({\n                    group: 'group2',\n                    visible: false,\n                });\n\n                checkSubformVisibility(2, false);\n                checkSubformVisibility(3, false);\n            });\n\n            it('With group, subformID, visible', function() {\n                checkSubformVisibility(2, true);\n\n                view.setSubformVisibility({\n                    group: 'group2',\n                    subformID: 'subform3',\n                    visible: false,\n                });\n\n                checkSubformVisibility(2, false);\n                checkSubformVisibility(3, false);\n\n                view.setSubformVisibility({\n                    group: 'group2',\n                    subformID: 'subform4',\n                    visible: true,\n                });\n\n                checkSubformVisibility(3, true);\n            });\n\n            it('With group, subformID, visible, hideOthers', function() {\n                view.setSubformVisibility({\n                    group: 'group1',\n                    subformID: 'subform2',\n                    visible: true,\n                    hideOthers: true,\n                });\n\n                checkSubformVisibility(0, false);\n                checkSubformVisibility(1, true);\n\n                view.setSubformVisibility({\n                    group: 'group1',\n                    subformID: 'subform1',\n                    visible: true,\n                    hideOthers: true,\n                });\n\n                checkSubformVisibility(0, true);\n                checkSubformVisibility(1, false);\n            });\n        });\n    });\n});\n"]}