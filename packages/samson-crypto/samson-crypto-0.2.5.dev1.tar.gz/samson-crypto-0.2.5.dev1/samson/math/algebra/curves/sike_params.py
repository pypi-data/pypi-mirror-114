from samson.math.algebra.rings.integer_ring import ZZ
from samson.math.symbols import Symbol
from samson.math.algebra.fields.finite_field import FiniteField as GF
from samson.math.algebra.curves.montgomery_curve import MontgomeryCurve

# Parameters from "Supersingular Isogeny Key Encapsulation"
# except the R point `y` coordinates. Had to calculate those myself
sike_params = {
    'SIKEp434': {
        'p': 0x0002341F271773446CFC5FD681C520567BC65C783158AEA3FDC1767AE2FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF,
        'e2': 0x000000D8,
        'e3': 0x00000089,
        'xQ20': 0x0000C7461738340EFCF09CE388F666EB38F7F3AFD42DC0B664D9F461F31AA2EDC6B4AB71BD42F4D7C058E13F64B237EF7DDD2ABC0DEB0C6C,
        'xQ21': 0x000025DE37157F50D75D320DD0682AB4A67E471586FBC2D31AA32E6957FA2B2614C4CD40A1E27283EAAF4272AE517847197432E2D61C85F5,
        'yQ20': 0x0001D407B70B01E4AEE172EDF491F4EF32144F03F5E054CEF9FDE5A35EFA3642A11817905ED0D4F193F31124264924A5F64EFE14B6EC97E5,
        'yQ21': 0x0000E7DEC8C32F50A4E735A839DCDB89FE0763A184C525F7B7D0EBC0E84E9D83E9AC53A572A25D19E1464B509D97272AE761657B4765B3D6,
        'xP20': 0x00003CCFC5E1F050030363E6920A0F7A4C6C71E63DE63A0E6475AF621995705F7C84500CB2BB61E950E19EAB8661D25C4A50ED279646CB48,
        'xP21': 0x0001AD1C1CAE7840EDDA6D8A924520F60E573D3B9DFAC6D189941CB22326D284A8816CC4249410FE80D68047D823C97D705246F869E3EA50,
        'yP20': 0x0001AB066B84949582E3F66688452B9255E72A017C45B148D719D9A63CDB7BE6F48C812E33B68161D5AB3A0A36906F04A6A6957E6F4FB2E0,
        'yP21': 0x0000FD87F67EA576CE97FF65BF9F4F7688C4C752DCE9F8BD2B36AD66E04249AAF8337C01E6E4E1A844267BA1A1887B433729E1DD90C7DD2F,
        'xR20': 0x0000F37AB34BA0CEAD94F43CDC50DE06AD19C67CE4928346E829CB92580DA84D7C36506A2516696BBE3AEB523AD7172A6D239513C5FD2516,
        'xR21': 0x000196CA2ED06A657E90A73543F3902C208F410895B49CF84CD89BE9ED6E4EE7E8DF90B05F3FDB8BDFE489D1B3558E987013F9806036C5AC,
        'yR20': 0x7F65B303A50EF1B4192237611E226A3D13384EF608A6B117365A16E0EB5112156F2012CB029C819F3330F69BD5C73CCC9A1F1C06CD15,
        'yR21': 0x749095AB8A36C841FBF25A5671A67FDE5023131C73F0EC6031C7E472DAE138FBED0A0BE63C6706CD893EF88D32CC766EC67EC056ED33,
        'xQ30': 0x00012E84D7652558E694BF84C1FBDAAF99B83B4266C32EC65B10457BCAF94C63EB063681E8B1E7398C0B241C19B9665FDB9E1406DA3D3846,
        'xQ31': 0x00000000,
        'yQ30': 0x00000000,
        'yQ31': 0x0000EBAAA6C731271673BEECE467FD5ED9CC29AB564BDED7BDEAA86DD1E0FDDF399EDCC9B49C829EF53C7D7A35C3A0745D73C424FB4A5FD2,
        'xP30': 0x00008664865EA7D816F03B31E223C26D406A2C6CD0C3D667466056AAE85895EC37368BFC009DFAFCB3D97E639F65E9E45F46573B0637B7A9,
        'xP31': 0x00000000,
        'yP30': 0x00006AE515593E73976091978DFBD70BDA0DD6BCAEEBFDD4FB1E748DDD9ED3FDCF679726C67A3B2CC12B39805B32B612E058A4280764443B,
        'yP31': 0x00000000,
        'xR30': 0x0001CD28597256D4FFE7E002E87870752A8F8A64A1CC78B5A2122074783F51B4FDE90E89C48ED91A8F4A0CCBACBFA7F51A89CE518A52B76C,
        'xR31': 0x000147073290D78DD0CC8420B1188187D1A49DBFA24F26AAD46B2D9BB547DBB6F63A760ECB0C2B20BE52FB77BD2776C3D14BCBC404736AE4,
        'yR30': 0xDA7A98EA26469B843EBF8D1EE0F00E6786E680AC535F5FF26D25819549C959497D8E8FB14B1BF6764BD27BAE970D0791AF091E344F22,
        'yR31': 0x48704FEC03D05B06D8A8197DF08D4946E465099F31B75C63A865A23CA2AD41A74F05074E9DC3F45C5A26F741A0EA1F3C2E6CDA0BB344
    },
    'SIKEp610': {
        'p': 0x000000027BF6A768819010C251E7D88CB255B2FA10C4252A9AE7BF45048FF9ABB1784DE8AA5AB02E6E01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF,
        'e2': 0x00000131,
        'e3': 0x000000C0,
        'xQ20': 0x25DA39EC90CDFB9BC0F772CDA52CB8B5A9F478D7AF8DBBA0AEB3E52432822DD88C38F4E3AEC0746E56149F1FE89707C77F8BA4134568629724F4A8E34B06BFE5C5E66E0867EC38B283798B8A,
        'xQ21': 0x00000002250E1959256AE502428338CB4715399551AEC78D8935B2DC73FCDCFBDB1A0118A2D3EF03489BA6F637B1C7FEE7E5F31340A1A537B76B5B736B4CDD284918918E8C986FC02741FB8C98F0A0ED,
        'yQ20': 0xA4FD5539025C0611E4B1CEC3C36F0D7590C035D3A25AD93022849CCEB3F67E4B1DBE988404290DD8B87B8D5E69ED3B0C5CDBCA248DC9D174CF762012CFE2D725CFD92057F2DBF8B04C7B12CC,
        'yQ21': 0x0000000201C807BD738624E22B87554A2E053A46A9573BA863D4A9D309533E30B27BF7DD8137F5CE0F79C263D9D050541D69817A839085A76395F879315F6999E3441FC8FB3936DEE1BEF5B4E0E25096,
        'xP20': 0x00000001B368BC6019B46CD802129209B3E65B98BC64A92BC4DB2F9F3AC96B97A1B9C124DF549B528F18BEECB1666D27D47530435E84221272F3A97FB80527D8F8A359F8F1598D365744CA3070A5F26C,
        'xP21': 0x00000001459685DCA7112D1F6030DBC98F2C9CBB41617B6AD913E6523416CCBD8ED9C7841D97DF83092B9B3F2AF00D62E08DAD8FA743CBCCCC1782BE0186A3432D3C97C37CA16873BEDE01F0637C1AA2,
        'yP20': 0x00000001CD75CF512FFA9DF878EF495001A57ABC07FC7CE9BB488BB52DDCD7272D8A4FD17DD258ED3F844C862CF48803B9AC2668C7CB79C396128763B578080C30D14CA7EB709F98E3E682A391FB35A7,
        'yP21': 0x00000002001062A6289E4082CED884029207A1ACDEC525D7BC165A6CFF8BB469A8588950A416DBB924D2D673E3D6C32D232F6E6ADA62B37608F652C0B8628827B304BF1365D8211346207B24EFF09458,
        'xR20': 0x00000001B36A006D05F9E370D5078CCA54A16845B2BFF737C865368707C0DBBE9F5A62A9B9C79ADF11932A9FA4806210E25C92DB019CC146706DFBC7FA2638ECC4343C1E390426FAA7F2F07FDA163FB5,
        'xR21': 0x0000000183C9ABF2297CA69699357F58FED92553436BBEBA2C3600D89522E7009D19EA5D6C18CFF993AA3AA33923ED93592B0637ED0B33ADF12388AE912BC4AE4749E2DF3C3292994DCF37747518A992,
        'yR20': 0x238A9A93F5903E6255D98642CB874F1CCA78397FB790946DA62068F019CEC14E5ED618C8E3A0630AD07F28067790385767E94FA539EF67E8BE0EA264AFCCA6DFE3C4F72F8ED275801542163BB,
        'yR21': 0x21AA050780357A59F6B2A94CF2BF300F5CA7BCDBBE96A206A635473C6360418F663E8EE10DEE59E6D11803CBA45ED44449DD67324654F2B2D16AF4F826A0BBD83CF2834BA74E45D433A6F8DCD,
        'xQ30': 0x000000014E647CB19B7EAAAC640A9C26B9C26DB7DEDA8FC9399F4F8CE620D2B2200480F4338755AE16D0E090F15EA1882166836A478C6E161C938E4EB8C2DD779B45FFDD17DCDF158AF48DE126B3A047,
        'xQ31': 0x00000000,
        'yQ30': 0x00000000,
        'yQ31': 0xE674067F5EA6DE85545C0A99E9E71E64FABFDC281D1E540FEDA47A56ED3ADCDDE1841083FABC7954B467C71AC6349B04974A7F9B688C5F735632FEB394146B0A080880069D8DA3324EDF795B,
        'xP30': 0x00000001587822E647707ED4313D3BE6A811A694FB201561111838A0816BFB5DEC625D23772DE48A26D78C04EEB26CA4A571C67CE4DC4C620282876B2F2FC2633CA548C3AB0C45CC991417A56F7FEFEB,
        'xP31': 0x00000000,
        'yP30': 0x14F295114B69D4769AC06DD07F051AD1114BCB7FA6B6EDE19F840969AFD56FD1F728907D3320A0309462A9444D24FE754666DB2470080951B31C2AC59704ABC7670C3C3A992C3C1629791F30,
        'yP31': 0x00000000,
        'xR30': 0x00000001DB73BC2DE666D24E59AF5E23B79251BA0D189629EF87E56C38778A448FACE312D08EDFB876C3FD45ECF3746D96E2CADBBA08B1A206C47DDD93137059E34C90E2E42E10F30F6E5F52DED74222,
        'xR31': 0x00000001B2C30180DAF5D91871555CE8EFEC76A4D521F877B754311228C7180A3E2318B4E7A00341FF99F34E35BF7A1053CA76FD77C0AFAE38E2091862AB4F1DD4C8D9C83DE37ACBA6646EDB4C238B48,
        'yR30': 0x2161305C61BC5F808910F2FDB839A1417F2336584524A82F3FFF7F1530D933D971C04DC17B27F242E2D620AF7191D5FB630C7D7C0E51A01D77FA6B4B7103714980ACF4934E79CCF74B70E17DA,
        'yR31': 0xF6A490F49872B6FD1B082926E328533AB786E1166771C7730F40183A5E7729F554F2029C030C4C0AF8B4E53C24ED5C46E446ACAB7C07F78A363617E23CDDC6000E2EAF2A9FA62204C972D406
    },
    'SIKEp751': {
        'p': 0x00006FE5D541F71C0E12909F97BADC668562B5045CB25748084E9867D6EBE876DA959B1A13F7CC76E3EC968549F878A8EEAFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF,
        'e2': 0x00000174,
        'e3': 0x000000EF,
        'xQ20': 0x00001723D2BFA01A78BF4E39E3A333F8A7E0B415A17F208D3419E7591D59D8ABDB7EE6D2B2DFCB21AC29A40F837983C0F057FD041AD93237704F1597D87F074F682961A38B5489D1019924F8A0EF5E4F1B2E64A7BA536E219F5090F76276290E,
        'xQ21': 0x00002569D7EAFB6C60B244EF49E05B5E23F73C4F44169A7E02405E90CEB680CB0756054AC0E3DCE95E2950334262CC973235C2F87D89500BCD465B078BD0DEBDF322A2F86AEDFDCFEE65C09377EFBA0C5384DD837BEDB710209FBC8DDB8C35C7,
        'yQ20': 0x000035B82D1BD2BA608B42794C4820C56A3D8BBAD28380B8D85A1910E2609A61F7BC0BCA8ED8EF883E7E98C744A0AC85D2893738521B62EB23D1983D2EDCF2AB437108DC048AA853FF9BC791224B121E8FDF1EA5F617E6ED5898663DDED49154,
        'yQ21': 0x00000F22306A6963907F16AA38F89C672A4054DB5FD1D26598A3140EA204B10094AE64093142AEB056942494D216A74ED9F51FFC9272D1772151013334EC570B532DB0C083CF39867F63D191029033F942E977B85F69EC738B4C26D3B72E2821,
        'xP20': 0x00004514F8CC94B140F24874F8B87281FA6004CA5B3637C68AC0C0BDB29838051F385FBBCC300BBB24BFBBF6710D7DC8B29ACB81E429BD1BD5629AD0ECAD7C90622F6BB801D0337EE6BC78A7F12FDCB09DECFAE8BFD643C89C3BAC1D87F8B6FA,
        'xP21': 0x0000158ABF500B5914B3A96CED5FDB37D6DD925F2D6E4F7FEA3CC16E1085754077737EA6F8CC74938D971DA289DCF2435BCAC1897D2627693F9BB167DC01BE34AC494C60B8A0F65A28D7A31EA0D54640653A8099CE5A84E4F0168D818AF02041,
        'yP20': 0x00000BF6E4E7A28E9A6EF66A2F1614AE2A2B5A583C9F2DC6C83F84E2D9E6577F9E22B991D58FB2F89666DC1D40A2C0A3AB876CF8DA8878F12325BF8B0CF92E45AE00627041C891BC96FFBB874FC587E4342F78098258DF2E10A5708A70A0D5A8,
        'yP21': 0x00001502FB44178D1DF80A53858519CBCF233FE387905BC8F9E4138703C6DB7C82302FBFB7E97153F6001FE9102D2597AC2B300A1C669D1A2803F8D05BA3B1F2ACBF27BC1A127B4A553916D62004FD21633C5AEAAB74833853B4C5C42EB71F7E,
        'xR20': 0x00006066E07F3C0D964E8BC963519FAC8397DF477AEA9A067F3BE343BC53C883AF29CCF008E5A30719A29357A8C33EB3600CD078AF1C40ED5792763A4D213EBDE44CC623195C387E0201E7231C529A15AF5AB743EE9E7C9C37AF3051167525BB,
        'xR21': 0x000050E30C2C06494249BC4A144EB5F31212BD05A2AF0CB3064C322FC3604FC5F5FE3A08FB3A02B05A48557E15C992254FFC8910B72B8E1328B4893CDCFBFC003878881CE390D909E39F83C5006E0AE979587775443483D13C65B107FADA5165,
        'yR20': 0x33A5D03B4722324C224F88891D31D355F0006FF64623628389921606DC373FE59E07B554A29B1339D3F938466E57F117DC08031BA5FA5D9509C9FE9E02697273F85479101322AC8F626C3354186A1284105E14C6FF0FC6CA7DF926D2E0DB,
        'yR21': 0x51DD90C1CE350082BAE3D82B0A782254F9F8140084388EBC8E2B19BE5005974DBC778E64906C851779187BFB6A9B024DE7692DE9506EB4BA3C454CF0D9A4B8D0B22E0E7BCAC046E2F75512B202F6AEE7B87982EB139AF4F90910127336CA,
        'xQ30': 0x00005BF9544781803CBD7E0EA8B96D934C5CBCA970F9CC327A0A7E4DAD931EC29BAA8A854B8A9FDE5409AF96C5426FA375D99C68E9AE714172D7F04502D45307FA4839F39A28338BBAFD54A461A535408367D5132E6AA0D3DA6973360F8CD0F1,
        'xQ31': 0x00000000,
        'yQ30': 0x00000000,
        'yQ31': 0x00003351F421FC158472AC2DD8B4DABB5B599456748A5BCC4449398F05ED1AD1414B4EEBBB70FB91383474B712EA4B5BF096092CDDD57C0A090B041022064C3A8DD3D890E7B5AC34A24CEF507955F027CC4CECFDB67739CE89F31FDC5FE43243,
        'xP30': 0x0000605D4697A245C394B98024A5554746DC12FF56D0C6F15D2F48123B6D9C498EEE98E8F7CD6E216E2F1FF7CE0C969CCA29CAA2FAA57174EF985AC0A504260018760E9FDF67467E20C13982FF5B49B8BEAB05F6023AF873F827400E453432FE,
        'xP31': 0x00000000,
        'yP30': 0x00005634690BFC14C45E2FAA930D62589855E5BDD1435CFFBDF609628FD043B4BF295BB35F7B6D37836F2C59A27BB61ED0FF57FF8093FE6B712133D26502F17CB0D46CDC8CF9BA7664EA2B6C1672A8CA2FF1CE313FEEEF4199FC7F14FE720617,
        'yP31': 0x00000000,
        'xR30': 0x000055E5124A05D4809585F67FE9EA1F02A06CD411F38588BB631BF789C3F98D1C3325843BB53D9B011D8BD1F682C0E4D8A5E723364364E40DAD1B7A476716AC7D1BA705CCDD680BFD4FE4739CC21A9A59ED544B82566BF633E8950186A79FE3,
        'xR31': 0x00005AC57EAFD6CC7569E8B53A148721953262C5B404C143380ADCC184B6C21F0CAFE095B7E9C79CA88791F9A72F1B2F3121829B2622515B694A16875ED637F421B539E66F2FEF1CE8DCEFC8AEA608055E9C44077266AB64611BF851BA06C821,
        'yR30': 0x4A36B4D126FD7A2F6067D94F1080B45224FBB609FC0F652367978F3B2F32A3634B2DABBC725D31C909B9464757B5B370DC1553FD7A0EA9816DE26DEC5CF78A787790B80C646FA77CE6EE984A33E0EF60DD76BECBA83AF6551CFE3058AE32,
        'yR31': 0x3C9D999C9846FB502DFC5945693DB5B2C9B7BF90AC772DD2F42E4FC546735AC07247250F797711A5D4A5E59A62336D162EAB108427859F56710A3C7B125449FE7054D99885465D2589A6479BA51C46EF7783734CB370ACBA8D4B2D537E48
    }
}



all_curves = {}
for name, params in sike_params.items():
    p = params['p']
    R = ZZ/ZZ(p)
    i = Symbol('i')
    _ = R[i]
    F = GF(p, 2, reducing_poly=i**2+1)

    M = MontgomeryCurve(F(6))

    points = []
    for point in ['P2', 'Q2', 'R2', 'P3', 'Q3', 'R3']:
        x, y = [params[f'{coord}{point}0'] + params[f'{coord}{point}1']*i for coord in ['x', 'y']]
        points.append(M(x, y))

    M.P2, M.Q2, M.R2, M.P3, M.Q3, M.R3 = points
    two_order   = 2**params['e2']
    three_order = 3**params['e3']

    M.P2.order_cache = two_order
    M.Q2.order_cache = two_order
    M.P3.order_cache = three_order
    M.Q3.order_cache = three_order

    all_curves[name] = M


SIKEp434 = all_curves['SIKEp434']
SIKEp610 = all_curves['SIKEp610']
SIKEp751 = all_curves['SIKEp751']
