from samson.prngs.xorshift import Xorshift32, Xorshift64, Xorshift128, Xorshift128Plus, Xorshift116Plus, Xorshift1024Star, MASK58
from samson.core.iterative_prng import IterativePRNG
from samson.utilities.bytes import Bytes
import unittest


class XorshiftTestCase(unittest.TestCase):
    # We include a `modifier` parameter since Erlang/Elixir's rand starts from 1 instead of 0.
    def _run_test(self, seed, variant, expected_outputs, modifier):
        xs = variant(seed)
        self.assertEqual([xs.generate() + modifier for _ in range(len(expected_outputs))], expected_outputs)


    # Reference code

    # #include <stdint.h>
    # #include <stdio.h>
    # #include <inttypes.h>

    # /* The state word must be initialized to non-zero */
    # uint32_t xorshift32(uint32_t state[static 1])
    # {
    # 	/* Algorithm "xor" from p. 4 of Marsaglia, "Xorshift RNGs" */
    # 	uint32_t x = state[0];
    # 	x ^= x << 13;
    # 	x ^= x >> 17;
    # 	x ^= x << 5;
    # 	state[0] = x;
    # 	return x;
    # }

    # uint64_t xorshift64(uint64_t state[static 1])
    # {
    # 	uint64_t x = state[0];
    # 	x^= x << 13;
    # 	x^= x >> 7;
    # 	x^= x << 17;
    # 	state[0] = x;
    # 	return x;
    # }

    # /* The state array must be initialized to not be all zero */
    # uint64_t xorshift128(uint64_t state[static 4])
    # {
    # 	/* Algorithm "xor128" from p. 5 of Marsaglia, "Xorshift RNGs" */
    # 	uint64_t s, t = state[3];
    # 	t ^= t << 11;
    # 	t ^= t >> 8;
    # 	state[3] = state[2]; state[2] = state[1]; state[1] = s = state[0];
    # 	t ^= s;
    # 	t ^= s >> 19;
    # 	state[0] = t;
    # 	return t;
    # }


    # int main( int argc, const char* argv[] )
    # {
    # 	//printf( "\nHello World\n\n" );
    #     uint64_t state[4]= {123456789, 362436069, 521288629, 88675123};
    # 	uint32_t v32[1]= {123456789};
    #     for(int i = 0; i < 1000; i++) {
    # 		// printf("%"PRIu64"\n", xorshift128(state));
    # 		printf("%"PRIu32", ", xorshift32(v32));
    #     }
    # }

    def test_32(self):
        seed = [123456789]

        modifier = 0
        variant = Xorshift32
        expected_outputs = [2714967881, 2238813396, 1250077441, 3820100336, 3177519686, 3684138832, 3151087790, 3662508108, 4242376622, 3374601978, 1016977383, 1246752311, 1185147795, 1105418523, 1925554971, 309504328, 2888488517, 715369396, 2775945118, 2219769469, 732890141, 2931093739, 630759263, 4162840742, 2758700611, 1566664848, 2115585417, 2208404861, 2428752570, 3087538672, 3724462347, 2670381028, 1024632303, 1547785784, 2789982747, 521236223, 1797022872, 376306879, 2528329730, 685544507, 4046359510, 719266940, 71870932, 1060506829, 727032026, 1989886173, 3466402877, 3461078192, 242044318, 1543835729, 1072080278, 2178291644, 655848364, 3845158077, 2673052846, 906052205, 3620815915, 366947233, 3854896500, 3374204769, 1069454488, 1217504206, 3789810426, 186675236, 2713363574, 1404552044, 3499673249, 3252474471, 697559631, 3483247714, 1767791755, 4213362796, 2228166555, 2159398053, 487552661, 2288533531, 2366072302, 1458058067, 1087183186, 2667723905, 3403442632, 3142323578, 1720275307, 3626430489, 3265245803, 2928396354, 671060963, 1710275938, 969166284, 3218025394, 227646254, 3766275796, 1298674407, 766122205, 3095428901, 1542723191, 4268345258, 352352356, 1536317730, 108281433, 3058994758, 3558337672, 425324843, 3370962997, 262238528, 279269636, 3929277574, 1044040532, 2371839868, 1470767908, 1780216483, 2646378500, 2604516634, 1347161717, 3789164596, 3628399258, 2783230769, 1657982064, 1355213342, 1026094940, 1538240797, 470072507, 4192253746, 265721489, 2107628147, 1559157371, 1939786955, 3942170824, 2933296824, 2671220280, 3554982080, 3681537406, 2059640798, 775107330, 1111077451, 4201506323, 2472218052, 2929549845, 1495772218, 951580458, 201872483, 3590509313, 3412784, 3357020473, 2379600102, 3471338306, 3012106946, 2331199466, 2747312973, 1669550905, 896175787, 4081336948, 441778641, 4152418342, 2601445732, 2188051669, 3167445005, 3382682984, 2607138257, 1478587390, 3180303089, 3051566649, 3081472715, 413384690, 2229584860, 2406940659, 1100890455, 3207091245, 1601947, 3410609998, 2276437342, 848224220, 3352315814, 733537972, 3668041059, 3233050949, 2634168171, 2785569052, 3462147497, 919348221, 3838348836, 1417863394, 457847053, 4028385464, 1483076509, 617755222, 830513242, 2499125631, 999322450, 2327780431, 1341117012, 17045574, 3282022720, 2202196219, 3555151477, 2132254529, 318824190, 322717873, 3748565284, 2752047009, 2809126975, 913153259, 1005026419, 1497874087, 2096247854, 1955253173, 2457064491, 4130261584, 3288293794, 3601727143, 1180461435, 2770269314, 174039525, 839689300, 1984468471, 4198413836, 3004902931, 234719903, 694726088, 2800207776, 2624519561, 941650086, 4037139516, 2950761551, 1132315675, 2217076068, 698768672, 2722605057, 3216234466, 1823563237, 2796950019, 4198387576, 1241220240, 341482660, 3188315939, 424894453, 655692483, 753614021, 621057788, 1286795057, 1003238651, 389169170, 3107315402, 1602185276, 4251881728, 3332264519, 2516595116, 2525679478, 602501188, 2984190004, 4008235480, 1856429457, 394282107, 4276769916, 953436046, 3030264860, 1387202258, 4241941224, 838182669, 664597863, 2671343135, 2393051810, 1913896953, 3095346415, 2747044062, 89016749, 1124760976, 2612462156, 69814739, 2406798362, 2869183169, 1221729935, 1803328206, 4236377436, 2791933417, 1279868643, 423104009, 131951829, 3803490102, 3155812351, 2066349452, 3616778176, 3457497301, 1224353298, 2335465934, 3870944072, 2713735840, 3642026538, 3462432834, 847010102, 2449635067, 1198680629, 1286417103, 3613620373, 3057717517, 411016349, 2523227147, 1718040153, 2502334447, 3165770818, 1090731166, 4102886678, 2479898145, 379507019, 1515009296, 1627793287, 455359228, 319122657, 1840997901, 773984432, 3937465322, 1836382220, 3168086006, 492214147, 997497424, 2951153583, 2907358438, 1327087533, 1701337275, 2711551748, 2981513051, 1392403797, 1422247327, 1656497956, 759321864, 2609887705, 4196491235, 3933714093, 2296448892, 2849291291, 4105151792, 20775860, 2284958001, 2095974778, 98821338, 1449890982, 3138887161, 1572580365, 796465680, 2337840557, 2235779771, 1855965841, 1853460375, 2934131218, 864833922, 2385897180, 1864469195, 2439019287, 1582847702, 3302305399, 1113858490, 204689651, 2743959365, 2162096023, 2611685537, 693209150, 312395445, 2202562993, 582809294, 818444156, 4208649615, 1795260922, 1021534405, 1334247352, 2655471488, 2690181051, 693429356, 251588224, 3070125559, 844603959, 70584031, 959979944, 2628442862, 957897653, 2142417602, 347480279, 3308894369, 3079788375, 571821226, 4220085290, 914733612, 3117359948, 3916906111, 3651403075, 1735526022, 3556278199, 1573963696, 3791274307, 2476523754, 2075205738, 2822093108, 4252360989, 1805277046, 266632780, 2241492250, 2886942790, 1197976363, 4065384298, 4278289844, 962277263, 3388398234, 1175972552, 3533200015, 3774028555, 4057293442, 3978593344, 3359369302, 320809742, 967611921, 3333592934, 530429033, 2332613825, 2189829545, 2153246896, 3061333392, 2290535381, 1853105739, 3172684213, 849272387, 3280967656, 522413425, 35842647, 2993461635, 180472973, 1499386245, 4004001394, 3836103265, 2426793492, 2173201479, 202998439, 3051547809, 3869354970, 2827666647, 4061906751, 3580897889, 3618647455, 2457286494, 3875893008, 370017795, 252682724, 2639844317, 1665481164, 1273472434, 1432811866, 3287446524, 1010504314, 2432423232, 2686954825, 3831125582, 2095833575, 439824396, 2062486775, 4114974895, 3461945959, 1336152397, 2083989227, 2242599262, 1050488286, 4294093293, 4079275466, 959096836, 3916028977, 2401058182, 1024512976, 3392326853, 3874391824, 4154400470, 2633976436, 3280987436, 3664063897, 2232450098, 3629733465, 2698243344, 1933702824, 4279163938, 3051045511, 1827816450, 2855326043, 3009856406, 160626076, 3003817868, 4288057809, 2553825255, 2287542053, 3691034011, 2630199426, 325742952, 4121732779, 1313289463, 3018429435, 3007370544, 2503391651, 39709922, 1207931714, 124172457, 3725451920, 698721375, 955208648, 2152819427, 212259013, 24996058, 547988425, 2395061633, 2538202649, 3671648348, 1035107605, 806119357, 596156864, 3249010968, 3994561818, 2631401511, 122251113, 1596851675, 1831888945, 1727626602, 1675043264, 2047026391, 3449862395, 2370371876, 14099922, 1775233892, 13043605, 3868141167, 1243229838, 4139172875, 3905016080, 2392110145, 462393775, 3740969778, 4161368444, 318101391, 2827489837, 4084272683, 2218060113, 986086942, 1438471964, 344702675, 158072859, 2760618284, 2271565595, 2638355160, 490196820, 2138741370, 2861318240, 1921676576, 3118665175, 3546922651, 1945056262, 949512337, 2227181780, 2088877081, 727026328, 3671995643, 2489975227, 1610381621, 3414989400, 1076982107, 2908679318, 1766755056, 3121220088, 2644244514, 2976310477, 3524342898, 1736362397, 2011947483, 1908408915, 1086392406, 1488252627, 1756586212, 2438182099, 519913943, 1849207860, 209464459, 3024881629, 2722106694, 3740994290, 1258795296, 425597329, 2548482119, 2989420976, 4009766972, 3388953439, 1359015989, 2949153142, 1126551077, 2797828597, 4132052075, 220460936, 160105025, 1369555616, 1464548634, 769968302, 718997526, 820269754, 3973755779, 4026225686, 709034986, 234010709, 100569097, 671393078, 686118791, 3232442157, 764703818, 3232881988, 2554149320, 3749768970, 2388134266, 1637275361, 3525297092, 1720551447, 644839888, 3824595514, 2207052962, 3188719598, 2142371319, 1105757168, 1665387611, 1138525919, 3018253532, 2161590050, 2170215387, 2652573611, 36445148, 2880222615, 2664900632, 22457266, 1345369570, 2534801956, 3171391533, 2386688684, 2475714278, 1993457984, 2445615548, 2342900709, 183765545, 4254896593, 2608219714, 612097085, 2692098979, 3310181730, 2999216210, 3322462485, 460049920, 936646133, 406259520, 3811581647, 4258814427, 713758698, 1186466289, 3074903154, 2280473046, 3575992733, 2647592150, 4142640508, 3955881758, 1885465835, 4067027125, 547016266, 1394994819, 810206937, 2058059953, 1560877071, 3205506667, 3229510437, 2923657384, 3952416867, 1538447823, 300681418, 2387941040, 3169001169, 940800237, 3067125290, 128194720, 314246648, 847487930, 2557270208, 1844442682, 4130802286, 4163042227, 1305332537, 1643691244, 3133537310, 2910972189, 2229414092, 4269985297, 1331104657, 1787489507, 3586423400, 195277484, 3275196087, 1338939303, 981278330, 2951759555, 1109843895, 2749241535, 2045825979, 326618488, 2983180948, 2503877274, 2093223852, 1527764916, 2665082440, 3238479808, 370488543, 2707365784, 388753166, 310923147, 1952277719, 3225091636, 1618610314, 201351135, 4169939042, 2408100834, 2808306712, 1357346664, 2135893453, 3845115638, 2194739534, 3219695474, 3419466961, 522082676, 1378279148, 3063437361, 240843070, 2128552320, 3338859031, 2974517335, 3361736343, 3739409166, 904421423, 73271289, 1351217289, 3179552613, 4085033585, 2691011688, 1341865628, 759036808, 3688556398, 1641806421, 3434870461, 4293787371, 1176985747, 3969901737, 290674988, 883582711, 1994646381, 1531347818, 3998963999, 711430083, 2825896844, 1406344163, 625153332, 3142807046, 82537647, 1185528336, 1285283397, 3711948908, 3766166997, 486093077, 1638531960, 426205402, 1526142692, 3176305873, 382772629, 1310887972, 2565200087, 1545210920, 2927582727, 4065069016, 609283811, 136238725, 2332943266, 3629038558, 3919246532, 1464322021, 1490892600, 963857541, 1285249652, 3714906718, 113537773, 2611692161, 2358801660, 3270576671, 2514608902, 2578419462, 1637883649, 708954625, 1933415329, 3899896741, 1592576102, 1005394262, 2150970261, 4005009014, 2471645450, 4145859539, 2729771232, 1468610356, 1553891299, 4280851474, 2046812839, 818105906, 2040624304, 2984032843, 4096583969, 1209485573, 2277542494, 1206592123, 1462642313, 3960906166, 1009764710, 1701713671, 1448754368, 696561665, 1327314851, 3570223543, 3263790602, 1145134446, 2457467288, 69159069, 1285512571, 1094562435, 450400149, 1852795392, 3872020855, 293150501, 1630104331, 3310192847, 4275965509, 3720382478, 1424286638, 3669605158, 1451013320, 3697230842, 2955093162, 1115148497, 3050844167, 3368662155, 894295879, 1510636213, 3200701307, 4053378255, 1694822319, 3873376567, 4173640619, 3096279699, 3963436796, 934410925, 342852927, 2110454843, 1811689149, 726977704, 3941805256, 1646724317, 3575666147, 739712909, 859690942, 2961193019, 1197964536, 3086825476, 256622394, 1832169196, 3854762392, 1006120800, 4237442346, 3721606801, 3676842289, 532848886, 810870296, 1046592051, 769395360, 1032044644, 4100142787, 3319327838, 3527102103, 3336019715, 2479576728, 3659360404, 2532684147, 1000596190, 3103270242, 919818824, 3486907557, 2020471845, 466607473, 3964675425, 4151464703, 412115273, 2207263157, 1384093222, 3084634395, 299958919, 126792127, 3869119747, 2750579868, 2672744620, 3476302497, 107339185, 128436312, 725243598, 1570202079, 2218260521, 493769648, 874463164, 2935103304, 1316376933, 252500552, 485989674, 84409059, 2972130830, 238557405, 2840885196, 3524355930, 565271751, 1327399859, 1920806119, 735397367, 3994512386, 1903334633, 1578829534, 3873173118, 4187495796, 3169512847, 3392461154, 1913556014, 3538460811, 432921879, 4018333728, 3796933891, 3487578779, 3738494594, 43284352, 14813170, 1133549692, 1132017235, 3554670026, 2175978585, 3741944037, 750690831, 3877171312, 3687256987, 255428449, 3311577579, 2611984708, 4234604519, 316275306, 2667657376, 3132748266, 337282728, 3711647023, 3914239072, 546344993, 1610712075, 1083786539, 1874737045, 2161419603, 2611421932, 2158575409, 1319558742, 954648800, 3735927741, 1386202448, 3968309514, 3950775801, 849349528, 1236360273, 626189516, 1084251401, 724191657, 569658470, 2808337178, 2099203802, 206361528, 1363708933, 1506377793, 1374879873, 226768496, 3791915381, 108627168, 3931532754, 3664509604, 47853403, 2703029411, 3466192775, 3209078995, 566444637, 2022708665, 1053171178, 1377782199, 3726078019, 872284620, 2335768015, 78358127, 2091496924, 139463285, 717975994, 3682495300, 3570067887, 3054954320, 895916014, 352297027]

        self._run_test(seed, variant, expected_outputs, modifier)



    def test_crack_32(self):
        xs = Xorshift32([Bytes.random(4).int()])
        out = [xs.generate() for _ in range(3)]
        other_xs = IterativePRNG.crack(Xorshift32, out)

        self.assertEqual(xs.state, other_xs.state)


    def test_64(self):
        seed = [7905265725762493245]

        modifier = 0
        variant = Xorshift64
        expected_outputs = [4094808321205075403, 2840172414509946096, 5767524170271612377, 16955923991736451618, 11026787450653161894, 16810317504914769237, 10120904860799845279, 8878891704459869144, 3060113126610645423, 553480405821094924, 13086533245804890868, 16130505733709456225, 3433820411060540903, 4515503219376468876, 6169840118279467755, 9945892797199132878, 10418080062446767135, 5580852309951355847, 11806163361408919856, 17701801685912969314, 15760278893019937058, 16030713959571465680, 15460175048052187035, 967779752756616548, 16601916876801964894, 14988386503144653608, 2822963902699269550, 12654500342561702389, 13346946145757248182, 13784859276128490819, 3234957293099213737, 10299335033874305070, 15002870568633776910, 4429604636722598136, 10727660598290129625, 4385050367642183644, 5711981864949732499, 18376389447486900986, 10455984749628168047, 3251578695965726337, 10577917161956102508, 3377140353706018766, 11534067954421622209, 1188768040162704714, 5955815653693609904, 15435322934914680607, 8108080693936238545, 3993006830082126030, 782889926160188079, 5931513938321984618, 13351413922030976370, 8239937288813074696, 1787010403271704250, 7016423144195411911, 13635571851248594840, 2947671977308450887, 163587504668061287, 1560822281444068091, 872597682620280366, 12133608280185616370, 7831922213319765021, 387281759425404805, 4936487033073584890, 10542536554283724015, 4315997589057534710, 5734968536697629059, 17716059765116413840, 10628829653659416287, 10612224201057805042, 3233001283391318839, 10920903590604706081, 3561185883321198915, 15724964925510657105, 9588435162256770137, 15305400728880311825, 9161614661865578125, 473452349608106480, 18090297803247029187, 8041573911473960980, 16997727597924734308, 3306180493602708686, 9301154066899544311, 15960863746119663974, 4888029376959260644, 14942877410444801963, 5034979984584898436, 533037620803523179, 3867462360325290767, 17680245526779271993, 233187100454504783, 150074119896656925, 1211501981330644357, 13360310270377662206, 15699905942247494483, 2914876666623626805, 884422154166630761, 11458183407398694875, 6083556076853933380, 5100023689988930606, 9446515161109924950, 10302693787977629902, 839989387792760015, 5856557727054174070, 10409478943062511320, 6007136228719244357, 3869113294879155309, 14751734923958147557, 7941535092024770326, 13264395402555466856, 3488645421583300384, 8102394333505763534, 14667583798144349247, 18233097037441437079, 6933862326590951756, 6964061416687458286, 99347165294214593, 13518921715002865402, 2948095924673549975, 16215632106574917754, 9375281765182590106, 9685628275004827011, 8109818842876816776, 8852787726300851667, 8468055213142215240, 1104336290350129500, 13013733054856724126, 18177280072312219107, 14386574690914669800, 11436543525387706049, 5289294560214810812, 530348315524672189, 4455087794519933864, 13532948808519318959, 14742265199642467220, 13019678409104173859, 13962159832286787509, 12894439560492639770, 1362366539726549078, 9618985336525892406, 1601691172720051424, 9058935657580137449, 14012927695124336574, 2858849101519166753, 5578062469242226779, 11989915174512115851, 2997814118495730378, 8883727123246245183, 12708147014219725365, 10535848199318131841, 4868880314944013160, 4748914772961188846, 10969477142683847129, 10050629085593845642, 4524246936340075125, 5031986101462649105, 3550025307076225475, 136854315917189328, 9802232450160879249, 3259762044541184028, 16179053192248980556, 10380660089598421924, 8693047102458294259, 8500220010948850924, 6390704298054763525, 2509129210011475661, 11650186896831732016, 17887673361413551234, 13302579104361766763, 10385398597764312341, 3384479340987031951, 4237680455677509132, 11087150844929079024, 3143810348509076509, 4654773662909076069, 2559999145666363137, 16508809554579136831, 412036283623049661, 13755417507103678446, 14146308430451872081, 3327580627451674675, 7907854056534809075, 2798616136713060864, 12657106878473119876, 8577414168509194197, 8081863226915488682, 8236575218264409901, 5226878517715219299, 2600345618166225349, 7844886996525276598, 2579595682773336205, 2714002321750110156, 7734729054941830291, 14690733448563359466, 9333033974053381783, 13243806575733102106, 13511166557782149942, 12963477755232090784, 10688233241574719573, 13717711109559213973, 2105064426831147882, 5948588980726415372, 14736991013376082828, 11504170661927218955, 3752541728610157845, 10147202207202355039, 12517651691094124241, 2826871913349596636, 14950662843312555095, 17451045349446368287, 6141859860923329703, 1064333533287171134, 9514529260687636278, 2857834337012485080, 1337575127262817231, 10530716177678152664, 10697504191534803903, 11225801386502224424, 653808180611902172, 16518686237354616329, 8701269689046535045, 11978562281852417746, 16829509379957861183, 6651496117313861801, 12120227210665144600, 17194764668711864186, 13222795814051683828, 9072539173881202127, 7021741272050029700, 6269396253119876653, 12223249014754829681, 9372817144744553723, 11883872377602478946, 4769933164524875460, 16541885274636855193, 17306384241028996246, 9141140373283380783, 12978714164395697875, 17808118759342831582, 13966680376410403505, 5758420171425334804, 4836724009976578968, 6429747712646358559, 17218687816016958611, 15286723036932391802, 10716381706343749756, 12540968007832485196, 10249739172815480630, 17933146998297694200, 4796039773087316711, 17885526407336092754, 822806065130370330, 3304011733993107568, 6261476864392916752, 4322814752184878542, 14913786444654145221, 6815970171197666648, 6974651728080447794, 6225712551028079840, 296431529732764825, 1501698017754322480, 12671672428001514780, 12140364815723190966, 7665442741342117507, 16374100648604944510, 15257749644363413870, 10573236016858275228, 10819254303694295719, 4159242764596312642, 2685361799601482294, 4469589693230705506, 14226002423345083700, 16488109938181214430, 12786447047428744575, 16839157868982382837, 8465142501658033108, 15888996096560711715, 733606312253555571, 2064734291534973109, 5448937482082779364, 5653441290076950501, 14975341473292121786, 9641030913487214807, 8361347404892611366, 11472448820963356384, 5665439203259427773, 17364032938678507434, 9127468615873054597, 3933565277340549450, 11860177888394981448, 4608162291022156072, 16318159858642970762, 14055576858002091483, 1668025926401044416, 11288399170996392607, 8771719347266817786, 8046120162934846823, 3405328870587162957, 5317804312206796751, 17506988962339370176, 15466482284680371369, 5869984018559314768, 220716124150471174, 5615301086919441074, 9641453719698879303, 16245405553780656353, 769622097595830960, 9290268422595265941, 558370578083849054, 13158651591108844440, 11012429880311048751, 5985463286652251451, 13236907517108329121, 3308557010119291860, 9134120494081971507, 10571012261856184281, 4127622319970068630, 11873505577388038471, 13601134449499849269, 12946868144100206577, 13362805187874908286, 4503985297976604718, 4010019189666547678, 2471855622043604561, 3335908030649486909, 6274739702151911905, 11487688501133696402, 5926611615026653865, 16796301132027600060, 17865950874388417925, 11536096508985904222, 11818157283471208134, 9328234188897493275, 9996206069257289881, 9147325461519079512, 10693248700806035560, 2537496245754430616, 6973440377744427921, 9854676448324741830, 8540287744073793683, 9744253027345239122, 8850976631787731146, 17004807358455820603, 5948452193653323161, 6284490026188210482, 16960673853183611824, 12966395171204478999, 3569441310843644583, 15479403072604340786, 15116916630599079606, 2156560584401543195, 6662367751064141595, 2675747115269815717, 10722941692663425310, 1199367329112700236, 17426801966870009638, 14488052739839370632, 8322003786186147779, 18016442480455286412, 3745412722502716273, 7808112276645230247, 2242580458526008074, 10989562948570593356, 5891242279589583676, 9845611095581471242, 11728793431350148846, 5000996565127797651, 13165832040015091556, 5162118643619205834, 16959621193051754607, 4078866951299709199, 13544632269661373373, 14383246947363989498, 10593741859461934389, 18319712879600145455, 5531166751790109127, 10088631640701127972, 15235113422142146494, 6020918127796849457, 15943076647417836135, 1538754884335329091, 10980626656803915581, 10581008186224418675, 7099986372225233805, 16952201542794281514, 10813491262688256686, 13464693203878096107, 16888290120303836274, 8192589669222794506, 6349734803461265664, 3388360544725001650, 7337914035914660345, 8818886621799157770, 1319158424274224042, 6378522840125751725, 593822048875862126, 6922819901209679710, 13223278672603690992, 3948266631196204703, 17130143019189136866, 15885084067679836857, 2404557819446368460, 11157797885817606653, 18430903568972318750, 12921863265946102158, 11093636981174210525, 7390046766064653698, 9324588575490074793, 14174819381943657016, 6099643314273077756, 10276648968799722607, 15602938724303799703, 16679739380224467292, 6584723834818054430, 4069591390036004620, 16920334395543643922, 10323232671120884828, 8811505451560808276, 8534811816213552138, 14074834435431280818, 15561740979260489299, 5339766876249055599, 4685208541444909933, 11588192356911068795, 5854202369757503959, 10170832928545095380, 15162591469377554089, 14239784606668665060, 4732939397318055557, 11165110515177105384, 9018549760382526887, 10261546640448748972, 16537184707682766679, 2812696827246400137, 4105755408293926764, 6477409577351000898, 1782941325732205476, 7081157571625154819, 1310184352018745393, 13212744693600014561, 3128488698169991424, 5763725078480494402, 16050896257580474876, 10993675673545844927, 2031695038702910510, 10406415082876184918, 10655501228314888324, 6469498093447990421, 12652531732589795404, 812836702337136124, 1418752162960695831, 1420370404519291411, 1449468996041244039, 3930215268891396540, 15032221421799426991, 14937325108964294392, 10011770274242948357, 17892295377119817119, 14689947532098044932, 3573870182682766348, 15063216368953883220, 1444901410781061024, 7484028369216411167, 4153191298517393395, 9880330778602012044, 3085246470191661687, 9197034533693531443, 18087313971985978041, 1636741522959811292, 16552096460983613529, 2664230314170340713, 10147110767934753155, 1569096090015128784, 12213686909091640425, 645409504196867009, 8981999404992479974, 374848324415785699, 12124215360451525174, 8427830479731322818, 1843926059643760541, 15407639457067230466, 15698502856987538504, 244654198566027936, 1500600940024301221, 13037672332568987624, 1733639497176125671, 17377956492193972998, 13389391136728323584, 10289248754980093740, 8545283325594819538, 15876933714734556389, 12371666477873031148, 5004926965862557987, 16793440702535091249, 15840801922159970809, 14416517354046193834, 10601131355110289707, 17428986516695985801, 6596618737958999444, 9982529331026970175, 3601653012944660083, 9758924042538076927, 17027747374261999018, 2979230359733390081, 7324469047602758871, 7643754201179125918, 14337415678763647983, 13685084227810131368, 12341229834881453907, 8967610838056920077, 17825038312091246981, 14178151498474486278, 6350112216668718962, 9234839775615323004, 11261606811636347498, 7747137624542183566, 2136977887720943119, 15539832497902730387, 6441492747346794538, 9369925128094394906, 16384714473032075726, 18392685205974971613, 278997818886689652, 1550269216740375890, 638391189984868648, 12312243323062690266, 14364258745591279641, 6736530381115792953, 12431223602712420677, 3497249848492068935, 2600293578952814759, 18048084992331388166, 176236054596216236, 15135784731471096679, 3498637439034042865, 5532314622750553826, 4468679003750036367, 5560547633015748776, 14043227321490392921, 9019429004791303319, 992534250130237646, 17470270212869377183, 6398884865696489158, 9503145690586137595, 8748339564828691132, 12463321128914066857, 17877573327528673746, 5080267407657977297, 10639800466883965978, 12954775578074315890, 6557550733896133642, 1613570266263296210, 2972206683853582179, 4158534747102090109, 15293524455070411547, 9816478031874849933, 9306948385813780788, 4468675773964825222, 14119331845187072355, 5101644390388609345, 4486954872443155811, 7216349814399946953, 10254684500210631976, 1175280435291196322, 13504078301541620789, 5343680375737914573, 17498161921899834532, 17723551468858684413, 10482028695989827034, 4452262061190371889, 3028108704230772933, 3532628462765662884, 17254853143380353633, 12909522924318504421, 14732141399241549006, 1469157924861750151, 17656061875389137168, 476502326967304978, 15875296007179277972, 9057558075336294841, 10676701730497791994, 233755898473612405, 2958651498088685885, 5712008121294688191, 16737616716416243040, 7708332840482328522, 9238426203295262677, 777831522673775834, 14975726714444973811, 7672904933687328318, 2054973921804270914, 2616326308349413048, 625327084626178741, 630422136261958160, 5868839020118114724, 1653958759440009127, 12462442519926893800, 1658974112497842225, 10162444670638789889, 11259849823536942187, 7886613288970756787, 12457688738285951542, 7196153344561283458, 8729616546002173953, 15976620418678426177, 10460959387037537045, 7498855612622382195, 10526078984613315323, 14724963292158113214, 17887916356481784405, 13156738902616101153, 9722098175510136003, 8000743878294607498, 6765192841683679015, 7869851501355743881, 5586762570025368764, 16454510179274053, 7267211888655719583, 16035352539814476006, 9713947034692605975, 6226338132329407079, 5235602329939293923, 11185297526481392718, 12603925145346880230, 11352332966478334979, 6483909864408835931, 4211870645427546965, 17397589180491885379, 4986599649105907797, 11078154838531060277, 3051721041645259025, 3340891118220746435, 12714423341066244670, 11365107779920952602, 15217630893460624736, 17577627343891544906, 15466540106701282236, 10187109217726165643, 3099587370297092526, 339334260193522429, 12247923248572564824, 2508706815089444434, 4716673922602096350, 6649539471813359347, 15395175869641315678, 2196816983962224500, 9906675136671342714, 6452692573366174778, 5442407242131840818, 1694655430822527884, 8045724321195219595, 4688544541982001150, 17125388871978706545, 976377188439766525, 10020067437155095766, 767935482475924607, 12361784331694340391, 16556864125563605525, 403892157751621233, 13847194403884300765, 13508799051287738222, 11301639286427216768, 795086450604188759, 11860327412226796511, 6022464597528742472, 6161445547755616860, 17959008954149660712, 2906078045290180344, 2529547755036981925, 5372703712511592592, 18358815678735611521, 3410425145005319724, 15402330433716492640, 3037934455804131666, 5567738205966029344, 6614718631968287108, 7452404529448028631, 4293633256727452164, 5909376908069637424, 10090594635482171178, 10761586364341603492, 6435364418376035389, 9738715505762613413, 10142374494184936084, 17511793618699286449, 15115006566647935006, 18329725061813078526, 1422152263663736173, 15067593352775945607, 15032280968623600348, 6644772812222160057, 14752515229906078528, 9633841180912219222, 10084282681130171198, 4542864933024756424, 15085405969397336365, 12916127698705799935, 9227911429294253962, 12119862350589785797, 12171563400057779816, 8071825752129356164, 1010723143444244999, 18238004886297398931, 5320341498678655694, 3700031813682646075, 13400566106023839587, 17360851224548744749, 17093010846469681489, 17366137313177008115, 15533787553077972956, 16216485598778460483, 6955875143605117585, 5529269954850257940, 8213143244351952108, 185683133536670021, 6099765526372849703, 3993799473957777623, 10066247786922585974, 12374197376379852968, 848279402872524953, 15079631470214817912, 7668339956314169128, 14566709775129018774, 10938630632423008533, 5143385751713268487, 17055029953201814337, 3672394520974143607, 8275558715714588631, 10981063938190821000, 3175895937726450181, 10194756541878189649, 9106897374373408877, 17772751753455314637, 7232145986982017728, 12375987746818449973, 10931320895996438961, 11700171871817514402, 6115846814466274137, 15363496100126747647, 12486840852143553256, 7613156015838475421, 18027931739016916916, 9246242527870889323, 17265657952438002417, 11791280316773126388, 5503694629169614677, 13879506491150039179, 7823175821090081210, 1507034918868621481, 8594692743739186904, 8387820914759520229, 15726552895401868346, 4307978896832352706, 2066721758185473505, 16720686097048433450, 563883994850868556, 2170966629154346038, 1715287863816153118, 9428894474516149838, 7624889938037292706, 10581126506762470751, 11576318033198754453, 4527178950222621312, 1997188611581198549, 9817816783680164884, 3367489345628565180, 16904892470682875233, 2277661140784740811, 14469845624631473656, 2087818138254542739, 18067994047514971228, 10777430591471884868, 15400257050045461360, 707824570596309782, 13749696114567209440, 7366110260623714339, 9566463274197183667, 12560666783747411882, 598281870038926645, 11762439965913750655, 10172808292316424327, 13832033633712652054, 10969770276222066664, 8079856376617472087, 8518858859160112823, 4136381688176646250, 11581772476194628826, 2725765445337458195, 17570319227618262431, 7060143490471212964, 5750045842480593867, 13849909237822349820, 2021010875880768575, 1872679029062749687, 6832014773571119020, 12670030862958122595, 6601557090846808847, 6891388015235530233, 6301197125633563970, 8632923769015172728, 6644618253254932868, 3474647388637656311, 5384609199570112990, 15410316066458287357, 9883229716970100932, 2475728685663110517, 17854252667767511999, 3345687535804997832, 14144091078440183049, 10341654465656840835, 5550308709188812678, 12863773091710400377, 1734213687205022167, 8703563108665634692, 10637759886055744987, 12387575814389903952, 18126806406456244788, 7533361307689633216, 7724285278608110411, 12683371185347948525, 12124670637690493298, 14763000617491941568, 6556747621097147729, 13800167050793434379, 7977880892290150577, 17088595476833637776, 16893385659828631995, 17743603984015159688, 11619379342888028267, 2717415947843765819, 16543749187868623863, 15950465689084967984, 462501355332951624, 16101750997773635572, 17178283681102798699, 12206524939822116501, 3061437592265964936, 6987694830418152435, 15329011789984106404, 10333640549556543659, 8787865807397547434, 1912593589263151601, 7171679155135782354, 1545196523683826537, 16301712256744988351, 16890641596416328770, 11488259399247855306, 581799666744190903, 10458829027394199224, 10268508818272579717, 13989549259424449828, 11200029250606639534, 7341911248985508733, 4004117014425814955, 6872715476934961380, 8106337522186912437, 11816606364636525040, 16560201798081462931, 15532585702056155862, 746503520456840163, 8418286260160354820, 13598073195216898736, 16580985904186389157, 7894179710141753344, 16988675105111562448, 5679254698899867745, 6577651976690006577, 8977597336328853381, 6879230364483463530, 961415534207766456, 11628309389169794983, 3604401473306397272, 11464669277440424268, 14769676510719262014, 11200720811292034756, 5400724657922568649, 4436013057140979306, 14025549220034834182, 712073723380380504, 6277719497429094718, 10210112268651332252, 2023988668655501721, 13557904411563820762, 14767310257853668695, 3361591692333456301, 6244031262828081626, 8530168511859694905, 7390997128249069123, 12023196925718712607, 3225313922088822397, 11951242716014422769, 8727933883597599204, 8663585101521949831, 4017200636189736814, 17385720692726758160, 7119875261297752806, 15621606137571278739, 6742321406138058156, 15609541056457691303, 10269429484816403398, 6494469352418407761, 7439334029168025595, 7564125471093658372, 8289274246702553378, 13710822260575383056, 15316247501215141964, 12572074760381581932, 13083431292340647160, 2202409254074182033, 9847094326650049026, 13377036152271677862, 11324035213168077941, 2569824999920343789, 2624209107858413208, 251008413233188149, 16344937092830801007, 14605339002262078967, 2620893063264936636, 13526909609857544185, 9820351694053077350, 16308064289349044228, 1991484066325679380, 10318338833923893902, 8758158992614868187, 264263130430829970, 420873789622177529, 3104396369406474020, 18395527096931812938, 2416434199347869638, 11576587171648077353, 6223874646381891221, 16922305413700273608, 6189127085630470979, 14115807322717391605, 17965058721471614112, 4807875060861818425, 13034214439295269333, 16909761719878156518, 2906366355388192103, 159266968050659853, 6261764804284639401, 237760014899886392, 3143895571383761738, 5659532158991182012, 13866148897354753261, 1573405679448145380, 1473763367991470495, 10340654522930353292, 4197106385451937317, 6339998683509359289, 5928889842784306940, 10238820484472344817, 9676057851493245840, 16309163477716845399, 274247020460136977, 15912710184052754149, 17092359567503128232, 16218191383690991429, 17791133286625493419, 633296535195233000, 15302968010200975549, 12340946508181267436, 7218425439867822891, 4262322248697291821, 42090765400260133, 6796292562200597529, 5082118933385020273, 10914500776476153911, 2935068329821198791, 15338324487877145524, 13992439644969562579, 3542841954305959152, 8185234171413617465, 16943675000802266063, 13208014454484082840, 13306580782539733465, 16817395421958376554, 17183837152470658802, 16628470539852827311, 5715341833616323322, 1967364680858586783, 12377166896808196802, 3589993644357253559, 17059224446017589636, 17511779711997584167, 10664899339036462753, 14956116061677135100, 15119650822142334133, 8462594326961873116, 11511069670009753373, 16988802597983961283, 14436811644015555202, 2576567771430279271, 17781544406967452951, 7412706817759175389, 11586078468433295448, 8312550127726503720, 13168299941731067238, 11076307923037955628, 1460135797820139104, 2173760700845585196]

        self._run_test(seed, variant, expected_outputs, modifier)


    def test_crack_64(self):
        xs = Xorshift64([Bytes.random(8).int()])
        out = [xs.generate() for _ in range(3)]
        other_xs = IterativePRNG.crack(Xorshift64, out)

        self.assertEqual(xs.state, other_xs.state)


    def test_128(self):
        seed = [2984715561764105575, 4345942232949305107, 15222786622237654814, 8154047885200061662]

        modifier = 0
        variant = Xorshift128
        expected_outputs = [2274094933262498669, 15965791492775421672, 11422876375747825750, 16802303966403147664, 10335360071946941533, 15977586721361464983, 8232186128146465078, 17701176037227417139, 1057079904927797761, 954870610999605933, 10031026163102387528, 5183890951776006182, 1516960325266639650, 1967344943316059681, 4229121313864552708, 18053259788104997759, 9611751610741827644, 17658856862427550114, 5316251412208871833, 16385793557465416361, 8716579546104913198, 824910939771822797, 8806638253930237304, 12232113646931733511, 7918758592854235574, 17539460366523066453, 3614402133286527348, 10582864619239105561, 15553823387035122175, 7023040379263373830, 1465874412564500693, 7632920487610697767, 7786029254473474243, 13509926232791973713, 1236743916014449429, 1469548158330082375, 1453520659013576911, 5204463765592554927, 1670594290942319088, 2624101444492693238, 8034507581091684571, 16789279449842610357, 9699613663884039688, 17866544242216606986, 11128266093689421066, 10268563974442117483, 15553814695502669898, 13110044244136462456, 5990345326933580466, 15492431382222068689, 15195103392557744557, 16628952380391705162, 13430373715958569462, 7842472770389309690, 4680908137942138377, 9924025201149083857, 2404575978003756446, 18243823277957166407, 1323020239601362380, 5937916655927677207, 9639651185477599042, 56436178969360426, 17301637192397373213, 11506229788950058962, 3280665825957145459, 7568357146829392687, 5127108422422859812, 12311805828105718236, 13649807467626921638, 10802053365321897206, 16978066111835271928, 11789135760137149612, 8140680364980102078, 11606411387008390904, 13492557420720459207, 14103212255667624420, 9219018524139968297, 5538464534162047908, 1020908068927277100, 644601614327817830, 17563245217475593124, 6586773052464823669, 209436535190045881, 11109358801935806358, 9293292436306045670, 11300984159144779965, 16065486500656972364, 2798792675488763562, 7290560987282512153, 5801834791370987749, 3357693520457010670, 12874640854163402485, 13672113422207770841, 14941779742850104061, 2758858523929054072, 14646343222611075584, 11421103472389009716, 10365463881711523788, 16322284712216212942, 4252272190675388257, 6509117523211764075, 1872576362249705433, 15601272030969275655, 18120858028345520812, 712270807038289860, 17667857522728118190, 4300450167636089785, 1241921626780769409, 806259113246947302, 8702433739465947231, 3532974941186890930, 13925756816705059486, 5312307322554639162, 1956139063127980599, 1657879104974764713, 14358331905157278383, 5089493194206673895, 8170389037332341436, 7617874921201982393, 13146685152118536055, 18194972203633189742, 10801822282065193317, 4463151042829626595, 1793837217527756163, 16763317884836621005, 4876874675103996285, 18194584586872110943, 14100845645450440504, 3587111381149494786, 235877048053977067, 18305399291882840078, 13824681935708927506, 12809508065411922424, 9418912875927832008, 3653153669604402455, 6059796275529862006, 13930854660627282545, 17748416720341758197, 5801938236048912525, 13963717471667986190, 11694356918013845784, 3232585596458935918, 6426070949712341988, 15048186513469833060, 2879446212179424891, 16752583131057633178, 16036716649576514665, 11603777566007304929, 2935363841374749540, 3011815917990260076, 11031339517336863644, 9207680371448314021, 12949705583659877842, 18070516053058571149, 15741806475989031523, 16683494164467011102, 16209205837151572850, 2306130553394259343, 5409080576448090873, 10457851656319222221, 16496823024507735720, 14768818102074483570, 34007897692348353, 11512138554534071701, 17923546865675541809, 11466510439904124549, 6417373149739429930, 15916011748632087729, 14815163833893085904, 6628781311907660398, 8820164431569409508, 12542804930584243094, 12961124640034738283, 1855618503084031277, 6901537950231565154, 8505937598941760834, 4381721103268287091, 2795880997729779759, 4678146602321231536, 8034719371988289854, 3101796164270042606, 7652145538430389094, 5337211223501565855, 3279449113232301849, 6387519263082965519, 13654715121328381330, 8863876968996236391, 4699118575306429264, 3590610062990596255, 8553591337382483247, 1968703697800036173, 17179824606572052773, 8965180593176492637, 12230581235429182447, 2562546095066616191, 11143942163887593939, 12908939042748481628, 14190563166592793222, 11010278633618663136, 4263468885700349807, 12001899149916702576, 1931122176070655015, 16143839296489341811, 10114610666049444012, 5796270280164149427, 3389187439710723162, 11255443489691926615, 16327158498145531537, 3593486642038059036, 6359038281137162419, 6844207577248473301, 1288122659890195559, 15416489813225633431, 8346876712643668515, 17418603331139435229, 16351902026985704430, 11936402927952818488, 7364195305727335736, 5609772973509114296, 14031426271616377278, 6014485747667685455, 11723021714852536998, 2359211474993538008, 3392700871996948247, 13941789420394548449, 16698300129007189864, 3107236476828901209, 12597872152702530969, 13171761227763254159, 12918961087290262650, 6952809266157815124, 7759119915645918780, 9688310077034179327, 9166640006485343871, 17688005887270226752, 17411729909688535738, 16833451592759687703, 2734393307489539755, 1432658346702978115, 17691660505878440788, 18405007657883994423, 5623093939642630722, 6011456136647759812, 10163743783326975468, 3387342346054899779, 2953702076518810548, 2051929178679854432, 17826999990121801990, 14579908677365208326, 1093582185898667950, 15911871747465117294, 1919259148139602710, 7017346331504609965, 527001424605914235, 5283906850750889635, 5141031190060699790, 3654085312674447001, 13198004373383825795, 6862973832908258869, 15852684649637430258, 4715773206609558688, 12930926149205629402, 2130522967507302911, 13918617839477679068, 1063926676944680143, 2493539768843426327, 13152119578688956942, 3585938359312027959, 2417627205498137427, 15369214878172097223, 5687039463916406480, 7025496995372482565, 3000309462609071581, 12624505668833819497, 9408195716406788936, 2292511019172094877, 3436151039323857800, 1919082935003525309, 2105295879634989466, 9757302291950967451, 15410448109740410634, 13904346727602647098, 7024220349562774610, 11666111996644688243, 10614842927616730963, 16322609228915243948, 6565740563302642474, 14461961047281935008, 2373359880210344596, 17208327689076259872, 4969416688860659988, 1563694583856019480, 5472855412204417592, 2835315512209375316, 15279987279998758029, 6624449460076628343, 10026606317661051569, 7210279975387221534, 15850970097849290197, 17732805993872482087, 5827333983958117681, 12993390310061849149, 11535662884323569770, 16925403431331744562, 5499140754845992368, 8531568894470657168, 7000203795828119148, 10651389263157579696, 6462730499482853848, 2185375753635568964, 5980574062484463192, 5442518943152687822, 10607880115916305353, 3297128153819869587, 9634675693127850110, 17579110040938784597, 15488000750080010770, 17660518216909742552, 15671503693255902473, 9695667559082845636, 15230304185971458561, 10382142657129742407, 12375759332976161591, 4803564115536025550, 8540793763258150863, 4655019974270883179, 1679176189107411343, 1759742702116113351, 6438242186701619753, 15487873995126959366, 12454357791393360345, 16870145765316061214, 8795011658217200106, 15245336991105485791, 14518792009820975385, 15356780668097251258, 16023609821083031913, 11458810583345826534, 13743309974404867996, 11130069041463353598, 13722311275085921593, 1091944706467337087, 7038962876534525647, 6087143063580655937, 10473203633828755707, 11864076197599459129, 13712239231036463426, 2714483631422942313, 8572953178378541248, 18412657433334225455, 2047217463116362110, 7492536456625328531, 15584446155309660465, 1169342780982916977, 5002662667859324970, 17624622249336388139, 1488797237776409263, 15485927119097619878, 18127232871796657856, 13163737157298159374, 16749088397271968016, 8539532371784741763, 836887322370958856, 14563262937336869207, 12087446849798668092, 14214670270665203809, 2882147156223642246, 3829604360229893563, 7719994439751597729, 10069021225569310404, 6274571463505770885, 5318598265098724305, 3882545108813622976, 6701106988070901018, 10748346936113020917, 12066068148882642554, 11401454518673581485, 4218580143026722683, 16221214028242473898, 15860360627203311945, 10573441084263140200, 17515778286272710972, 17916380768516989356, 18316619250426685479, 10356326685269691132, 15611342443584906117, 4524118558973810995, 5560691871478794792, 745250174092763682, 16651300608381736991, 11424140210243631159, 10371231341601262831, 4054939117258891470, 8463189126698222128, 13737414848653092670, 4731975335432836449, 5307621843785199091, 11995714356503015580, 3502119963309550712, 3168805227875704575, 2446648384533902596, 5572244623844281925, 12471126049414092011, 5247321326295502588, 14432883187001861480, 2396259146759366197, 2221480211150376729, 14341987914064566126, 5828265082861683899, 8668409019177365593, 14152398671736311420, 4917785331955428964, 422579281238645145, 2200847152404363661, 16235044315125582816, 6778852061860910771, 12775961950380308799, 17895191327883665321, 7652356099506694023, 12571019286202727366, 8452757613663754606, 5674647460507279693, 12756258675505460918, 13163644516172386548, 12841459033346025996, 18416906174470239426, 8409468089608236653, 13231203864561246859, 13086649017896249843, 16549639202841794408, 3655500700452981835, 8072748379371327148, 3253807026653330527, 12179429951726770442, 5534336555602182648, 9059983864185953790, 7948210978160672471, 17864254583923567856, 15297271653746059060, 8460675944660377442, 8546211996800299350, 15381130131183555268, 6278288222613819871, 8120727449908802687, 15527145239898548762, 11853131486775952429, 17627185975779272051, 1153526963372820610, 1977220286660101623, 5268864057863368788, 13802113036453824962, 13744062812669966507, 2787347391911713370, 11029575598815881038, 8203118592359862786, 3094787605135332361, 8728746854534646962, 7442380798453174512, 12462484024765329967, 1268879642675655065, 9024546869419077050, 6879337210377326280, 7972385447919802616, 11550675467459865824, 3525536536471117279, 12505765123170529273, 16108816919786000504, 2229992771799868864, 5152398107799381920, 9364070697431583334, 3372988673216563919, 11854570730714901157, 16480157251456833986, 18139633485765916331, 12627525896674814733, 1454532121308804417, 6551020483148323754, 5056900412624465444, 472767945597686410, 7963041249283778087, 8884770428412435884, 5803556512619532619, 3071479690116171537, 6296407108606449838, 4927581404439075528, 5050041160131497959, 7794422744533693102, 3580638048180286604, 7479897474410921791, 10086106210900895612, 13633866744167069219, 858239927953833817, 240015314475270550, 4652052333252993555, 6080471435746560476, 1688049722761197984, 12770571133970733131, 10000524912591519431, 14954848197402477692, 12815958476981707239, 15129664099354766008, 1441133557469166809, 10282256359442060122, 16461384583030402917, 10305500481973217700, 7164571511642812189, 7102389495547243759, 1306859856473110940, 13725526526043893240, 12702392617804397027, 6070659489385996768, 5847997053968134787, 4167868515141384639, 13162182464566505548, 1782767660622645734, 834400979005327169, 10030028367915754052, 8564755624790242382, 9500809331758706277, 3170378849953938605, 3334454421890060598, 13326857808436672691, 17750984082540319184, 2801536599430326212, 4206080412834940634, 1626951111912986929, 2428813250931849504, 1085072421065284818, 14007148846797486907, 8429075392178559927, 17495938815159416983, 9954223786093792440, 6017867935430324923, 17827174729779846206, 8455305728691570690, 15840211007116336905, 10810326749412074772, 6297478504525960277, 11007677007592293266, 16035445139916018676, 7476669106003952667, 1856479227313372578, 11060837250836355391, 982299586207796968, 8764097512015785906, 8950457548394614831, 1929794201271092505, 1858001080968941940, 7111642499205428311, 12467372179079072646, 17841854455629960449, 12221829981054304645, 5101383701401172256, 14072696430333907202, 17075405073497249120, 11557515226440875002, 13311525801840301798, 1821630749156566145, 3864363488504140888, 12760577520456796065, 16835545673165625940, 14779965286521740837, 18401317825998239006, 18095884433406107142, 903352521585316766, 2765119382290992780, 3306221205768757943, 15982023426822168905, 11229232949209955970, 4627969171802623320, 9048597780809307437, 18209247314142522845, 15471781266669085031, 6398056267277868729, 13628327735710865192, 16151982778857151300, 9262204567059645882, 10086617496908073415, 4194203643850490614, 16158722710887817762, 3447021063003136477, 8257610279426192665, 17176592941083592452, 17654102650925362508, 7606414869608355342, 15907864256293352322, 14892214499491862478, 14238557446336687083, 15516033865137463583, 3161091250796141040, 13534531428044042320, 12853284259918235381, 14229061173932887426, 2156128809782403481, 334928527195352347, 13130451270333066643, 14774583193002678548, 12701622502435847624, 11238336261114210751, 16745294167376125722, 7710172387609356812, 17441981316528358518, 15955640491972448845, 3178957946539527843, 5130122185340073225, 14363009592017716090, 8367249086141625274, 13234851484192538138, 9116440680382633893, 2649425875185143752, 11806463029311759861, 5297236709322207164, 1696220468483399279, 1619369438179975934, 8221683709892983580, 2831099073688519830, 7060222839763964155, 13719083777919205744, 471967354822000801, 8150931300895102196, 14396690351082882441, 7410974859381973002, 444510545942954297, 11010749112464553410, 366141227214298154, 12389796739698544487, 17598435677574243191, 2041103813910105755, 13815065754077233156, 11482674035166903962, 13467181381146275521, 4438655831364741011, 5012812432156701217, 1132735710074794526, 11357830109823211092, 7700679936077560863, 12047339579978697048, 7641501028744864992, 1082017350133383073, 10898189236637235274, 13101078443290217868, 13786493622062350482, 10426067214147055714, 17780776998150218482, 13848519153438331126, 16496516588232619848, 17505096061162858964, 1502404410618004994, 12312441236611055023, 3863316061237429074, 12913236942706250284, 7769398647885105462, 3887175044961619182, 16914179999828536761, 17424973730502835326, 679171859309441301, 12399505361144053045, 11489631454284134808, 16237356182201577330, 10335103664740191757, 13577823856892098520, 13398109184348143781, 17115503702231563831, 1106128683112999792, 14055072271224580805, 507874078379298641, 15675637621952499693, 1730216716170546097, 13154855648817390095, 15222381187144126192, 5917972325794503632, 6744958649739262864, 10422561530191791624, 4983694872170487009, 1278598111766106367, 11236324117599253789, 2953034285995355078, 2376290804625654074, 14003899788768252538, 2509296657133183116, 15029464164417245598, 2496356482667205028, 6794475318376884191, 16909965650735163891, 11629562279919639816, 11922054633675186081, 12514341746940787905, 2715202235612256708, 11548783161092033969, 10962424823701110619, 7748125179329471514, 4381996798794843009, 12695317060887734295, 4205301569302839502, 7454010075122237718, 2606423795478607015, 16311845236456895124, 4108137433011619503, 15073372742244151532, 12284337312262752855, 12879075853688622494, 10651060434297763586, 4129905859483595855, 5082557320369145056, 2956219223501944742, 4295444362089706339, 9262905773907426553, 9291876393406143272, 11323709839784316848, 5025685049584918790, 11983076778048783419, 13665678849647160370, 1081161058059255412, 13583851358334731824, 8758547068195933872, 17677450425487192373, 17448774789139550376, 5927700160196656336, 5707092931049843103, 3269406131279434776, 16987059193135974540, 11739582179922487756, 8096557932270243707, 12090090682207930045, 13632058012336056049, 5027082126902428333, 15207827089344876822, 3543255534495265019, 18063347384730660900, 11633304316307716040, 1924977317749150094, 5380556041212036478, 16115592233063515930, 17338234084813425468, 6747516228306092200, 5442572343577004200, 11844733054977364109, 13448802611751804594, 17919843010006322147, 10121548475493827973, 3403121935498441702, 9857112684550541965, 17334758692398658249, 14657517329013865040, 3901519878188358997, 16555971701178719379, 11407974579529255269, 1877625488039060799, 857628428596505958, 18145235487109284169, 17273129050982898387, 9260779902817090779, 13554326884820189103, 13919326136372745928, 11320844773180236720, 4182427111640038232, 6006264972342441080, 14546975311428564172, 9905946002293418845, 16475794792321103970, 7145258530968927998, 11812941207216178481, 17091925970826751481, 2818436794568713087, 894381224418868810, 15033320939271139294, 12117969936134525556, 7436517526769220117, 2362974671863540816, 17878747269229397732, 984955167066047246, 17648332149852715676, 9480391412259136610, 10018501751921426827, 15918034219928463786, 8316131900072955975, 8654983466968660405, 13054700396838495766, 2945533102938835091, 2094892768232590886, 9295298772026550819, 7627701055079938139, 4900007650346792581, 14840864052840338478, 12768160476101298898, 6338982511803535, 5100248579773507535, 2444438772331313399, 2022770392253255808, 12149238019009635974, 15271174990226123713, 10475455751083677982, 2263953316383965627, 7031162548899538191, 13995882443917141384, 5878389203824595782, 1717355553474796106, 16938713414305160293, 17570394791428146801, 246664473360521882, 13703008902864726385, 14299027559295363208, 9315239514663743389, 16207232423658656427, 632291786884865456, 5493493177420469669, 18360957817129768250, 4888954146981364197, 8788058077449961527, 15209919833381955858, 6094085646613831985, 16118133930887318042, 948624139547094979, 9052992996645267402, 13665098822192755446, 1893532139075307035, 5094897556796999780, 3384304978688151013, 12878145669885616280, 10500106378676174005, 8237882649399861600, 16684560457838154746, 10928388746979245213, 13315202139361591838, 6686652159322174202, 16160670740464702108, 4345634509468810299, 14752017051178256389, 14872299032295957730, 2238806809514408352, 6145569970284438085, 6087514729891170179, 12885101774356884630, 2586761720952437158, 4407683449806566295, 12704311411250715529, 9960783963630177906, 11096502746383092175, 18254397832697651130, 4315389344598869747, 8002288128530540949, 219728462535290055, 6570897918811418556, 8813389918862503634, 8932378799345824287, 2130898787348943691, 14004883017440607679, 14091364568734735613, 705838352743888150, 9736438065467663634, 11523116354695973457, 2916263190936163516, 8990875303025517958, 981588160991430836, 13840256198561159124, 3290094789324778472, 7001289939885708825, 10820171943929562889, 14255101419436730488, 12540586985781958445, 9488465520001263847, 5952832752776988551, 3852495178887672261, 15236359111567448455, 4493057321907070360, 9934871080753722391, 744701807113660927, 5348278096487441738, 11589663942161687955, 15526771708233499934, 8086969555521983690, 18283477680333337468, 16966302381525024883, 17108208086245111565, 5227783392128308032, 7684690464580261024, 2506602598824788559, 12369315178355224797, 9619689378077234712, 14080829552629526608, 12116203366958522572, 5077695664116783415, 14084506475011679134, 5308529239892712582, 14572512649321535160, 3493848830194335640, 4807605876132072577, 6232638149415764534, 4893415459783503031, 10837612352290107145, 1458249089457919416, 13031380858736348377, 12686526786340769795, 1274626618855833799, 16182452950593869679, 10531472801509472033, 6783308955432268063, 14704446235667538280, 12683966151722981393, 1800381781781729503, 6891765153525036908, 1621911853766296845, 10520599984900655323, 7775494646666726099, 1697679212887247192, 1192197991995853614, 9760384237434330174, 12423629392684553228, 13941546699911242399, 10228527994216967549, 10689152831350679585, 8365072449037882889, 7487754009994719845, 8236885255105337722, 6758071043143583805, 11292469775371105159, 13092740566927786114, 13667992088613591667, 12366688556179421371, 9243987689044670377, 11802007721723609801, 7861670439732081280, 4375583758057632822, 17714684112011900511, 2292062040736536459, 11562615876566031825, 6173118872861613443, 1849459801459410999, 9101858680931190392, 7745300011228306346, 7228263015375766062, 2983386145661493819, 15396290108538745850, 6408924235197647314, 4842039211221295717, 5957093280009254031, 15231799170969653580, 276481082469662832, 15221049870695141096, 16095182256485873666, 2105487188596764511, 12416166057965158017, 11457657596022346383, 12463827977970230075, 8113081126274673852, 11864027779885595899, 3819787076958339056, 6546355097770710855, 10459465470777366833, 2233227507933156010, 4556979741491538810, 12677222988380144730, 396396034248244960, 16984242161495715071, 4142458088175534235, 16289780478901680577, 16561926020862439711, 12617793419729738381, 8143700390555094598, 1448444670327210609, 5740534134653981202, 4289497115590810572, 7724054264386675535, 12733337756173151271, 12450450572605195407, 12509257301173119054, 5519738735411138710, 5983492441430160001, 13275539206605411975, 15834621158852600958, 5174655528987699329, 6472451270485629936, 14590187340912563, 2641617683447070124, 16371128123228044101, 3174438825597281731, 12829915952987348642, 15099537152160122286, 13664960200494589586, 18381115984509437414, 2730676293794014260, 10840844033868861098, 3960594244591492363, 9157346199305326674, 8107408219897441849, 8477386856657873359, 17656533183388736340, 2425010620890267295, 5415687217180200854, 1371018029819702044, 11701637642828614066, 13342744599270033551, 12762106676513999086, 10705732381298946001, 1367840200985230221, 18204646082808152789, 12469665840806224172, 12299323782239730616, 7260247346499689051, 9775257567510168086]

        self._run_test(seed, variant, expected_outputs, modifier)


    def test_crack_128(self):
        xs = Xorshift128([Bytes.random(8).int() for _ in range(4)])
        out = [xs.generate() for _ in range(4)]
        other_xs = IterativePRNG.crack(Xorshift128, out)

        self.assertEqual(xs.state, other_xs.state)


    # Elixir
    # > :rand.seed(:exs1024s, {123, 123534, 345345})
    # > :rand.export_seed
    # > 1..1000 |> Enum.map(fn _ -> :rand.uniform(18446744073709551616) end) |> IO.inspect(limit: :infinity)
    def test_1024_star(self):
        seed = [
            1777391367797874666, 1964529382746821925, 7996041688159811731,
            16797603918550466679, 13239206057622895956, 2190120427146910527,
            18292739386017762693, 7995684206500985125, 1619687243448614582,
            961993414031414042, 10239938031393579756, 12249841489256032092,
            1457887945073169212, 16031477380367994289, 12526413104181201380,
            16202025130717851397
        ]

        modifier = 1
        variant = Xorshift1024Star
        expected_outputs = [
            10736939083819834866, 12432249082523000430, 16930477503740128179,
            13654371313008805775, 10310086323352302112, 16025250769650826210,
            16328284675239298682, 18233467457439580530, 3339814217983129141,
            2686956746795017426, 17757108947093691886, 2573662751428641471,
            7171126441735175274, 6162051744082429904, 6425994861298266776,
            7047374221987206649, 16562198950210306859, 17578418489116414498,
            7944616997841373252, 4716599615721598723, 7751391025827963379,
            11988026540635257260, 2076470662537216347, 12711380638943102487,
            3234790551585364998, 11501098182607200773, 3246699684029924876,
            1926111572635136611, 5311723206869995036, 15797031769123723568,
            8018831888483177570, 13631383253915748262, 3707748423593255735,
            16818795855599539182, 5741427629577770906, 4687690108910962889,
            14246346790999147076, 3466465366109483430, 5084875227303105874,
            12572513193322490038, 493663441705222296, 15401559602937220795,
            6581027368116438491, 9383673748597333440, 11987808695676442714,
            4240409196733991123, 10727221819355527842, 2829035694348176926,
            14075841041889057534, 3363152876274301291, 275396176857001935,
            4948552033634256598, 4697267312373110683, 8921888070896277885,
            2095295722471021506, 14963911926811634057, 12225276468423089224,
            16587643409228821293, 14223552098959992590, 5067551768752215828,
            4052874989014452661, 5686539051800677584, 14900284089847168581,
            17035987642657262017, 17038573493484655413, 2313803103887736177,
            3433825214436022191, 16447043709536761924, 18358706071532349250,
            12808193772688718898, 5692922171837453307, 9483024236217616473,
            6504874597155233647, 5396957062198280789, 9248592176521823017,
            11320314115998625071, 3327682259171564777, 16560973450563111056,
            17951763750585682962, 1123665646523717805, 6184057039665052242,
            14481826471485365831, 4659073520664348826, 13587823871590670131,
            4666530501845584882, 3940877918578643365, 16320664656517051350,
            840415022190555549, 18236973853793046807, 17213375016178852143,
            1403660866620757402, 9703854863423387086, 7675975502634962994,
            12109082888079921243, 7705717909557194678, 2580558605852988480,
            9181465507272182279, 247238494063712479, 13519137742942455580,
            4132755078867734252, 12849533831146646610, 8431972558135292598,
            15346838302802837568, 11000158324795147998, 13101940092961018808,
            4928956681304606118, 6265199735510204216, 4427670952008747089,
            1534168225335877437, 2729758288875591119, 17349198502522560752,
            17574330259211721915, 2972708904256484555, 13140711303355016839,
            9292837769233509240, 14714291172394624963, 41828701865393010,
            7308984756085138865, 6879117471818697567, 13498561513481714066,
            11559065975127741693, 5479607341231054820, 8509465399060103654,
            15538231750225933097, 330341806686361983, 14104606811741513159,
            5976023560240256595, 18263321855528379149, 1700517002827205950,
            7639139628387085096, 16896391705893876517, 3215931355050967000,
            13104934478566993324, 1761556845099191686, 15310864416289712098,
            1573276479142850900, 1788782579704337070, 9478691762477845893,
            17398555194023675709, 14248628364408627223, 13383282191422381910,
            11638628582838584441, 12037965374906855702, 9651661299417548901,
            8194033941015432375, 2658037698048932321, 9973370031497278859,
            5287066153847691356, 14133468834042202148, 8937762829335243839,
            16083974206035648976, 627185508599822519, 13622376822769526375,
            8765491907324158865, 17948145942736306958, 4612308137126400534,
            11560960179821326637, 7385230965041251574, 175790630524792339,
            17279793605256885925, 16053515398211277326, 15435623561945458865,
            2705017215182018201, 7349762919308620537, 15193810951905781250,
            11888339365201677178, 6614590626608401015, 338048561531884085,
            6343586453784185973, 5183202785695116892, 6531118287625296712,
            16217594400925859503, 17474157354268770079, 760149047237523574,
            8040477213227586013, 2589182199723576699, 17396647714883322722,
            13243824735730970876, 10656694114909372560, 12862691640926604807,
            2511270669676883990, 17277027263941097977, 3012890536173103436,
            12607828732858226007, 13269574307734306039, 13063102658335776795,
            3568805615555688082, 5390001664250389400, 4590339126385796877,
            9945073079588673646, 10788028397783906908, 13521337341823662626,
            16166064909656070862, 15354733547096461508, 5844321066143514525,
            7997187944312493844, 3817880454881892707, 14492280763219098157,
            647545857518704430, 107514655054587426, 2922894216159856887,
            2384465072801728062, 15959061099174830090, 6788604390303643704,
            6041691162320021659, 5290684582247796123, 9569451081799378917,
            12555367678559692247, 6020934354788640649, 9754982310644344843,
            7169848731300689909, 7781794481288423799, 10740489483450689331,
            16823820935664881798, 17874448338445027787, 774378250562051550,
            5657485402819238659, 8615453848102817844, 10274168907232851227,
            769090667227212713, 1839592966986875213, 18329129878930579460,
            7576961998340237968, 15628031674304880005, 1494412439151549148,
            13842441934847688947, 1829554912683104121, 3673578872203407502,
            7400184552679155331, 8053006625249867649, 1701123935035559140,
            11270190580051581336, 17745505325548045726, 18442322410273385685,
            4114417165060651408, 11192802408661983550, 3562036918922005036,
            16833227750923620758, 2659415105191987442, 3355956386045408642,
            1971736435740876103, 6230870160817454511, 4050523323729369114,
            18115505434510279129, 8425431297088106037, 17906330356866478303,
            6015057828600080386, 16339663607962003682, 14896424682341024451,
            7849701451511643450, 7942107866792415000, 15922548162807914245,
            181408896270873007, 10534549174457768253, 4261463647079793369,
            1652832200570628399, 10520449013532769184, 2305587783513110448,
            17847816480755415175, 9234770130308038578, 10049253275925194671,
            14804470223814862001, 108489634195753299, 5049902028252782214,
            4305046519404888703, 6411043551338762248, 5355786494120272325,
            3168993783183931353, 11134053406326858185, 11305174661484254639,
            11221309034794281541, 13056476938200013357, 5937692676100996332,
            18130417945743012273, 6979532932323867630, 3427640758574452088,
            8685233479741729507, 18146210628001292687, 11490481367939548140,
            17975523376104575781, 16194575861217764316, 7517204953045147616,
            16915437964673435354, 14912005423766944017, 16881390462078892288,
            17221525225018943002, 13018108319650235946, 5511328404563064177,
            13304301465347611164, 14974727513367356167, 18401313776770876635,
            5264897163460829629, 6016969657754957330, 9983795450037119455,
            13197646027504965023, 704642797681793655, 18303325007008346427,
            2072356986618378933, 15874592825141390200, 12033243844459718651,
            6956301739326517913, 4207046555719300480, 2236821339823687714,
            461767383471402972, 12006027026499912834, 13474755712809578493,
            8297214464186060008, 4130430728446017309, 8480214562978319673,
            2344346060033957724, 3250830122742811120, 8265596168300498178,
            7057961882517973422, 4605050690900945818, 15823592098986948665,
            10441380978243998678, 4745672280516462451, 9120986044532161906,
            16303381914720504099, 2542959175157168336, 11515762025630067453,
            2835433598667897446, 15193300782789892268, 8272080844672658808,
            4535759589164753136, 11343181556325317095, 8597657679213432816,
            11702995521350528725, 3212703742069200100, 17082596344223811535,
            3180481681802989910, 13990644659853429905, 8126007610853363703,
            3990863263325910278, 9083700303069663538, 2597595275340694282,
            13439351683938292250, 14787997551198492028, 10044966434230150162,
            10241378888684339602, 5152512422258326517, 3942142890500586937,
            10882222715391857458, 15872699034479011442, 5244529410493714176,
            15046179945820629591, 16773215068239143832, 2684927713481007257,
            4583571963732254055, 1168970686804015574, 5274759109665588216,
            6597033410429301273, 13650638090541245187, 16060485511983209197,
            12698524030854554489, 12780425199127041112, 7384062561974500610,
            17190560171402515643, 11584987483407370308, 17556360064255354983,
            12392941457385808579, 207740524675205939, 16506297977171364262,
            7587069765938853163, 345848892661052909, 214328805396673510,
            13924769855006173260, 7558961183197821934, 9737713983086200876,
            7072465495520006409, 790174030597817102, 9575051508554127697,
            12694903237977775226, 7356463083668660918, 13732212949376105452,
            14266669759152693396, 6380363112993406291, 8413026373937992194,
            1906999441397966995, 6227180103904873710, 17767757852957231180,
            12136823421754169412, 12474250730622190988, 16121705276992786402,
            4441018283666645003, 10972355182765088109, 13844805473948605139,
            648319981739903803, 10300507119947230735, 15245868002428613118,
            1004067485058075599, 3624553137421371928, 11970531569637947229,
            13189108543003157641, 2981856291403166235, 1400820811699314929,
            14346977402760305768, 14449342493037017799, 15125093539397565890,
            17898919923341886330, 14090119081056921958, 14504974119866483084,
            14564033928417812590, 16629828301877418504, 17247685080790687479,
            9387834786434818114, 13489722740184457981, 2041309022125195073,
            295746421134896981, 899690790331657066, 10889643475184307300,
            212815786548937028, 4414723392800938829, 13857891170292374436,
            14807470392755074757, 7387007542380320842, 12526588400836553393,
            16067668611065453338, 929091376137118123, 16655173890277528519,
            18154314030287374596, 3294522854827386362, 9955630837141683310,
            17111547492404990334, 12133726646982698844, 12153880000361150611,
            10349079992529557869, 9778799408267231048, 9144811749200837003,
            16235783728388094985, 17678453866743047208, 6430403270527146629,
            16417567743391476205, 17036083390304431765, 2426331358370085752,
            6896284111236702628, 14931462874142661319, 8125272341544680434,
            14492596485841665316, 733684673216015924, 10416455937388309224,
            6990670450709552091, 5101916429503392638, 16889455117409287127,
            13744880274290204817, 8428141027642623393, 15486284433834876672,
            7512608580253880117, 9091115780004435577, 8497418660028832069,
            18299478945080431382, 8042331298514094424, 851464034632953117,
            17862201494773821686, 17486427747440384194, 4965279008981041685,
            436125330331100678, 17636230189630705428, 15571608769923798877,
            2273667404304847986, 222956734156197315, 1144347043178070567,
            8582274028002118054, 15053286910072586020, 2394223794386885655,
            17824591608239012877, 216907403523322596, 13700067461031022367,
            2776363612901040669, 14014900588706827747, 16460424023174448644,
            11041823730740684994, 2841132577066379291, 17484127341270926492,
            10185511277605180616, 2702592179728645828, 8495340387548951791,
            14830118548351566990, 3151202805131888210, 9271464329361004993,
            5777698791696206514, 11360503467355323672, 3627877602146265662,
            17626212692713560485, 4309278249157841308, 10733132455354124705,
            2754178571169024202, 1650667292619367297, 13723932720374797427,
            7136567568019588197, 13082383768783425137, 18437200496786645948,
            2230085068447075188, 10471867001422006874, 8677661899258481339,
            1357885813581696595, 2328003203140045945, 4302941341642456312,
            7898111955651125607, 6378640890266573801, 13332522485838163166,
            13860521379717498529, 11485380916474380158, 11339359964273458171,
            12657200390494353815, 13056076179295299036, 8682780667388379298,
            1490959234750907201, 7007493295945963779, 17718845581054889034,
            10667348724403394940, 11777527484273334578, 13126575346166505009,
            2620119501686395215, 2528258112704388038, 16500197948919546000,
            10305677590617868039, 15200105986704882171, 8887489861928069306,
            990802159594886110, 8636172063424362810, 9350461441367950552,
            7898471265104883638, 14243721813593008327, 1671904920749661139,
            15728050570046109142, 166763193745752153, 3886596473863120563,
            5799712468620303154, 15011692297946903646, 4075458811906471311,
            3828009028260409996, 75948182029516463, 16575321058113856116,
            6388617320441848773, 5607737894288975432, 4011952936834403878,
            17895287993152406695, 5699878084460975401, 10570945650184076194,
            16057549010016413564, 8243647409898720932, 14061155853213653521,
            9400712523537307543, 10980960472339230575, 10498655300557992125,
            8401844798507897749, 18444638631333068834, 3348175801078594516,
            9155773328660911322, 6087404238969795323, 10317210852899218327,
            15011080130269799044, 17833905408804782374, 3721966631910939847,
            1403425319343703685, 7810128114619965182, 3171346602024754083,
            4926730628542000224, 3570027959973410231, 4057520306885581203,
            2155788957289011779, 11239558614991765191, 9841265103361067144,
            18248653085334200020, 9703628015683130014, 7317774587749972229,
            17329442469994648543, 2133319971657095055, 12192309296227349190,
            13196865621796746358, 7854031590545743258, 14321432992987713594,
            13580427963062785459, 2215270196417995906, 4587536624439063703,
            882333199710872623, 14407359005156880929, 18341087882967703405,
            4655302337653335752, 7256743251658691119, 6869179488394281019,
            13441169836846179848, 6640295523692751633, 6884640371844802027,
            68730182271138630, 9582588460492739656, 9583822272751747203,
            13051754388368243678, 11673164721245819524, 11930466201851698377,
            1484692776099573327, 2691009850288303747, 13370962406118287765,
            7293989367117281723, 12238682629247824832, 1814463976285729600,
            13353380253046781245, 10721678871835108600, 16367752662968646065,
            1018570678301433760, 16471167707757711829, 7087774751528760445,
            17362429590044852747, 11096071559654476131, 1252637406299877777,
            10744894775932144476, 1404564164473220156, 3354256051116065195,
            7115833728539066805, 1118062201662050724, 4663465554697261026,
            14392441678808720218, 16595323605492288235, 12033473813749675023,
            5652558249175052898, 533125101831111199, 11522021833003848289,
            13543108369155971329, 3449953696353316152, 16838520344033407924,
            719306178581978928, 2662810520870875792, 12447060353382319734,
            15899358755019098986, 1752720495017456592, 2934607842996042541,
            4795916452895919367, 3978339524750053947, 14640443692690426219,
            15642728132210012544, 228459012132402429, 11574067823110695669,
            17065007097765712144, 5946207257028206966, 948479774168806033,
            8461636586478848716, 7898305940448281639, 13620500389288543293,
            1263476304785558585, 13397731222767889750, 9519864174728695748,
            9978792475405797756, 4922374308287946576, 11186064220121689086,
            1141094941524936142, 12446555218453372483, 331461812741578597,
            16748215745986782757, 7006217496671580787, 13962164036763783117,
            9758728605416061101, 7207169259765825995, 15402641267392966378,
            2312076056317392877, 6605523496458937306, 15441639116399116369,
            4393057744322729442, 8637940914040048237, 665927786723631494,
            13508957240774065067, 3751385599461418079, 15947677858834615600,
            16803549434526428408, 12629159796228720270, 11976098161770633310,
            12030247652627326418, 1249363280370512510, 5433416267860243540,
            2677384358884084543, 11917683168226722371, 2254240254175259450,
            6041716343945356037, 5892312571085246071, 8284142811677149501,
            18025597230822192433, 5993789315084634807, 7533938032736836760,
            2414872347480094951, 8902723592869367086, 11555883926510870431,
            18185167564015498093, 5088296311893566642, 11743960886293959061,
            409518005042529182, 16533894993641151203, 1419732716453496389,
            5735470233917338342, 14666691235024835793, 16460446934319261907,
            6620166785283727514, 10006734766302273349, 5631819508538291458,
            433617943221620193, 10830495117789429577, 15930578923593006536,
            1225245218368264494, 2477675689544373087, 7058774043745559722,
            1624942011269680081, 15884037305573946867, 13926749859513109160,
            11567276947305692868, 3854202210544811496, 11909234509342039000,
            12724195615188563728, 14935969068333766895, 548093900468016898,
            6477372473403815730, 10061521490065211215, 4592975008819528288,
            16057082443169737524, 6608781557844227645, 15631603778844124818,
            11304645457619373550, 17259272139968846328, 15247547121604592397,
            452317576824725852, 17159519264153601745, 9964868899900134530,
            17491654686518405327, 4619549443748944713, 15793783753034223480,
            10561474225202039856, 14747191321271774132, 10661164101833301666,
            4983268886547995022, 7822618102394243594, 16993996107283253331,
            12956008170358174750, 979083907851948294, 4569718993508692864,
            2066192156814118817, 14548895889547641858, 2679870404523391024,
            7966432690099677925, 7255479563559494926, 444494930974437059,
            848121240725590026, 8485142590984100113, 2912612348376237410,
            14030672215994470981, 2341125582574715936, 4427262209071561495,
            10214664707966055786, 2981513573889915093, 496485859029334618,
            6098699546776630847, 16454583007672271658, 15170324174149262268,
            5969790010105813254, 15737454070152106730, 11035254468880484427,
            5823405979853907108, 1178278360077344065, 2412188795257424129,
            10631036862472821504, 10217829874445297401, 14967772813476976561,
            12035858655544569391, 1378508778986527806, 4956090093048428245,
            3766374878498638326, 3588255015755348201, 15577956044557840061,
            2236766912755221618, 4739060596362469645, 1395809733152063369,
            14011372220672258459, 6647979881351586039, 7083562174005199117,
            2987435131333003102, 4572421028250845502, 2687029731696119548,
            14082120875128092948, 6974702248932816186, 5053469112473751995,
            1942899512308922113, 14961687906996823072, 13164340974105286130,
            6759715765270753013, 4185983031224124044, 13164849258003757194,
            4035290741996670256, 17505591552583140522, 4278982292800507983,
            3976050451113233892, 7272477693598887588, 11109260677271768818,
            16248044885848372893, 873854964428599373, 12818677157931265118,
            2975124272668209389, 7271415504443574867, 15926168600797417113,
            14153069107048977779, 18324732598132016764, 17578107147731374321,
            17531549555702371343, 11063037511768403566, 6035531120250588400,
            5708454794675191719, 7915265543169741702, 17914880677919249250,
            12775933385707430485, 14077883431880923432, 9217274199780723068,
            1975278750496000004, 6192736539410862800, 12474496668865128136,
            10248090854179943797, 2593366717644815463, 4065007914016321617,
            144716158606422510, 5956937958474764300, 11800188943373084513,
            16879959723795244446, 10905258151648964835, 2450912089695150179,
            18441353955025640216, 17155954972759420298, 3144287959016907051,
            6565508478249996326, 1080351150571141492, 18315098952813311943,
            9790125268068658422, 13047825156652253174, 18176142107605910631,
            18044213955368371736, 5350532846596427065, 17096985095852956144,
            1220052331659463264, 13442140695982426754, 181743536957834186,
            17248777623541848340, 4615593272427693543, 8447129072391407097,
            2309705545545274963, 762208995146778050, 7887628660226226958,
            4284355511821099818, 2184186351665010098, 15922688104669051580,
            17145902623218981183, 14320759545182032663, 7700442072501859293,
            6465380380228995318, 17974143739859697246, 8710583733554405793,
            11175474635614580958, 7213330756006728888, 14467410624561449676,
            8411581536668912434, 14090263046383786352, 3486113130815675707,
            10809591787592311112, 4648828198158516696, 5528169611316095158,
            2347839774730442364, 1217285788574018152, 7763252783738282832,
            16556332884430946967, 11068384189750944303, 1187543533474097379,
            1606701992733753916, 16637674878016570748, 25671985681397512,
            670344324592490846, 11770712679701052841, 977549583405635578,
            17528900488421901926, 7255963768385235583, 12042264609241010679,
            16323870624193528853, 16673475668617943962, 6013436591312447781,
            14152247384048101332, 2426095814917326445, 6914828125630369789,
            11642304755464289203, 5779152449559750275, 2841430489587496730,
            14809397641072726235, 5313566412068677675, 11341000562407924194,
            4476610997151543571, 6404895322637956626, 17947839592718157626,
            6594204026970105079, 2818407563892947291, 728495084222057125,
            15692033930106219269, 14350826413984123809, 5980828743523321378,
            16400389209432396696, 3449182513974117435, 3002449789096580348,
            8838948453504844225, 10967593590981870512, 8309891790663942872,
            17077874880822284539, 9587760896917916794, 14902080307138617528,
            15020381337707900648, 15318027995874217899, 3652829733753570490,
            5265657647436053366, 2012070644219576081, 3082221891612359407,
            354561092885423578, 7609077884924787684, 13517215283573783152,
            4201342025926755975, 1303506847304424467, 15775731761707369492,
            2258608787861835099, 14398740379114780993, 10023540082647642738,
            8322457519682448380, 5416233712863670462, 2011525284646745150,
            7747858563077550667, 5724692866778916069, 7426551912177450788,
            15649884516547824684, 592955128393610431, 16318643434824457679,
            4353036368094447546, 7326756126628240416, 149712641770843834,
            17316122444831639044, 47955330784919292, 14964520723531480760,
            10463475547360404496, 17055964042269550871, 9091842524440282435,
            180780679602684640, 7104611457170536590, 2690158449756559644,
            7308299313009263431, 14180293843359735171, 16751363945161785053,
            10464782762440657061, 8280854345258800250, 6741538621766752780,
            3954227602073847300, 12623136999615709426, 16044038679341971918,
            2905557585252745743, 3386004706773510896, 13437500359844666908,
            8810597155581543318, 6619867923629780683, 6527651151789752665,
            12227177591007974168, 11523637938687375003, 2705789388277199385,
            3727781687133199621, 10541485020748774972, 5644021465879918915,
            2353492510829327761, 1368716149481249448, 6415024020209978792,
            7800430769550977389, 17689036190233583977, 9743634052122099464,
            11330854052827172093, 11447195676056948308, 1064237250233221297,
            5649165087950504438, 16045781162360314838, 4495688041800441482,
            4522234726385366252, 15306397861436377863, 7445022648282417194,
            7676094595505638877, 1343201336417303342, 17415700569221569035,
            1997093811592894252, 12877548812088154112, 6726118451681987671,
            1249780691239396631, 6128788037647213508, 2256241412843993714,
            15574207536016796035, 3986284183456559647, 3852027772856379524,
            4910538741401105572, 15216481061430476036, 7438443782388679527,
            12888654200830273424, 15040425912496448979, 2035828571392180164,
            1952359312550289919, 11315547978396619612, 8121251287590661254,
            17014443430365044565, 13644022330090072654, 8892210616277051209,
            3353872763002647213
        ]

        self._run_test(seed, variant, expected_outputs, modifier)


    # Elixirx
    # > :rand.seed(:exsp, {235505663641335888, 151224886011373942, 209032809085871576})
    # > :rand.export_seed
    # > 1..1000 |> Enum.map(fn _ -> :rand.uniform(288230376151711744) end) |> IO.inspect(limit: :infinity)
    def test_116_plus(self):
        seed = [101078568034570385, 217755723726089594]

        modifier = 1
        variant = Xorshift116Plus
        expected_outputs = [
            104237684562168257, 191009926248018863, 283467819989724775, 104485394582086049,
            36165953963749352, 171633845351829882, 274150944170100503, 196106249524244824,
            266998240706681126, 20416934400932892, 29538892765146103, 248719208220687787,
            267052318492218418, 240965409820981800, 168812263720017813, 33650155623082137,
            154456404213010493, 149107160061722567, 283618031191624361, 139380459847174571,
            89137798186236962, 46102516227612191, 176314372122265621, 19105754496337848,
            186029088878185281, 246810039993227259, 97025498977544711, 244114183706783004,
            244401479877687338, 111555030446086904, 20684978819471255, 46027068098570809,
            101444073600124828, 49906008656043212, 195102755300117240, 153614391700564749,
            258026072649571837, 83771942732560949, 73034720622649140, 180797870823604778,
            178970611608069306, 44576022176050839, 32970883959012404, 295050754395678,
            245864921605444356, 19708799913082210, 70262442330440743, 18415155433738537,
            44070706350721310, 278478492482010871, 21886600626049670, 82991364466613967,
            236653115653506894, 95820161596329169, 237958837426053319, 260983323471891109,
            183517458114894030, 80272144969798968, 172300561455825321, 276263412648514972,
            184539482912209392, 209831735576580351, 265666314650641456, 187045308040786812,
            284119648658562777, 127686756169929369, 108021318178157535, 79385678140677937,
            27827396769210648, 143700189563599452, 209068450216330972, 249188389957739057,
            194522655072580607, 39434628643461061, 59863099919292437, 166818680392705889,
            281339202273668002, 22890689246357367, 287841361812944123, 128270011077407224,
            233606010387696080, 194751646853381001, 88723007908362072, 132080509257461503,
            257841188166441617, 282267259238744100, 190167828493361552, 167016662708562703,
            117331471147576904, 178666206991585501, 201720558618131237, 29434977810230945,
            151544852318840137, 65597357110649114, 237876174471220014, 55120216083494976,
            227018062492434135, 49235735963501141, 246560875210687313, 114018340273870523,
            135975822120270419, 270979419984213038, 15508459127219906, 11898819851012598,
            252430967894492926, 106332234049842138, 48732596807626556, 122155720853340045,
            227207213077754404, 56959986121132550, 235719443884506754, 51356913423940063,
            255180379466004561, 183426515515262246, 216436048619664390, 56675865482519359,
            87024153704842173, 191805987916100251, 228240322802499596, 9154688102965113,
            25206306882176299, 19346289595247692, 239566927736519121, 8599163285337307,
            200301519099232515, 36689915739370202, 87939133008899549, 136435455540062551,
            269056863350901605, 209647712038334779, 171756068702788132, 197452111095501987,
            27603751156288492, 275420300614775863, 275432405143369615, 128837745943829027,
            136054514905820243, 74904949418099060, 202531589779188671, 13426928029768776,
            132515407777448821, 66101944390407339, 199389104027357483, 80844267091672943,
            281310149877759391, 2970072603466680, 65887165399821487, 67835456841160210,
            19193374598318484, 51493756216042244, 158213756396129672, 118108535906848478,
            12993726691103730, 214815172612579795, 75871323458030878, 70533476452338992,
            62561978481877056, 246656780094666941, 285862313791062119, 264102432211620400,
            88501328424737814, 52892395691232228, 127374683823933136, 180485717715506809,
            151838605130454061, 93940782744222695, 273634768204779126, 100583123396107437,
            12541346634021865, 154154999449058765, 281512496132317491, 145866283725944357,
            182925272502660629, 269459972088065146, 163086732242003354, 20082200316132334,
            79704578590818852, 68651928487542271, 111503129182918385, 91716769820788571,
            65145744427593872, 154563310970549812, 286021147540264440, 213285119442668667,
            206234410077076644, 271012638680608255, 176588475773965153, 267538282375956659,
            133543935951753443, 49720518052082377, 244894443495800501, 215299319311933187,
            197833903569809264, 227965132963650197, 221861417030928781, 91898171458334117,
            265153828106157219, 44711913386293399, 105237142651904549, 63534864655595416,
            257984715132209160, 8299132692980254, 126007699102128970, 124469237364471124,
            102070035249425006, 24403725878566561, 209700056435756428, 199991786708351104,
            211862718388253104, 287819422013198104, 284902146425430926, 197673973415086253,
            84844025921613313, 280929088957260788, 132363624414479648, 116381009658927595,
            226869802770892484, 177084199689226314, 111546030801498673, 208542256703564136,
            250694740084106098, 58785557555942075, 218125510201562941, 218991685625955399,
            221538383519536949, 192126364661474897, 74698489446592130, 253504191517433725,
            62994673164494624, 91681631958177806, 113898878315838647, 266833879876665350,
            106058042659274874, 127389659796700375, 171737025574458246, 81319416577157167,
            75014760093663383, 275897265701385893, 245850571711847901, 117649348255546720,
            225658828337921637, 218610603587582474, 118990470915528445, 4886714569914020,
            205010241053267303, 121899761979029037, 123717283407629031, 4979344263961021,
            261242691723526850, 261346467295404920, 229905010401701309, 126651015636040392,
            215100593992783973, 122885493980945579, 33883632010938389, 2998769271527956,
            263492361467870223, 71766883552593899, 231989303825640701, 11282505407827611,
            126514335894894057, 42927190939292878, 5900986740201949, 71155662208923917,
            170977232291158459, 145206064219918255, 40753435627409194, 11800030073631696,
            200059011394496393, 37591366358719475, 27760503029877316, 132946562065472831,
            237384114857046884, 166816620264881629, 235184509526730148, 146777665034266280,
            142127700603195325, 119016037964007969, 265591702536769283, 194315513322743095,
            24220518784010477, 269568487664410124, 27553367183151589, 83920905297029646,
            72044747899601900, 103656704797974022, 101844107211191004, 124528365090810512,
            93295038396993969, 10410946282924274, 229863340151904592, 132930890242118581,
            168960557087364188, 19197165437370918, 227929812691943814, 37936499637467434,
            26232565998206902, 105664096216829753, 166483983288420256, 175810851209706758,
            226308142512593482, 165868225356826601, 118638580071249251, 140776756601435029,
            232090935587412780, 282235213951187614, 209332669491660211, 176689645542502641,
            234399013313979199, 65095972846349524, 271464479303309767, 79673377692884377,
            209689159749046215, 116745814332408662, 63135322980605963, 137630995438014192,
            203786698111083891, 119917606693305919, 193414823188442592, 239365584139981381,
            137822978540851863, 246806292807585819, 41055794498867693, 78279786529479149,
            248004879561927770, 238721670086065412, 252968156075359280, 5723591031461786,
            148329912264173086, 168981599179519925, 230722985598374583, 241446647904204796,
            100258508934684069, 34360943741196328, 132515352072635832, 46998081366567809,
            181979882536039825, 244472343285814954, 219900066812463563, 43799765636000678,
            266611371000222894, 249782542009696918, 42782555079430905, 223266225683572228,
            87562577010922418, 82799231425738300, 178240914278147060, 286134687911399979,
            194674054786831650, 199911322625032655, 255584013932704199, 198801743081675059,
            124082208012305935, 56168989633637712, 50722328736465490, 137987740884430831,
            47209327252139330, 110436205909669815, 104761700880457105, 217472823379371604,
            238551581233050193, 132979402719048642, 271674113598386956, 142129763473505272,
            249467502101047336, 84925461774768634, 199559056090946615, 225105650422627388,
            279546716204867280, 237755182489146094, 73404748562975725, 114002018160409847,
            125900212138704903, 66824057640118113, 188158525440501095, 110789396703249491,
            101768030872066361, 167678589182752420, 45019507758233098, 14494604982567524,
            39300103619865253, 9280509818073618, 227909518542877476, 160442269106198101,
            251693231251708531, 148463160763197864, 115454752088406782, 203493988618994536,
            70612832126356766, 127301433112748684, 121632105528669238, 31417005262665345,
            5530447575903691, 96116794490622246, 184219774449756342, 7144081776721287,
            69163940108316822, 150560713292081447, 41247212602472993, 123024581961941003,
            186124046667688809, 71306031500448540, 202588760962639451, 215149918662138045,
            38145039093154209, 239389766829153756, 56805519006505908, 285081713747472818,
            106214924168514803, 48552984915848989, 169431720231045272, 247380047739482299,
            187784596976979757, 247210159988146194, 100822893219634008, 184935543836491352,
            147265363205693779, 126921534889492242, 173949456279345498, 92753925880868278,
            215670463727750802, 247992083919545379, 100785145866342460, 117099311027340842,
            222971971075442022, 126856425164221540, 159190397453608030, 131271909306261799,
            162412682829835133, 92712233706023485, 38970505300873697, 21890664855974340,
            256209281071310729, 55366534871076575, 72643971815240290, 158061312921787024,
            132393814032155123, 135176006271890919, 205450011634169502, 33059239990133803,
            10712943676836275, 274868531935055258, 87937440080427316, 5544827749723772,
            10369625584578233, 144410673144783749, 235261512648190165, 233996482515751398,
            113281039785975127, 111491549681514202, 108430634981008147, 124816619363859144,
            198341669726697283, 49591284048176743, 40459573020680902, 174786862058150716,
            159840416981829238, 126932309891512194, 277468752529900236, 182673840936232572,
            175190303752467044, 283266225648549449, 157763548488660592, 44746354525206142,
            65487138208504386, 266225822303689240, 168492254967596022, 8459265704284626,
            132286912666187845, 144178062253290513, 82146391086384954, 151709141217011247,
            5799305440446387, 70075089486172774, 68137355210574928, 11493115563266648,
            225151958025282492, 250056816129773738, 74484845364642733, 219384566896520456,
            179451074215234868, 37945904780339444, 208956181198450377, 211854703984893067,
            126194734715063587, 268219458453111745, 15828115739202439, 133059979889428066,
            216377089918252064, 28443280044312069, 179768601666164523, 66728783078213979,
            97501542484346459, 137595011538342396, 102252403170442446, 38826791605860814,
            245065394465666717, 267461139721235791, 159770674070874298, 13896079817534621,
            59496455596513497, 133887358303810409, 230610092932666431, 72726058743363257,
            102575188279326487, 106004112855036193, 260876861092993969, 5300615340192192,
            76709467549986888, 229197766385260247, 95014210995476451, 48388213620855113,
            239663938169990569, 257642075027288673, 232986842194100171, 107782262658634045,
            132442786343356179, 208397633285305243, 116318132870373872, 135415294465024608,
            181085853849364410, 175079192426788983, 225894898753540046, 262474966958936668,
            76210683590951525, 65920237419302115, 240577333992041562, 188988243710068256,
            199325635482863603, 265660134154147726, 74584751295429341, 90172514841514414,
            42175543058571446, 143428148520448595, 184044569534062203, 28260419383659707,
            103619644154400635, 83937285015139090, 236790644105218058, 150708442639512897,
            43352716827818866, 96370948828020072, 275606197653727798, 20058078654867127,
            306830134927579, 26063042443156124, 264913295008507809, 37138570062973934,
            275200009825612671, 36582223440722821, 163344353323678601, 9263016662900907,
            191663905396729996, 34305150086497572, 23641977625685782, 73714961411691799,
            130638000325597374, 234316730171201088, 124959078468692105, 243334921969532480,
            220775962268823113, 77029441630815785, 200145378190029162, 83189164301432471,
            257620331801510118, 285554799505403224, 47036917861912617, 30582535028090550,
            274749503655809823, 266454795965949927, 286509280408253684, 174846529630532788,
            155058581751887894, 125740463387645402, 121784200363421958, 213908991262734257,
            253937322683986335, 30285156632847888, 266696147906355581, 273972527867299068,
            270431908713201108, 284185063660496158, 58626605187272014, 113892458671465715,
            206255188780483355, 39568225302178610, 221775130665246914, 135573557216633174,
            9340932820552976, 210149703508553602, 94739496675770362, 83730932908683414,
            132374454845999939, 264932822531770943, 237414125251731600, 226553279946925946,
            229991009740299961, 146562561142041875, 282837700309178596, 247547377360830978,
            167274317300812216, 22337048476525495, 230658915273407859, 264411114598446840,
            154568533441376850, 34269305474236536, 159754729618407759, 101740380556336420,
            51794058609697378, 10097065865287454, 246246144672437790, 80789110612531272,
            150751922345098185, 24925362448414890, 225668331296405696, 223651725399080428,
            208526618699147581, 33075377900463317, 192014567936670324, 124722975724704511,
            189858261655117441, 139801257382126827, 146872219882712297, 204789401597506726,
            94599782728860044, 191442713217169121, 124776676034804762, 249825187745596275,
            288095112384325673, 91103400983861564, 204645877935815426, 77055491385816858,
            51680337013539834, 184164400357919274, 268165942370368773, 74973903375249526,
            173881902391154760, 229027398562964620, 1285112340926208, 31599328036617924,
            208423212591914186, 165048942334003935, 83649843530095972, 241290680172434529,
            106020154120505592, 197748554646610316, 3122139651169815, 148472344597889467,
            25263038763405665, 205124485345515754, 3560238455858690, 245503401241790651,
            287955263735977413, 118461126304448153, 72120780806712703, 221327556736769921,
            143239126119707867, 101976884534545547, 125583148510120186, 262748580722488779,
            232981974995501389, 64007825111622073, 50036420603261121, 229662379132774599,
            178519775341046315, 200229631174219209, 178935063417287096, 123051781448176110,
            89191632084564831, 2689763666599294, 119508251317335763, 218126869266488416,
            22720714986216878, 66296785282851105, 239297878993640280, 276433942159981022,
            68382346689116886, 130748946788554829, 193933874189270725, 94624890433024125,
            99136932493368243, 11709785940992159, 181971294823482386, 242196655773150535,
            146865653150636536, 246548546325134997, 134143783209089222, 88748093169928024,
            214888902650275864, 146415309151743090, 114948476422714990, 149877013603434276,
            53106826049817467, 115660438640873759, 96401528046537636, 205775609486431039,
            285825745511559977, 112437503669964953, 83698979304457811, 287124573654069704,
            257072122110511452, 209523650155427464, 269941768522899370, 217035623874055049,
            250884476761573776, 102718009526400357, 87481505941186661, 113452332777215128,
            1720817354563091, 201472013200320763, 128956261127898549, 36850501028484422,
            247904468291807397, 22109934847092053, 106381782259916928, 208019117928661783,
            204636977094761452, 58858293102826745, 64098505404791314, 145988179447268230,
            57858653998578734, 243243910119881438, 12349466546823895, 45960746726304633,
            196741401201636191, 24099000145344989, 170538393709105319, 22973625872539823,
            148318805205386178, 107550652009204192, 182682773021950845, 190361479507601825,
            124401566155833218, 61112783765124422, 258701854547705120, 1260131914640078,
            80062226753626478, 253026594423853877, 187807367778866903, 139183624938663642,
            71624295506604865, 5508065767785507, 7361806821991460, 109008973532232070,
            225279900221015330, 222279769324712577, 285379174036193280, 223196335058222173,
            25498193930014546, 259936832371985530, 24859800830706589, 49633201179587461,
            273413148603642842, 78882341362606162, 283184717762038055, 55688691393404507,
            55111814930231610, 119928013179787202, 161709134785661008, 5865901221226651,
            270126392491970425, 152444698740814464, 21136282321552216, 89782354886724373,
            232994838873519679, 106528594587790876, 282688357013204903, 86506295874466756,
            83620730144527494, 172094660888257794, 109860248047964062, 273744967718553709,
            146969822073662327, 82569800559304642, 58695835728235626, 178547624668411509,
            176675170144368875, 187442491847853668, 166964593045032423, 267616812688195262,
            220111168416161994, 186751825557468176, 37769628261842860, 81997272077188500,
            122681721199543241, 175343766701498536, 197814381635253145, 270218609288309393,
            230869593237462592, 187421774612997724, 253376031345507594, 254273383066581800,
            183034604844803039, 177443588048483922, 74753009522904735, 261432367042112181,
            145739572424238155, 4229825788939224, 249214491437380182, 24379412706416733,
            242097901969178650, 97765297230220474, 24655691174677963, 186127473115276130,
            202611538404481073, 98147789168320771, 159519520361429573, 60151563978854739,
            74744856286592766, 61140515886981074, 58384270035758100, 13833351783100125,
            186356409323335064, 146843321737183477, 51974623788607335, 4734465541400704,
            152034646008565708, 81953136962868254, 253393264675141430, 72022474459571591,
            41132836561295541, 167904932387405419, 230152215544747503, 96226774317356180,
            114941927873068649, 190678132426654589, 7160040169521558, 97219912818642550,
            143683745118985268, 127735993400103791, 61725205173150532, 37659976019873223,
            246389040128629535, 95353041909390792, 152310546540998004, 210313954687245286,
            141882343894904755, 107067831640416823, 214131427294940048, 82291549736129252,
            15867452382747406, 114390062934029741, 149694870903953240, 39655911602398516,
            25994236561585913, 34667082523597897, 140936309651995479, 186503745655895452,
            68207924311444554, 81866269475370019, 224388498327302654, 161301250002966022,
            43133973558054372, 16032311914130493, 198675955947508782, 218516090951083534,
            122370884451290755, 48820418649417001, 195907760722918958, 255306699777098244,
            206069208479147809, 185172302730534497, 8717586192309031, 224682936804061706,
            21154958947604095, 63581862217748094, 236897029753036153, 35797724140301755,
            92512021626830446, 284097023531534263, 81709059099166284, 132937765247934556,
            284777982030419119, 54806666051553792, 247728258211686575, 186842962468449948,
            105971571560983229, 223258730758885804, 42695457661235420, 252916423867052332,
            145863328241533893, 55763208552625538, 227785863322204354, 83866889159816885,
            230886649485707941, 54370844603396121, 172005060413969990, 207522663208047573,
            111655478652268017, 246379999783172369, 55736650560692316, 255478493588499611,
            179121402487598922, 55832285591641225, 234377899367991362, 107699620608887544,
            245666135487399400, 139305256390325393, 160133318032072362, 56666027688756482,
            76122242799727928, 194264325068549507, 283154468133693171, 154200691035538354,
            100302980779472837, 99581544928929779, 176176949955191825, 73336254955421444,
            281980905020137393, 170882938650297253, 222522670235964881, 156750042595943247,
            112633907057737236, 122646990521133123, 218723978483167645, 113346218097092798,
            197649867879691054, 162706311139799583, 112261951128344539, 157926293041556393,
            140033369389119085, 228513205921948546, 59429462750645637, 161309982606674368,
            93194261526668891, 14037624740732443, 200890999700118499, 133944081183935893,
            271817074607662547, 47971258120190004, 113775041568316266, 275156726429093749,
            185803921900552157, 11781022451700083, 205801075850300195, 136435757898950137,
            149786262757132782, 199141185848821642, 54240238871919729, 37882289367633428,
            142733044184081700, 262171585454322230, 23245902660169828, 119552506990826838,
            274975112416983667, 238402004093771743, 275512777185823738, 41288806416119676,
            107737796366635189, 39353266759752309, 259727064680769359, 53156914020032636,
            271872113073714516, 39283614120188620, 277352691443624949, 177004659825646259,
            87366194955998003, 8907158140062514, 252496200450611561, 216264737586658533,
            44468503012437132, 237501907313549519, 62952867854245246, 261386733281606046,
            251827081541303770, 109221050644631293, 252523674362592237, 105545615164955568,
            239204137505017091, 243013392421886258, 126670761494664902, 201510915840539631,
            143038051569794875, 212578901688943909, 257887891058460059, 222914202083325896,
            277412606979853171, 1718154161085402, 19247145748490595, 103215963901611410,
            176619063689229342, 168038484698317939, 155792701107553997, 25195590299690755,
            220707799727374060, 87020397503542802, 78522429659922540, 172851768873956061,
            115359099044068988, 116274257164071794, 232835421519678634, 250462166012434396,
            86054229249071193, 74018356203582060, 160957952014922717, 268193449634698785,
            66803874888271472, 267083167380077766, 141713299353181423, 38161658452179901
        ]

        self._run_test(seed, variant, expected_outputs, modifier)


    def test_crack_116_plus(self):
        xs = Xorshift116Plus([Bytes.random(8).int() & MASK58, Bytes.random(8).int() & MASK58])
        out = [xs.generate() for _ in range(3)]
        other_xs = IterativePRNG.crack(Xorshift116Plus, out)

        self.assertEqual(xs.state, other_xs.state)


    # Reference code from: https://github.com/v8/v8/blob/085fed0fb5c3b0136827b5d7c190b4bd1c23a23e/src/base/utils/random-number-generator.h#L102
    # #include <stdio.h>
    # #include <inttypes.h>

    # using namespace std;

    #  static inline void XorShift128(uint64_t* state0, uint64_t* state1) {
    #     uint64_t s1 = *state0;
    #     uint64_t s0 = *state1;
    #     *state0 = s0;
    #     s1 ^= s1 << 23;
    #     s1 ^= s1 >> 17;
    #     s1 ^= s0;
    #     s1 ^= s0 >> 26;
    #     *state1 = s1;
    #   }


    # int main()
    # {
    #     uint64_t state0 = 6214834593736130671;
    #     uint64_t state1 = 13880872148762315909;

    #     for(int i=0; i < 100; i++) {
    #         XorShift128(&state0, &state1);
    #         printf("%"PRIu64", ", (state0 + state1) & 0xFFFFFFFFFFFFFFFF);
    #     }

    #     return 0;
    # }

    def test_128_plus(self):

        seed = [6214834593736130671, 13880872148762315909]

        modifier = 0
        variant = Xorshift128Plus
        expected_outputs = [14442026376200238377, 1787432562779898107, 9528207696033866621, 2626395574029386916, 5873150065745423031, 13482597041884379907, 17626953185406494810, 18379625074238159893, 14292849864404299110, 10946637745658099606, 8383953755011095672, 5770773266356747312, 11125422413691963076, 3408641158611839868, 12945627534597946354, 275068695369142241, 9572962387482822253, 13734507643752297879, 8274692281030248280, 14679281201461003467, 3159062602067558477, 11163597865874422819, 15534050086253560596, 18318730307434394157, 477947898704949996, 2573069320332747880, 10557966585871285895, 16415747446271487248, 4846310463573847574, 13074974358280725838, 3098526911241477542, 12231950442184680331, 4913352019886868314, 10070975675806747456, 1727115207762575364, 710257344258994316, 13916617897492829187, 8896616167667640870, 10673529855806286637, 3896973087678063850, 2928267777325686969, 2514597347209473550, 17617256499765469296, 5775926734662294396, 2632972811936206598, 12831995793058297181, 8556693104775127286, 15870975519535800961, 16929787510832397711, 4900880994539637133, 6595991883535273538, 13420987944460941411, 10724015383308683772, 840166210656764966, 16822504598932461791, 15715811322874579263, 1537272655931570981, 14564812838661649079, 12380714737687736093, 16977077128785662420, 8785466018365887579, 12155354712468904308, 14174473808023265765, 7967970533112529487, 4613821935041216023, 6021026260475306322, 2167312717788062974, 10118915703531840406, 3869703666389314052, 8893348220749459861, 14980483119527800116, 2967463146789792479, 6029523718928881851, 3007966179213405198, 14291444422358149457, 4765583887136016017, 18068074859508267709, 6823563986976791210, 12827275882175703940, 4163190955207685754, 4737635237769121393, 17769354029206997798, 13686914597754661630, 11191292350440624377, 13196935229899019468, 12045081319126116813, 16579622214395497877, 3794471766333921710, 1616051553243034430, 1579083019010251020, 16263533608257672201, 13681705216396657115, 657457776582252461, 17841157711925780280, 13628703671065120351, 772240993905500336, 7039133552273377205, 16340072552429032174, 15181200839486265686, 2363611035023243149]


        self._run_test(seed, variant, expected_outputs, modifier)


    def test_crack_128_plus(self):
        xs = Xorshift128Plus([Bytes.random(8).int(), Bytes.random(8).int()])
        out = [xs.generate() for _ in range(3)]
        other_xs = IterativePRNG.crack(Xorshift128Plus, out)

        self.assertEqual(xs.state, other_xs.state)
