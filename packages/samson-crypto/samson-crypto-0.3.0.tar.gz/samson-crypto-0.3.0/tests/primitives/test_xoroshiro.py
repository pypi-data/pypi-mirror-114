from samson.all import *
from samson.core.iterative_prng import IterativePRNG
import unittest

class XoroshiroTestCase(unittest.TestCase):
    def _run_test(self, seed, variant, expected_outputs, modifier):
        xs = variant(seed)
        self.assertEqual([xs.generate() + modifier for _ in range(len(expected_outputs))], expected_outputs)


    # Test vectors manually generated from reference code
    # http://vigna.di.unimi.it/xorshift/xoroshiro128plus.c
    def test_128_plus(self):
        seed = [6783308955432268063, 14704446235667538280]
        variant = Xoroshiro128Plus
        modifier = 0

        expected_outputs = [3041011117390254727, 5071177098431251269, 2735024712566712640, 17043304739970734076, 9031912156207055266, 13762503918563365598, 15584917822149754233, 6161717428856665171, 10349972277970489959, 9710764307524541110, 11080327262932986219, 10001044817891050603, 7669350616234916941, 293662738524023725, 12583697961994218639, 10710333584744795100, 10327175920431417107, 10938485592722936529, 9365442651367674484, 17595856918407368953, 11865760275031938714, 3759787064378592659, 1296546772800754877, 11067948962389585427, 4300944488049388159, 17437182156800125534, 2887581323332345883, 12171389866291853083, 8053023468348411008, 13235746083353080758, 830849224719346762, 8214906653477214926, 91033745434012017, 11360283656154528553, 6472020202965736964, 8102915301533386085, 6276538730334422753, 11286241969233391416, 6056253353739871229, 13801250578340172738, 14026355268312789106, 12400967603829857448, 774692057892437068, 12856561259041085761, 5858213581369669291, 14341446278265961870, 5562198091632186620, 10527297400999816106, 2211267440333394720, 12975561144851057666, 3381614120896665219, 3445852647090719261, 9565404869425768791, 1154383007897688043, 8603445277444717604, 2737753142720290549, 12716757710298213667, 4753817172970069875, 1713044969339506973, 6741817413512685680, 11715458969908802021, 17741976479416510425, 16727031534280532821, 2274268835237147002, 3676767745650420362, 13284132908636434902, 12051198645049225576, 4579034228771616886, 4744037384260498994, 5758046301334315625, 11373209472039979405, 15843786623781715709, 9254485329484877417, 4700765260775726109, 10332756803675532932, 6634605087948510838, 13125277812324579000, 7212295027596187519, 13275017540210340375, 1726732544812199437, 1375736340408329309, 6224889388302319045, 16268756262193327806, 13649657890017042101, 1430095771052949875, 15404851816885229820, 585109866602169318, 6257354463954637457, 17416935449353432515, 11666983462241824655, 925480549227958498, 12308953392866042817, 10012998000675045577, 11122086454627149753, 1882061190911920546, 10236974603149595122, 10750101041167593444, 14665529189674844964, 10495941803398902635, 2580303336933368091, 1973206757732777712, 12363587978925789655, 2176705251613174998, 8526635593784808370, 14995334017942101237, 391566152311487532, 12046255745925254328, 2381367741158498529, 12245200767226713440, 5390933664626114624, 10520122061031760833, 16749441560622048534, 7710754965174251906, 9490239840101336199, 6878807986678962359, 12783183408375194643, 2464698263944168564, 3764885731819202233, 3248147794635537273, 18343411312342078264, 17475602402931825908, 6979188821188189932, 15125050547433212198, 18362042260223266474, 8671561911828343204, 17700463267785637053, 7094373210287947154, 15110556564251505486, 6844335063155661218, 16885738316874347881, 693849193057337699, 14285365614170008159, 5160278727862211122, 1327175996925536259, 16021981312283193883, 5726275048920102480, 10454253466168394310, 9500231075353642975, 9061292365896997145, 2501089034897725062, 16837499377756018811, 16390015580827655847, 9122321799728691124, 14888118647177706589, 13942732883004710078, 9476959188281936151, 13847631172297033400, 227968528582006721, 3704045473231072687, 14968301642786068959, 18187096799327575734, 7630353285918786540, 12495779548751609624, 15753273796646946790, 7427415971864691146, 6701586774495347012, 18151768653521323747, 7093931051101643024, 2852541717718211594, 14336034987996973355, 6023308583762949114, 12634723185800331672, 14096471922750389966, 2029609974574810539, 18357833391168814607, 6779237899658984863, 2246420648501201573, 770278730459016249, 3238604649633529233, 14729643132802723631, 17875216039336226319, 5477432119920851282, 16051902974587898438, 4729175436307607836, 7694274731288458175, 3773739573479133176, 12505371027813201605, 920407999837136600, 761064319647700386, 12538827952633410954, 9336398163342045931, 6091092174302013419, 15335557955107409916, 9006040106024689718, 12443131497168970183, 8414616565390169383, 4249248434664297013, 10320321085118999888, 9919869128369887619, 8114905150105211296, 12288787912831514175, 6160901736219148012, 10278821633580509395, 2849969811045136624, 9249467705568938584, 7090202173253205610, 1498950025039162385, 6483639304275830971, 1060254145631377667, 1149397861127201181, 2980947684403891766, 2636987177587986241, 17598092914949830593, 953170996715014310, 5508854198676279806, 12435584615098883067, 16180981364194660963, 16672385530098248242, 16719040135876934509, 879475305954481451, 2817485271549749500, 15166512100004764691, 2197845743046973431, 15422988035162828995, 12478647133663349474, 7750058754644906079, 14089128222302213251, 645316678985277026, 16474948818324772878, 10520307032889097826, 9035984362020890285, 14604851342255913619, 5721315490174572905, 14025081823418068404, 8782449447346144819, 8229278376113147840, 859348622711685712, 5191459658429488244, 9689117608397839251, 12086350465607091818, 6859203116086715183, 4379579531392504351, 15789838295462928887, 17770602250700316203, 191987303760414912, 11379530074293228211, 16182150736946825818, 11009385445292072299, 15155858463284595464, 8214475282022779662, 6772410005648920070, 12043532086915269594, 2222482646549469130, 8320785442431403379, 12215750090289046067, 7944464851639954785, 13375005927025976277, 15757008619340001070, 14489140278226057457, 17508982581339944081, 6970488173344573961, 3374233884084657528, 767068162757172366, 13824580871436654196, 5655199292121110452, 13315890735003723191, 7054513894432477236, 7201094037319515482, 18168776997284331267, 3416000260972248921, 16277585347754805786, 2438630651995884490, 5468847882863169447, 10272182170428585804, 1874164636741509854, 7607577221584489128, 8909990992924839492, 5012932081876874584, 5680327696307509854, 16654310950736787588, 7213482265029296973, 14775282343982785108, 10990468622508933810, 4526286063118671356, 13186762525386632855, 7724087266831515867, 7548402032606040284, 11489022920027292324, 16098221046827229503, 2815464156098966922, 16870984535434177813, 9825665103225753051, 17809411053149019625, 9131358966585799573, 9394392431201924619, 2375399779766756942, 1160623983640255124, 3846597710981594694, 1298921402128303667, 10674505357999813076, 14995293381807273846, 8436210812126296870, 16425820189252668052, 2110026048417213340, 17392249584531521227, 8011813663741281754, 876052713190229935, 12173681375749076585, 6445428353481125785, 11515588442720417371, 5700089992532328936, 373464179644509714, 985001668403136456, 10843261895358941283, 4412829623362729286, 16867019365089920978, 11706573639805304811, 563676436246610479, 7186572102822517414, 18297699873361956795, 77586207763211212, 18418494730965707884, 1986763834771811197, 13244109999387616723, 7096312197085352299, 15832164983095831432, 17614942287132058773, 18298889467003550618, 13154926699695663018, 14965575937780622126, 700822440268363365, 11716641746875441239, 14229277082824148045, 6670767838113872641, 10778194760012641981, 10778554102356140651, 14576531408598803478, 665011241601979895, 8113665985478012200, 11968157199975415397, 17998132585560412019, 18298399651905896706, 14680101726687100542, 3885358870513929237, 6621884600648542840, 5672962249472629780, 2454805264133483601, 17575506151552422475, 14305687481346121753, 14097011765827934888, 10676142243257442201, 15584076770465577649, 8313816821210246672, 9201872419413989447, 18111754260161050382, 7721994726646081227, 1704889916106644533, 3282503868852971483, 1841790168328829071, 4878830017369611704, 13259328005766407342, 10973210717921967628, 3184551195500309464, 14651390910741034883, 4519074234811153348, 12960833502952451428, 7018417959908226968, 2404158316624748662, 13194750638250683801, 4063566842336085623, 14041622461781773635, 17786556143926486549, 8388559599719337824, 12159788723993725456, 8383980336316407154, 5337179042182934564, 5874108825180273538, 11066362450521076254, 1514565848676796599, 3390351518755846222, 8308351100326825903, 5930633083993508715, 13633016733243261888, 13670819844579314092, 8047476841377831030, 7753151529196690717, 9842308860611016125, 15427628652289594541, 10037409686436522619, 16524932316073487656, 9370007625402191453, 15455455707109174918, 18333606896959686647, 11864499173686678097, 5946850173900207761, 353954949514568483, 7632778751653851905, 14509318880503087204, 16574636946032125480, 16855339245691520752, 6327357038956990657, 17923205315945981780, 13402309614150932671, 16236464156911833019, 8203079058844906166, 13738710232552481251, 8596724403981823779, 4940048982571865652, 16097237784109191305, 13678407841900114932, 1096716342216113838, 11311909613224902136, 14572710290381043022, 16981906359087775633, 11139556263684411153, 14636119875834225671, 15455329210027971364, 12906284080031761529, 15899588286510325875, 9717819616544836641, 15188538905513677761, 14586961824260185399, 5102853326612356466, 2116313283977402792, 525726886951780105, 18138655943251455445, 9639115702220780804, 7120973865594846787, 4683639954043058467, 8938263020163663435, 9584063893420513744, 16107389970681675314, 512614672690488841, 3129006259282009720, 5962259806051305399, 13826786649548963385, 10706579572824363559, 3215160409585101579, 3022201224854720796, 18136841808722600586, 9069054506754862416, 11357636332599217142, 16769315402351412518, 14357871012733941515, 14724052073850503939, 17372471202582448141, 2120418155112452162, 14685348826249852252, 11035863410840977588, 12625154040699241307, 675923913409748442, 9453041823731524109, 1198778077972328694, 4714093367307579819, 3173727684694129603, 8350967677565050176, 8943645179262644766, 6312639061934758163, 14144771191284466825, 13610449365904850605, 2519328328902244202, 1508358843049568248, 6881902362047807913, 8376877707749838496, 13009539642172123983, 7803685838589232051, 10975784871168790048, 4932382954347701706, 3939787598174240202, 11972262691060072904, 15386622384411381450, 9591149157768647435, 5285965545422985863, 636007283859740233, 6272278010195016645, 1310599464244266207, 648278415393023995, 11185868852753016328, 5029109788712490857, 17782625070462793252, 5746137898381858248, 17920493188089013141, 17264858050287279715, 5435971733063834468, 17794270957497988490, 18156428499882076318, 11152383480342487976, 6520693738572847376, 4562050631373527351, 12369628195808061455, 1652029957721131031, 16917574012289858904, 13305216484986952178, 2734672804591997787, 9645131624170110954, 9881365323309174108, 878933584844271031, 12798765159712535239, 14494747974053223261, 3661888485248293120, 4491611022661903579, 12507642572843338873, 14027530410900170283, 10744444857825850625, 6342819260546383253, 7976658516404188623, 11890321487887782689, 11616268141302886847, 14812210886631625669, 413363751958670487, 9170813149806507145, 2923035496312926010, 16721991739107945651, 8606991552762539286, 1526383940471770524, 4202872328025789939, 2617696892404276598, 3001559886615094599, 6169421702851405611, 14262511563080718925, 8992966638451893426, 432865144575451677, 2393977573723861372, 2888284982539563644, 11725732274477572471, 12388482146641201569, 10668173280837352082, 8154164392079908069, 4027975161992090253, 17440728266416907646, 10599674223208703007, 12955136824588079622, 8314254392299474653, 5898241469716662352, 4583492140408317085, 10869626466289215444, 7903105915494090683, 850827308412340677, 16696224213301701044, 5224178387362148258, 18286408409008780101, 10514756184627158737, 13821509769319590207, 9110294373806003578, 10194274160484317240, 1150167302886054570, 4173153135185892177, 16132526766136498977, 17496314441019744538, 5545594857552482616, 5068468609511490867, 10295313372162535156, 12317474719672163733, 7409593767891835411, 16931093114480682345, 5157117225643151091, 489157052330908386, 658591194037437247, 6977687417729752704, 4944178120698772158, 6252755904020391101, 4318366359389029996, 8783682325503653391, 15462441040694655906, 3661249926489791022, 4274807777979168441, 9523105246513788573, 926737066140999891, 12978607070314320196, 13205817586732307165, 13457113295245730302, 2963224908555994613, 13117909586558289135, 7636404216687105196, 15179339132934386600, 2643931477837012293, 17825447448990337170, 13922514419525062289, 6833861655536130322, 465248332933048205, 11226524291727965922, 14089462026925353626, 12703002776898125041, 11248981228140848702, 12846755707278397228, 10370929441290351460, 7857312522905046861, 12603017825402783992, 15454777958644404695, 12064558316467582245, 3619468522665148065, 16486788904221324112, 12192170945708985005, 13867295500221410045, 10096650554022531008, 4005444281938423907, 4939938775191259287, 7714317271235574999, 14132093967767034259, 10914928678456170199, 16607681515377045038, 7116950219506463214, 2528561057498186631, 9964611568410737308, 720414398594703046, 18369929751397909442, 7742545368785733543, 5122378069702587667, 8798550687914516025, 14369669076122224156, 1577493336332423927, 13410990686141202564, 14441679820850067188, 15286392828226096816, 10402726949789908265, 6375653916056902950, 750825375721737371, 17712006179659404804, 3981127174506726127, 8070869236563151184, 6671695236768386381, 940516615915336176, 10421114664713351978, 496337658086872275, 4089474333660877126, 7711879965179561400, 5278170918998789042, 10045856523659987488, 222442238062092099, 13665649684537581389, 14352027010801126847, 1202051355160106706, 3912902162535119985, 11791377811614244476, 2558015100568079664, 11855404560203894477, 10769436367028432139, 2337018854350769002, 14913144108798033303, 1263087521029998742, 4895940123301399199, 10019432236555691366, 7471842293213184813, 4185671083597309907, 6336650680879611482, 12510480770839144380, 1415814499456268163, 15622387866561575204, 14825846242047344641, 18146989323158065639, 14292983003037399894, 5712766796462840146, 12071933352764563808, 15347187253231825013, 2177483054901694389, 10292750490691531167, 11217969105904233176, 17967869874372591628, 17639412825645225398, 15182614751910226566, 13404526384777670837, 15818844985004727472, 17303349297603143956, 683582319845744711, 9487358965876772722, 13375927526731009819, 1322565983820069118, 6530599750236856239, 14853419943339827321, 12218532294846345672, 12768585012427381704, 12672445599773142060, 17345243129201811903, 4718712950294312127, 3601243388995984392, 16031235728176637734, 8297262268282396774, 2732509353229980975, 13824511504550319288, 5568581536049751385, 12277948748220368341, 8424914484073268247, 1682970118407223679, 14588995228690397145, 3940715386317487999, 171389368231569535, 16085920225220257474, 4902322143460377698, 6869124916737330530, 6183377677101409271, 10438886986628291012, 11426442047952990420, 10472965005810994476, 17461754504554578317, 1731903609499796829, 3902524170072424017, 182839012449293763, 16033771226230254479, 7470111899753997156, 16260792070065715323, 15594377739643498325, 12797926023146764179, 1332794419151918095, 2215982050760409685, 6034413166361765097, 2649824395839030610, 6516388916500280463, 9878097299791762219, 15569481297333709123, 2452395105918662472, 9955245793212488080, 8110313995591863191, 6176991277462465051, 17475139598568431193, 4836073774680917725, 5605905782610534604, 11039995542642091262, 10067758369784373332, 12395794956292308522, 4477052692529463179, 10734558095596272907, 4464715467992414471, 6365585435124712318, 9508201257254872833, 15494404856782212934, 3693647526159508779, 9769760118330935691, 18323717963044268409, 9719371799511520531, 14886076074877160157, 17168120988769748995, 4247649676377174701, 12985933359049118054, 15132843500744450798, 7106163815688896890, 13712510283243909457, 3953593795782864200, 10528354571006449414, 8351904852252748144, 1623399460074158913, 8751405705817665423, 845029873276606066, 8390913924868992703, 2489516627125438758, 7327428069212050345, 11473257881465998268, 5448234510995570703, 15936583590082682623, 2213877427589093796, 1157013599382419472, 18312688948274809448, 15268848303715185841, 734018754142889254, 12603357917848254155, 11773377986790246119, 12127041874422280386, 9529671492741885200, 17926728929889626913, 3835869383297433308, 653110538755857218, 7518235269156580875, 5016442360150681059, 13735784301682701639, 7352955115316003610, 1304689697002359881, 5099644631784460930, 15904680007976705381, 12796238962282437487, 9127216752664127376, 18153098307287834400, 15374233117160180863, 13741969032829931767, 10391039444396920590, 11129845183223943726, 15312598643413461835, 6830796302956447496, 13581235045419583939, 10168295664878593076, 11647904655112939759, 8642410733309789458, 10349236208098829634, 13144116382592020140, 18174199501657033911, 7990760569997231274, 2071517159117119134, 9521701904432387124, 6924812893062622132, 17213097657653592482, 3751946986263089507, 2859725471085909770, 14152557109984135258, 9245237924712526753, 17786640493335136850, 14914153985555988728, 1376036802422458259, 17526509276275152144, 14186183971820428662, 5113034204284437041, 13072234496058532896, 12450698415714986220, 3852851426280089326, 2356092438923489383, 7971738417886083461, 15319666410915227601, 10869164142087398967, 18030805952164534199, 4052540627272595821, 13758849402849304117, 317134685289190618, 12137922636237363785, 15415462288990079116, 7805288659436212717, 15391695867127482002, 10083091492100851009, 7844793951806353741, 17482190564582399865, 2038331964156119034, 10805300355717631496, 10451126806522189867, 12844386191218853679, 8504692706352854584, 9314699961377216706, 12473174375608916164, 12087790641549960028, 4103394168450781738, 11506559241037858327, 15939565934022689279, 14033051863747250889, 4037902440203540442, 11085138863330697624, 11522197505849187508, 17719638872815796384, 15908303246267925934, 16759815909250747708, 3407035620184581301, 18124413475099983622, 8516498907785790396, 3811909548405147310, 12797922881453880631, 17375849159370482714, 14662532054861827468, 14631922441173527587, 13658772180214146884, 5899100059636983666, 8549400379942328107, 18150494288702892704, 4182436862166571497, 17460958482105834019, 4253952329728693620, 11040038145682194689, 5776692946391682356, 12019252279911540042, 13099575216246000898, 8146824952112458042, 15579875732417740242, 6684125981586901369, 5850533200222627370, 4228031984980446202, 14601859216937440669, 10734696580345697508, 13993020670641356606, 15289385962170346267, 14179805947845643108, 679065432799685281, 8974665658655203618, 4920938996604874621, 3309828179875794343, 11174411683227632582, 13079433384643430161, 1091638337612053814, 15426505576313646967, 18403985385262220619, 14005640543308068516, 12563219939403537860, 397799690682369099, 14725539950193715428, 8449958729174222458, 2741235256335637496, 15989348609035269485, 6470988986866836195, 58901700309314597, 2345326857834285754, 10182552987892597644, 13873557574950419740, 14157791140541191976, 297511905899603947, 17321898707731123931, 9222013019462621804, 15904114336778070876, 10150161454844894882, 2369467700398884852, 4311441252770103987, 11493992398265742774, 12836107198290958968, 5929477984687839208, 1261318641584473667, 2602602351311974772, 2429436226352986682, 13962023409996309700, 10556602720618784527, 11549790006378227975, 5642798916809437840, 3421471827601404877, 15393582209056517771, 6404102326213983275, 7302627003709290859, 6282853386060603335, 17316530350377958138, 9424687708110938801, 4658362746456424325, 10560576343734506862, 14759271930199102237, 15522846572176104470, 3951907274247264193, 8375258488960502115, 15212271247627309333, 16849618896847629588, 2903177512789298178, 4623754700154123653, 3104975375120998625, 7806865279027905355, 7044947635690086866, 9657817089998922871, 9494633528223702616, 15653932205810876391, 1343779024889034802, 9768687328564589686, 4356008863848278674, 10009934729134577190, 5524398285512441045, 7064435152247800918, 81143555740864883, 14908511751352552507, 11155895297373727308, 6349417013166498258, 13235606265662318957, 10773380163241636220, 11731704534194814591, 17288384928396424949, 8701007168893041725, 1628172837781404595, 7412568326830346768, 124899605729073720, 14381671685773628701, 2825639751327543080, 2152939143468745585, 10390838613142616024, 5218489121330440563, 3012480022327880457, 4946374446823868481, 6034214401955902020, 3897817833565020329, 9865021898567572808, 16593677863666480969, 3121845123306752837, 3530347095869549718, 553992991646769039, 4839030754053686007, 13774642700337090532, 7586233702659243947, 9343946929161223274, 9884337010075825653, 12149117325374628008, 15303039577392269364, 2779643689170066470, 4640833353732282569, 4999883039106849533, 7262033100969942532, 18394016750596202824, 2102557795329193137, 18359076651855183158, 14026140157426851129, 9059485298611552458, 6392690796712957208, 488363039587622823, 10645706102072661457, 12831236107187881748, 10086831331989895494, 9977648876685474168, 15217339713237532349, 13789389371488670261, 8894601985041981558, 4900735788950990683, 8133596135451309102, 7239592732101061013, 17018329747003438649, 14509347497274910573, 10259947213945812005, 18171576823320202708, 11350800727752655194, 14002582548070717470, 6629111528934685721, 5028103791221445979, 2637015847489442391, 7288827567151932340, 8039172938446524471, 14900253737572373596, 8555613769305440701, 3311868866386897893, 15948205821358976224, 5235874961177752104, 4427467986127560191, 14826364553327652634, 11080730140813386421, 16512201232447780693, 7120229098714946877, 3579147572011982986, 8935889682924956755, 7543010412885235144, 8461685846003230644]

        self._run_test(seed, variant, expected_outputs, modifier)


    def test_crack_128_plus(self):
        xs = Xoroshiro128Plus([Bytes.random(8).int() for _ in range(2)])
        out = [xs.generate() for _ in range(3)]
        other_xs = IterativePRNG.crack(Xoroshiro128Plus, out)

        self.assertEqual(xs.state, other_xs.state)

    # Elixir
    # > :rand.seed(:exrop, {123, 123534, 345345})
    # > :rand.export_seed
    # > 1..1000 |> Enum.map(fn _ -> :rand.uniform(288230376151711744) end) |> IO.inspect(limit: :infinity)
    def test_116_plus(self):
        seed = [31396631805740656, 224097544921297400]

        variant = Xoroshiro116Plus
        modifier = 1
        expected_outputs = [
            255494176727038057, 232127040528578600, 103486530796184452, 269475888376689510,
            20268864711967854, 130666263564371684, 125040709000037841, 1740097730439723,
            160780592155714726, 102817057040657197, 262801519263669526, 9544993455156632,
            269620848829486421, 109956962593034254, 129248022278170474, 91042772869705364,
            92797452182955334, 35241085228803124, 9958608094291359, 285091572429937838,
            79305773072616828, 155000249360292118, 50916354411499016, 40225141492280776,
            241996039824730297, 159997387503892664, 75548612524015013, 107013502867111825,
            281723151532489566, 270082382287770701, 224598072667644191, 126707667760005872,
            184202766111079565, 193661059611855951, 138393329733927610, 181844304169389094,
            37959037107557494, 26943298694080027, 198541286883634135, 115945196327267860,
            208133433684886914, 38835884269750130, 51077476865822477, 174576136675651568,
            98420329546940241, 182072718134523686, 194057022156416815, 213426323964752314,
            32810298352039536, 130247921701072208, 275785198788837588, 227392757083316163,
            208772459047871153, 147060137269533314, 61817233944114777, 187987876363881824,
            20006776624962339, 50826837931406729, 201739866505732587, 146419059859359437,
            274363043485561019, 248742260177512681, 244639317475459060, 216836138009691591,
            117474984824530397, 120790718994830044, 204279555200228195, 220255968045168173,
            48341409950529745, 87836098925538288, 93963157421225708, 277636967672687663,
            134387359135457049, 252168349520809058, 262304368523828643, 239841485764670821,
            77114219819319854, 47290556531844815, 233267771219259124, 261140893676760135,
            285991172212369524, 83490711427482693, 238967034633862306, 62011492573281637,
            222697731088965495, 33317992693760097, 233677985998515700, 208062002808183639,
            184004969062424595, 30592224583912914, 225118961741336086, 269634672155093626,
            29655357118401422, 228899571322907367, 126646378786534139, 123442935196983139,
            26795052502098274, 72088296376983689, 151188154223841701, 117365253462574652,
            66657159184388837, 241707493758769252, 191980149122157099, 114434462751856033,
            154727230863591277, 25028971239389951, 39954997199414984, 181954309576748623,
            235051425967496741, 155317958794032900, 265473038290200373, 163560198250568270,
            119544572174874454, 34834553189877051, 62383666427750475, 86239061559097745,
            285683118895474023, 210580251588875693, 225491531801687397, 29873275940593737,
            254036869714094732, 76150698081288634, 108409596624022453, 15258314354333676,
            65611881189594028, 135842226263481380, 9187767204439777, 153559870246797104,
            122895006764014317, 50729998358138051, 190974563915444372, 88313952112131132,
            228695244968762138, 45604342641756997, 235800881799213114, 230311042414452022,
            231600030471736611, 40175577822799345, 41067831725455914, 141482140992130868,
            82339993767643579, 115042464221924716, 52791962878329571, 40870972761504135,
            225750087450219118, 38301331477968908, 74677337045354793, 105822653496723062,
            142028599050497764, 136682615317863236, 264591853895556241, 172442706633915467,
            222866832040691588, 213268733990104699, 52280178127070421, 36256815301556924,
            24714324754373880, 135909422183443976, 38881708833281872, 91314059960081422,
            58242531151450857, 240673429571985440, 144257097217292377, 176199122554759849,
            74712503168160032, 170778505930602528, 135350565462486731, 61204236234882222,
            84061350593287714, 173716121466662534, 74091188534229007, 100989536705671011,
            131725887591555132, 271067895848158823, 107374030126721020, 212562150502138357,
            151857347550507170, 45485377218691695, 256866855431736745, 211632378721424741,
            187268694757732234, 20349375174387729, 162513342409836520, 77169710669569639,
            146369933274489085, 94549962114565092, 259827463377985270, 72898425253642810,
            149485476060794478, 144855507899152138, 21829512096559220, 194202638556627274,
            67566886196166380, 57223305381062864, 25716386392128380, 199195013176424844,
            34742247305360062, 189556541267999559, 253173521482008509, 224106127264232772,
            69555014750093360, 8920347667030699, 7237217914028559, 141052392106965653,
            5943070371511102, 194823467153445365, 201330187718325923, 174053126551827375,
            208955886569357386, 132940864388428230, 1619944948864744, 6548585993833675,
            90344363688048660, 271750881184622597, 113045641935018490, 36114413803359371,
            266444829960618961, 242608866525364856, 80573397206277090, 50321211925876910,
            276480468942269655, 268530448109311389, 85405254496718744, 32091394292205461,
            75996437464044206, 6688026139431794, 132807545381594789, 8247511322474330,
            164615149229766528, 223026341609078982, 50982980250772996, 31479096708916577,
            223544371265830004, 268610641589733548, 77948530039724260, 256549569249663405,
            5440651440772991, 147156671727951178, 112817329465946256, 32761108081800912,
            65919767175852027, 86137398572984140, 236127435084049991, 251777366666030439,
            93003663553572638, 121784943124176605, 95360645996055314, 195458599667603665,
            174520338714694608, 93865122523711246, 182618613933425060, 181193299670168766,
            233386365245264052, 159382067434751279, 101224450233894841, 213254182055424040,
            193948502017329981, 73015349561148663, 67129773243858086, 201072367648685771,
            90158328641371765, 150288611301949484, 231368160876749574, 38354872846402600,
            62854563516814850, 147489117583544620, 258254807487535313, 160237208080219521,
            111634679456917423, 217962595350948827, 200405536841278955, 98915652024100251,
            70223933915651419, 6481273235399356, 72452707832126432, 148576479571365146,
            250334372308563045, 103460277334089996, 122278446012268698, 19402140266604782,
            99363865743726955, 242855535230016543, 173066526903394783, 221694967207446694,
            241426002476697215, 107824399688639917, 47925785459253521, 157618388702144435,
            255255520770063162, 40999596995309167, 200986710955368394, 57459880906894550,
            30212329796215003, 66596299470351357, 190763333602486774, 228700868006902835,
            198646043570934484, 9054299755235825, 157143634910194442, 78123917287910543,
            56878512476056403, 54972184079634069, 206320580369720484, 247291971880432528,
            236062945130874684, 157526958214853049, 3180863854472557, 248604855477506027,
            83024306002436737, 54493907182729133, 217047333749840205, 134833124116291168,
            175603850740506662, 147342203506942225, 100111650898603917, 35870673656684857,
            147251059559849196, 47366548677246942, 105313091195161775, 231309175538895205,
            31572151668417408, 75467792875299482, 176792536942745564, 95689377416606762,
            274674672637381898, 237810274112935205, 146804892392210839, 177568325214110828,
            59479751543221776, 27583383192461445, 165925584567181274, 12342140489866865,
            2529606771807399, 220457327717175252, 178066655314154623, 211258620047224047,
            285171331414186486, 33477437898425285, 3867684119611785, 252492285340234542,
            116359780204045638, 73062660793776686, 250864553598651224, 16945259403946976,
            56357998702543048, 100069010049615410, 65355207829259600, 118584244734516811,
            62511268600311713, 56656441198219465, 91677466359121769, 6397512487492607,
            245303886662449144, 273822589044887328, 3047442808327466, 160883242927068513,
            149805769278358941, 79386903082707689, 78821696483298468, 226932577764697054,
            63281259660848294, 101280897804279196, 156047566669398183, 72766045401838613,
            258378013507480176, 247158758564817215, 196550817101977121, 217401438882795170,
            132558973198971729, 238597001493574722, 24771775233016948, 109225365036792057,
            236142157550881097, 272177970594248137, 29400892680292329, 65062058107729145,
            77390862686539829, 28211805989606796, 269837381891582579, 249851075786602474,
            278872225298707261, 199028267166629736, 288216439490896701, 144467549144823715,
            110145706842460071, 18701057748709940, 53064202379037979, 275950279129025361,
            82532266636474098, 226836734821113478, 46701875472342234, 72555252967357618,
            62120322006631131, 98065779015267643, 169350274717204966, 270105982427878660,
            2480516609555158, 161839439333537717, 272204083618523127, 26202933807891845,
            116110148334610838, 1733112134333255, 246378163495458823, 87065187379002171,
            45817495696053227, 259671782242717555, 120803263177530624, 28452258151900303,
            249910480556728322, 113875024183444369, 202785563530641165, 235729321168753353,
            27028645610821200, 70435288763759426, 231176843788295883, 255179003366333819,
            262490699869495480, 148263574920017683, 169449890892167358, 284090456273408196,
            274273250927679293, 44985675053715936, 217611613881521101, 114358271734621735,
            249964447864553516, 212285343406488785, 228891019633397733, 175454249898034911,
            220264524266037180, 234332058024772124, 52374040516580681, 6263580786344835,
            281640853623779986, 147423870207442772, 252963841193153351, 193574402750874816,
            170182753290184024, 4554702845459796, 155702027878096179, 149975178296600090,
            246969434956822901, 79508860530642252, 226430042562684142, 14685674083930543,
            247732577990639580, 145179943746100016, 200197815918276291, 140842888135084714,
            12300330927560079, 166772685219482833, 175983208372005183, 213808294400232758,
            52623338738997326, 223440735942471082, 57052296526401378, 141506070261928039,
            147590001672835221, 14894936169505719, 186615707120515933, 153927259928715383,
            200932662639674268, 201738274974693991, 279917632621958912, 155707609394304303,
            33980856175197348, 24025481386827607, 253896336869844972, 234559910294125031,
            9685480944506117, 95124892338094001, 21969424044734575, 76691615024877659,
            19906466902245944, 272245221435948282, 153959128545646107, 239028459657446568,
            116321670736646879, 253526851786951089, 259195446249295541, 58045485410804644,
            200364222787942174, 195447801737329561, 278661482797485749, 270547155720833985,
            93433286634472556, 6025248679565444, 108114825199744932, 230480777356135646,
            40785505729920729, 127939325847819429, 210027755916285941, 274417061631178632,
            269540932407593595, 69376111093784952, 34287091672627273, 144678837361362242,
            58383689155059043, 252128772028400515, 265399227857982410, 266689198555033631,
            22602243795149243, 137768786349211070, 159815323884705523, 107649567291707103,
            24460299448359285, 272606692226918204, 34406775473424911, 83786297936713254,
            74439012856591284, 160859369849481896, 269232153584463069, 249468684146360478,
            108462918036005337, 181674919029536558, 47717960124188445, 115033783700002759,
            43990532762031689, 273601515199283536, 192538350371332608, 175046368391338187,
            223673308759593309, 270681058256370992, 205428949657623739, 163203663876411957,
            161836954467081462, 118559843066726001, 184650290267289339, 238035070130755208,
            15471721124949297, 221718549758592092, 217687453320804120, 71278513742786098,
            213012953301519128, 61665982259143689, 253289953831643858, 44963392859337495,
            117463554500031099, 90147515645920459, 29704211846121808, 205300279675132463,
            118102023727522984, 105188681212134988, 251381715904442343, 161763907756392717,
            250547117683888847, 265990343513197728, 186475954488117680, 200178945856522989,
            129183537997937443, 64450508105640649, 6576993207831427, 204324552575337674,
            105264887450453547, 76466992294232179, 144610262371182519, 104727144920665685,
            105977260022174315, 113779151307192539, 102722662964510725, 35375160952970082,
            16427572189686918, 28846964504117961, 109426234297767406, 25651931170836802,
            95126182647321836, 189316739604939878, 222445059832188960, 69095401281505929,
            256504807399180133, 153329017843503607, 149754993263342378, 110802163836080660,
            269903377604170541, 224281802283676804, 215405180806106628, 235548220778661891,
            277278758243766616, 123132976114950690, 167178722925975380, 29073837986403115,
            181988641316848442, 73796853852101604, 122795253343371065, 126114938990386817,
            218109624179007255, 196357230212167497, 184916889214990330, 283895019053948822,
            182868614724894619, 142016890824149420, 164167286888197389, 152421550598934794,
            168895912050301459, 55431937369576980, 216689110520673105, 201080416187657359,
            20014443653611196, 191892737177826250, 51250754568556873, 217770400776606784,
            214240814302582601, 7090100283485633, 231281541078310532, 93430689377266537,
            148003158465850960, 139733816225826806, 205510712361828800, 68836028362128725,
            247943867397479662, 40990836545164352, 184875469494144370, 150176706040160617,
            287700913404462124, 131805558292117369, 123896460048844158, 236226338913764655,
            175469451052970409, 84249138760463365, 243661348295577357, 120983246546504982,
            241957607890342484, 143206945629518537, 72176269453793872, 31535233289242377,
            73450998942861938, 3506676782994308, 166748957385402639, 45562039013598848,
            45775187920935924, 17353082007574910, 76703828179652469, 153509054689947687,
            232209840046157518, 214912066253684162, 248863884370005850, 11521052104437269,
            156006338222055269, 63672407507706069, 253419358212823451, 105229006018350753,
            46554534935340093, 191806141440923170, 113643474678220845, 37650580383234527,
            128613506666512484, 260615036485751782, 103564209857253579, 196931264089264650,
            216494791181751418, 158751505587777184, 241697050910940473, 206368952413522342,
            159341010049376863, 207956888659936438, 260539047117580055, 46054181576760587,
            8194772669206953, 97753432332067193, 265694312187105902, 241629436203571620,
            242246040620892774, 22726307687789797, 179144743235256897, 229462667963858851,
            41794721538611988, 44909318077550261, 256375181697003430, 1936676553424673,
            572220785477134, 84364193329424941, 243096993335450900, 238511079458770080,
            107697576274350931, 212376669026172355, 251633702866118964, 237968832001773273,
            22638318080482985, 213254482495752501, 52215605477832907, 196727090433350543,
            188077532382158404, 126098306965979055, 127208979040142051, 92202805694288307,
            108086168953155921, 214091920079431878, 70261042885051845, 99912115477751220,
            95983601182141958, 125283628211177290, 53301932480300130, 98810205754618667,
            137009597738566690, 190376509530141818, 79822754412619585, 215575077677529398,
            8910142202835048, 202688868939149101, 146373260998993189, 250522894090753968,
            61894914629284938, 5426651989573803, 258280549902704326, 249668363776232643,
            145516605139068941, 137323020930992355, 40230287986659570, 123143210581597244,
            74465570821710519, 35913893442945063, 11214299347926234, 248968292491025216,
            35881961777018677, 239097160046308064, 95374455049390089, 145109959121134647,
            20009793583464125, 19922041951739547, 20622777923698952, 14732660831383581,
            237991371774940029, 14281654861372499, 49995912364764960, 14928948101440756,
            264440106616342056, 168807518508455580, 138862013490802788, 114033726864687543,
            43371222353102076, 208344718862922595, 275672075950063426, 127892320157175118,
            53890763867684032, 39141409196394813, 93833267970758206, 62486492550196717,
            112780496058888002, 79755548750635636, 133371352505253360, 94243731902974578,
            110408577153899472, 144607816576897099, 118374440957865603, 5183421457813619,
            239682078241799935, 21824325318514270, 224438238028913527, 185546814529317106,
            129859207483269436, 27271586492728483, 283837104954910523, 266781996084294516,
            146717950878125875, 58808006420979986, 7130056897665139, 144140027657743269,
            287697011391642632, 276731486919547716, 107217430912394011, 273690272629505015,
            62246661594608878, 13656085707060077, 32104880245562039, 125673717552848569,
            10918207621994187, 137786981320921601, 272961770553094594, 94414835662977542,
            60384350947541576, 107692816708320182, 211843264812694656, 175612896690791273,
            11620663117325223, 252981216438421940, 44568234723832960, 123893601727729469,
            151185366331325657, 31856379411535682, 147330812306299292, 179802343978842533,
            286762184098843467, 198448603621272449, 119779003009993239, 41856422524386394,
            184368257503020906, 64911739483768128, 260898723685134611, 151470919963635530,
            244964757111391182, 209137150244256399, 29784125328925144, 248302349140433529,
            201008006816609560, 238298949484720578, 90043859471334917, 150423365529248463,
            208061723324222112, 17985310300455286, 151724372038558161, 18035135161313218,
            251105116589354990, 36136475916368496, 25611279743825669, 222744872135958019,
            125781317367677476, 200709675906459099, 137035073969488978, 138516943478848704,
            52016181564077026, 136478615899129341, 52943443541394862, 135581805624367919,
            19339068989258602, 27287162520521799, 92434902676873150, 96340588610050286,
            210275844807120616, 67380668844214694, 110860998761347619, 16878800490149438,
            187447816103704814, 280491630463836609, 212729247355668066, 135498000189469176,
            166931576726376315, 78069919522219400, 164594527362141096, 17372026095581842,
            216370983458763776, 52510683717065088, 156654086186669682, 14927584165271626,
            39740010020742603, 278964183835592495, 44709183533844238, 136874306509746620,
            2271960043426943, 30182766836477551, 135588408744547232, 58575379817755309,
            121605123913796578, 241044192588204093, 128799158350404022, 101335545664995626,
            254845316920902462, 90214837315574142, 234269186090567797, 251820489988510750,
            17173767190947906, 30932591037769129, 253412081635633578, 202824375709975142,
            44950813267145201, 189615092502226027, 85720458440810128, 30222906117458932,
            117840922918892895, 15561039942405587, 67084297448077660, 4893730513190279,
            21802631658926324, 153730318987543831, 4077723973290857, 101168194742555747,
            158065657686082158, 246595270724796195, 70106169519756500, 82499723139236802,
            13186449638637441, 48075458441606964, 177105712090114099, 32745125742089448,
            282100433372144908, 80489126148092660, 67377503492331268, 155761244568561164,
            257295267279070843, 72978817837093728, 280538248577834926, 253194462576550323,
            108666652783965953, 236185983404002523, 157229751037393749, 98822957919847564,
            237096586757335104, 162458882655856758, 64744781939063323, 143675025747942972,
            70690570397593848, 5495769458724055, 191274442006329594, 167062216329947122,
            78168289784659424, 133913043496473967, 88567795458137992, 17605176485404465,
            187055645720486582, 287261493164535278, 89528416850143289, 287586644878596642,
            110253739801705953, 125649677896661424, 41076838304429200, 190845677692947492,
            185470175068125899, 108811697891408158, 158337260895481950, 278016364872969517,
            45661393083201939, 2009380176341826, 114840745355210409, 46130983515386456,
            115377968286032416, 28485648415275255, 215690576737011514, 79666950964054447,
            166296893476970842, 271270704185643023, 140488531118344208, 276811103025587192,
            111086238049297153, 201986502147223099, 190689339710217990, 38579336941535034,
            212912687489567191, 238633064294456246, 130799415378501056, 261919907001867152,
            250824064663387310, 133922771310351177, 181062668456105386, 18982281171934050,
            19380594347390459, 39495312768902589, 141341084441954964, 142974922793750630,
            68615954772918999, 123190744313534211, 257168136954005490, 167996885370435773,
            172484077151041612, 139553956524634821, 70765587808423319, 72915645170253983,
            77265268811219732, 235652147104917899, 212023061586822451, 197769277801906135,
            213650493903346300, 31105280861125987, 136449905978830758, 178693019920816366,
            120931059857246922, 219311854578099056, 71263527808965095, 27523339655146156,
            254592445082151434, 3639400716302526, 152122980103457651, 271155280138380195,
            213758093043327599, 78209543989089034, 78801896583856165, 262791096690791557,
            13573177602369676, 249114354241337738, 109373366374035334, 234511556216801520,
            3437453510792734, 172167001628733380, 198079154253306201, 24732335865962464,
            5504870823826256, 60308764689931228, 120786099956700982, 87056692310707924,
            126806941140147059, 51172294277623797, 268471142270936977, 275733939884764790,
            261082562652839436, 246246985897047836, 97602830683858075, 105434694491552288,
            174553304604959405, 107810045038299347, 117951744230829419, 33581150933830759,
            62626401471228759, 141768074798336937, 210925904119368662, 71836575216268913,
            287611403386177793, 254477730503881922, 142267657079761990, 218740341605297692,
            9273973760287180, 203528436836434301, 268158138178894220, 250937996190840163
        ]

        self._run_test(seed, variant, expected_outputs, modifier)



    # NOTE: We don't assert against the state because the 116+ crack doesn't find the actual state
    # but an equivalent one
    def test_crack_116_plus(self):
        xs = Xoroshiro116Plus([Bytes.random(8).int() for _ in range(2)])
        out = [xs.generate() for _ in range(3)]
        other_xs = IterativePRNG.crack(Xoroshiro116Plus, out)

        self.assertEqual([xs.generate() for _ in range(10)], [other_xs.generate() for _ in range(10)])
